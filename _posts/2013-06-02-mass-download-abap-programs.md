---
layout: post
title: Mass Download ABAP Programs
date: 2013-06-02 23:54
author: administrator
comments: true
categories: [ABAP]
---
program zdtp_massdownload.<br/><br/>*======================================================================================================================<br/><br/>*  Mass download version 1.5.2.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  PROGRAM DESCRIPTION &amp; USE<br/><br/>*  Allows a user to download programs, Functions, DD definitions, etc to the presentation server.  This version searches<br/><br/>*  recursively for nested includes and function modules, and allows you to download the resulting code as standard text<br/><br/>*  or HTML web pages within a suitable directory structure.<br/><br/>*<br/><br/>*  You can either search by object name, using wildcards if you wish, or a combination of Author and object name.  If<br/><br/>*  you want all objects returned for a particular author then select the author name and choose the most suitable<br/><br/>*  radiobutton.  All objects will be returned if the fields to the right hand side of the radiobutton are left completely<br/><br/>*  blank.<br/><br/>*<br/><br/>*  Compatible with R/3 Enterprise and Netweaver, for older versions of SAP you will need Direct Download version 5.xx.<br/><br/>*  This version removes the programming limitations imposed by developing across SAP releases 3 to 4.6.<br/><br/>*<br/><br/>*  In order to be able to download files to the SAP server you must first set up a logical filepath within transaction<br/><br/>*  'FILE', or use an existing one.  You must also create a external operating system command in SM69 called ZDTX_MKDIR. This<br/><br/>*  will then be used to create any directories needed on the SAP server<br/><br/>&nbsp;<br/><br/>*  This program is intended to allow a person to keep a visual representation of a program for backup purposes only as<br/><br/>*  has not been designed to allow programs to be uploaded to SAP systems.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*<br/><br/>* Author          : Copyright (C) 1998 E.G.Mellodew<br/><br/>* program contact : www.dalestech.com<br/><br/>&nbsp;<br/><br/>* This program is free software; you can redistribute it and/or<br/><br/>* modify it under the terms of the GNU General Public License<br/><br/>* as published by the Free Software Foundation; either version 2<br/><br/>* of the License, or (at your option) any later version.<br/><br/>*<br/><br/>* This program is distributed in the hope that it will be useful,<br/><br/>* but WITHOUT ANY WARRANTY; without even the implied warranty of<br/><br/>* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br/><br/>* GNU General Public License for more details.<br/><br/>*<br/><br/>* You should have received a copy of the GNU General Public License<br/><br/>* along with this program; if not, write to the Free Software<br/><br/>* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.<br/><br/>*<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  SAP Tables<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>tables: trdir, seoclass, tfdir, enlfdir, dd02l, tadiv, dd40l, transfdesc.<br/><br/>type-pools: abap, seor.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Types<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* text element structure<br/><br/>types: tTextTable like textpool.<br/><br/>* GUI titles<br/><br/>types: tGUITitle like d347t.<br/><br/>&nbsp;<br/><br/>* Message classes<br/><br/>types: begin of tMessage,<br/><br/>arbgb like t100-arbgb,<br/><br/>stext like t100a-stext,<br/><br/>msgnr like t100-msgnr,<br/><br/>text  like t100-text,<br/><br/>end of tMessage.<br/><br/>&nbsp;<br/><br/>* Screen flow.<br/><br/>types: begin of tScreenFlow,<br/><br/>screen like d020s-dnum,<br/><br/>code like d022s-line,<br/><br/>end of tScreenFlow.<br/><br/>&nbsp;<br/><br/>* Holds all domain texts<br/><br/>types: begin of tDomainStructure,<br/><br/>domname type domname,<br/><br/>domvalue_l type domvalue_l,<br/><br/>domvalue_h type domvalue_l,<br/><br/>ddtext type val_text,<br/><br/>end of tDomainStructure.<br/><br/>&nbsp;<br/><br/>* Holds a tablestructure definition<br/><br/>types: begin of tDictTableStructure,<br/><br/>fieldname like dd03l-fieldname,<br/><br/>position  like dd03l-position,<br/><br/>keyflag   like dd03l-keyflag,<br/><br/>rollname  like dd03l-rollname,<br/><br/>domname   like dd03l-domname,<br/><br/>datatype  like dd03l-datatype,<br/><br/>leng      like dd03l-leng,<br/><br/>lowercase type lowercase,<br/><br/>ddtext    like dd04t-ddtext,<br/><br/>iDomains type tDomainStructure occurs 0,<br/><br/>end of tdictTableStructure.<br/><br/>&nbsp;<br/><br/>*-- Holds a table type<br/><br/>types: begin of tTableType,<br/><br/>typename   type ttypename,  " Name of table type<br/><br/>rowtype    type ttrowtype,  " Name of row type for table types<br/><br/>ttypkind   type ttypkind,   " Category of table type (range or general table type)<br/><br/>range_ctyp type range_ctyp, " Elem. type of LOW and HIGH components of a Ranges type<br/><br/>reftype    type ddreftype,  " Type of Object Referenced<br/><br/>occurs     type ddoccurs,   " Initial Line Number for Table Types<br/><br/>ddtext     type ddtext,     " Description<br/><br/>end of tTableType.<br/><br/>&nbsp;<br/><br/>* Holds a tables attributes + its definition<br/><br/>types: begin of tDictTable,<br/><br/>tablename    like dd03l-tabname,<br/><br/>tableTitle   like dd02t-ddtext,<br/><br/>iStructure type tDictTableStructure occurs 0,<br/><br/>end of tDictTable.<br/><br/>&nbsp;<br/><br/>types: begin of tDictFilename,<br/><br/>tablename    like dd03l-tabname,<br/><br/>filename type string,<br/><br/>end of tDictFilename.<br/><br/>&nbsp;<br/><br/>types: begin of tTransformation,<br/><br/>xsltName like trdir-name,<br/><br/>xsltDesc like tftit-stext,<br/><br/>subc     like trdir-subc,<br/><br/>end of tTransformation.<br/><br/>&nbsp;<br/><br/>* Include program names<br/><br/>types: begin of tInclude,<br/><br/>includeName like trdir-name,<br/><br/>includeTitle like tftit-stext,<br/><br/>end of tInclude.<br/><br/>&nbsp;<br/><br/>* Exception class texts<br/><br/>types: begin of tConcept,<br/><br/>constName type string,<br/><br/>concept type sotr_conc,<br/><br/>end of tConcept.<br/><br/>&nbsp;<br/><br/>* Method<br/><br/>types: begin of tMethod,<br/><br/>cmpName(61),<br/><br/>descript like vseomethod-descript,<br/><br/>exposure like vseomethod-exposure,<br/><br/>methodKey type string,<br/><br/>end of tMethod.<br/><br/>&nbsp;<br/><br/>* Interfaces<br/><br/>types: begin of tInterface,<br/><br/>interfaceName like vseoclass-clsname,<br/><br/>end of tInterface.<br/><br/>&nbsp;<br/><br/>* Class<br/><br/>types: begin of tClass,<br/><br/>scanned(1),<br/><br/>clsname like vseoclass-clsname,<br/><br/>descript like vseoclass-descript,<br/><br/>msg_id like vseoclass-msg_id,<br/><br/>exposure like vseoclass-exposure,<br/><br/>state like vseoclass-state,<br/><br/>clsfinal like vseoclass-clsfinal,<br/><br/>r3release like vseoclass-r3release,<br/><br/>iMethods type tMethod occurs 0,<br/><br/>iDictStruct type tDictTable occurs 0,<br/><br/>iTextElements type tTextTable occurs 0,<br/><br/>iMessages type tMessage occurs 0,<br/><br/>iInterfaces type tInterface occurs 0,<br/><br/>iConcepts type tConcept occurs 0,<br/><br/>iTableTypes type tTableType occurs 0,<br/><br/>iTransformations type tTransformation occurs 0,<br/><br/>textElementKey type string,<br/><br/>publicClassKey type string,<br/><br/>privateClassKey type string,<br/><br/>protectedClassKey type string,<br/><br/>typesClassKey type string,<br/><br/>exceptionClass type abap_bool,<br/><br/>end of tClass.<br/><br/>&nbsp;<br/><br/>* function modules<br/><br/>types: begin of tFunction,<br/><br/>functionName like tfdir-funcName,<br/><br/>functionGroup like enlfdir-area,<br/><br/>includeNumber like tfdir-include,<br/><br/>functionMainInclude like tfdir-funcName,<br/><br/>functionTitle like tftit-stext,<br/><br/>topIncludeName like tfdir-funcName,<br/><br/>progname like tfdir-pname,<br/><br/>programLinkName like tfdir-pname,<br/><br/>messageClass like t100-arbgb,<br/><br/>iTextElements type tTextTable occurs 0,<br/><br/>iSelectiontexts type tTextTable occurs 0,<br/><br/>iMessages type tMessage occurs 0,<br/><br/>iIncludes type tInclude occurs 0,<br/><br/>iDictStruct type tDictTable occurs 0,<br/><br/>iGUITitle type tGUITitle occurs 0,<br/><br/>iScreenFlow type tScreenFlow occurs 0,<br/><br/>iTableTypes type tTableType occurs 0,<br/><br/>iTransformations type tTransformation occurs 0,<br/><br/>end of tFunction.<br/><br/>&nbsp;<br/><br/>types: begin of tProgram,<br/><br/>progname like trdir-name,<br/><br/>programTitle like tftit-stext,<br/><br/>subc like trdir-subc,<br/><br/>messageClass like t100-arbgb,<br/><br/>iMessages type tMessage occurs 0,<br/><br/>iTextElements type tTextTable occurs 0,<br/><br/>iSelectiontexts type tTextTable occurs 0,<br/><br/>iGUITitle type tGUITitle occurs 0,<br/><br/>iScreenFlow type tScreenFlow occurs 0,<br/><br/>iIncludes type tInclude occurs 0,<br/><br/>iDictStruct type tDictTable occurs 0,<br/><br/>iTableTypes type tTableType occurs 0,<br/><br/>iTransformations type tTransformation occurs 0,<br/><br/>end of tProgram.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Internal tables<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Dictionary object<br/><br/>data: iDictionary type standard table of tDictTable with header line.<br/><br/>*  Dictionary objects which have previously been downloaded<br/><br/>data: iDictFilename type standard table of tDictFilename with header line.<br/><br/>*  Table Types<br/><br/>data: iTableTypes type standard table of tTableType with header line.<br/><br/>*  Table Type objects which have previously been downloaded<br/><br/>data: iTableTypeFilename type standard table of tDictFilename with header line.<br/><br/>* Function modules.<br/><br/>data: iFunctions type standard table of tFunction with header line.<br/><br/>* Function modules used within programs.<br/><br/>data: iProgFunctions type standard table of tFunction with header line.<br/><br/>* Tree display structure.<br/><br/>data: iTreeDisplay type standard table of snodetext with header line.<br/><br/>* Message class data<br/><br/>data: iMessages type standard table of tMessage with header line.<br/><br/>* Holds a single message class an all of its messages<br/><br/>data: iSingleMessageClass type standard table of tMessage with header line.<br/><br/>* Holds program related data<br/><br/>data: iPrograms type standard table of tProgram with header line.<br/><br/>* Classes<br/><br/>data: iClasses type standard table of tClass with header line.<br/><br/>* Table of paths created on the SAP server<br/><br/>data: iServerPaths type standard table of string with header line.<br/><br/>* Table of XSL Transformations<br/><br/>data: iTransformations type standard table of tTransformation with header line.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Table prototypes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>data: dumiDictStructure type standard table of tDictTableStructure.<br/><br/>data: dumiTextTab type standard table of tTextTable.<br/><br/>data: dumiIncludes type standard table of tInclude.<br/><br/>data: dumiHtml type standard table of string.<br/><br/>data: dumiHeader type standard table of string .<br/><br/>data: dumiScreen type standard table of tScreenFlow .<br/><br/>data: dumIGUITitle type standard table of tGUITitle.<br/><br/>data: dumiMethods type standard table of tMethod.<br/><br/>data: dumiConcepts type standard table of tConcept.<br/><br/>data: dumiInterfaces type standard table of tInterface.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*   Global objects<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>data: objFile type ref to cl_gui_frontend_services.<br/><br/>data: objRuntimeError type ref to cx_root.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Constants<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>constants: VERSIONNO type string value '1.5.2'.<br/><br/>constants: TABLES type string value 'TABLES'.<br/><br/>constants: TABLE type string value 'TABLE'.<br/><br/>constants: LIKE type string value 'LIKE'.<br/><br/>constants: TYPE type string value 'TYPE'.<br/><br/>constants: TYPEREFTO type string value 'TYPE REF TO'.<br/><br/>constants: STRUCTURE type string value 'STRUCTURE'.<br/><br/>constants: LOWSTRUCTURE type string value 'structure'.<br/><br/>constants: OCCURS type string value 'OCCURS'.<br/><br/>constants: FUNCTION type string value 'FUNCTION'.<br/><br/>constants: CALLFUNCTION type string value ' CALL FUNCTION'.<br/><br/>constants: MESSAGE type string  value 'MESSAGE'.<br/><br/>constants: INCLUDE type string value 'INCLUDE'.<br/><br/>constants: TRANSFORMATION type string value 'TRANSFORMATION'.<br/><br/>constants: LOWINCLUDE type string value 'include'.<br/><br/>constants: DESTINATION type string value 'DESTINATION'.<br/><br/>constants: IS_TABLE type string value 'T'.<br/><br/>constants: IS_TRANSFORMATION type string value 'X'.<br/><br/>constants: IS_PROGRAM type string value 'P'.<br/><br/>constants: IS_SCREEN type string value 'S'.<br/><br/>constants: IS_GUITITLE type string value 'G'.<br/><br/>constants: IS_DOCUMENTATION type string value 'D'.<br/><br/>constants: IS_MESSAGECLASS type string value 'MC'.<br/><br/>constants: IS_FUNCTION type string value 'F'.<br/><br/>constants: IS_CLASS type string value 'C'.<br/><br/>constants: IS_METHOD type string value 'M'.<br/><br/>constants: ASTERIX type string value '*'.<br/><br/>constants: COMMA type string value ','.<br/><br/>constants: PERIOD type string value '.'.<br/><br/>constants: DASH type string value '-'.<br/><br/>constants: TRUE type abap_bool value 'X'.<br/><br/>constants: FALSE type abap_bool value ''.<br/><br/>constants: LT type string value '&amp;lt;'.<br/><br/>constants: GT type string value '&amp;gt;'.<br/><br/>constants: UNIX type string value 'UNIX'.<br/><br/>constants: NON_UNIX type string value 'not UNIX'.<br/><br/>constants: HTMLEXTENSION type string value 'html'.<br/><br/>constants: TEXTEXTENSION type string value 'txt'.<br/><br/>constants: SS_CODE type c value 'C'.<br/><br/>constants: SS_TABLE type c value 'T'.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Global variables<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>data: statusBarMessage(100).<br/><br/>data: forcedExit type abap_bool value FALSE.<br/><br/>data: startTime like sy-uzeit.<br/><br/>data: runTime like sy-uzeit.<br/><br/>data: downloadFileExtension type string.<br/><br/>data: downloadFolder type string.<br/><br/>data: serverSlashSeparator type string.<br/><br/>data: frontendSlashSeparator type string.<br/><br/>data: slashSeparatorToUse type string.<br/><br/>data: serverFilesystem type filesys_d.<br/><br/>data: serverFolder type string.<br/><br/>data: frontendOpSystem type string.<br/><br/>data: serverOpSystem type string.<br/><br/>data: customerNameSpace type string.<br/><br/>ranges: soProgramName for trdir-name.<br/><br/>ranges: soAuthor for usr02-bname.<br/><br/>ranges: soTableNames for dd02l-tabname.<br/><br/>ranges: soTableTypeNames for dd40l-typename.<br/><br/>ranges: soFunctionName  for tfdir-funcName.<br/><br/>ranges: soClassName for vseoclass-clsname.<br/><br/>ranges: soFunctionGroup for enlfdir-area.<br/><br/>ranges: soXsltName for tadir-obj_name.<br/><br/>field-symbols: &lt;waDictStruct&gt; type tDictTable.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Selection screen declaration<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* Author<br/><br/>selection-screen: begin of block b1 with frame title tBlock1.<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 5(23) tAuth.<br/><br/>parameters: pAuth like usr02-bname memory id MAUTH.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 5(36) tPmod.<br/><br/>parameters: pMod as checkbox.<br/><br/>selection-screen end of line.<br/><br/>selection-screen: end of block b1.<br/><br/>&nbsp;<br/><br/>selection-screen begin of block b2 with frame title tBlock2.<br/><br/>* Tables<br/><br/>selection-screen begin of line.<br/><br/>parameters: rTable radiobutton group r1.<br/><br/>selection-screen comment 5(15) tRtable.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tPtable.<br/><br/>select-options: soTable for dd02l-tabname.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(79) tTnote.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Table Types<br/><br/>selection-screen begin of line.<br/><br/>parameters: rTabType radiobutton group r1.<br/><br/>selection-screen comment 5(15) trtabtyp.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tptabtyp.<br/><br/>select-options: sotabtyp for dd40l-typename.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Message classes<br/><br/>selection-screen begin of line.<br/><br/>parameters: rMess radiobutton group r1.<br/><br/>selection-screen comment 5(18) tPMes.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(18) tMname.<br/><br/>parameters: pMname like t100-arbgb memory id MMNAME.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Function modules<br/><br/>selection-screen begin of line.<br/><br/>parameters: rFunc radiobutton group r1.<br/><br/>selection-screen comment 5(30) tRfunc.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tPfname.<br/><br/>select-options: soFname for tfdir-funcName.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tFgroup.<br/><br/>select-options: soFgroup for enlfdir-area.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* XSLT<br/><br/>selection-screen begin of line.<br/><br/>parameters: rxslt radiobutton group r1.<br/><br/>selection-screen comment 5(30) trxslt.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tpxslt.<br/><br/>select-options: soxslt for transfdesc-xsltdesc.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Classes<br/><br/>selection-screen begin of line.<br/><br/>parameters: rClass radiobutton group r1.<br/><br/>selection-screen comment 5(30) tRClass.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tPcName.<br/><br/>select-options: soClass for seoclass-clsname.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Programs / includes<br/><br/>selection-screen begin of line.<br/><br/>parameters: rProg radiobutton group r1 default 'X'.<br/><br/>selection-screen comment 5(18) tProg.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 10(15) tRpname.<br/><br/>select-options: soProg for trdir-name.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen skip.<br/><br/>* Language<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(27) tMLang.<br/><br/>parameters: pMLang like t100-sprsl default 'EN'.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Package<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(24) tPack.<br/><br/>select-options: soPack for tadiv-devclass.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Customer objects<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(27) tCust.<br/><br/>parameters: pCust as checkbox default 'X'.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>* Alt customer name range<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(27) tNRange.<br/><br/>parameters: pCName type namespace memory id MNAMESPACE.<br/><br/>selection-screen end of line.<br/><br/>selection-screen: end of block b2.<br/><br/>&nbsp;<br/><br/>* Additional things to download.<br/><br/>selection-screen: begin of block b3 with frame title tBlock3.<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tPtext.<br/><br/>parameters: pText as checkbox default 'X' memory id MTEXT.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tMess.<br/><br/>parameters: pMess as checkbox default 'X' memory id MMESS.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tTTyp.<br/><br/>parameters: pTTyp as checkbox default 'X' memory id MTTYP.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tXslt.<br/><br/>parameters: pTrans as checkbox default 'X' memory id MXSLT.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tPinc.<br/><br/>parameters: pInc as checkbox default 'X' memory id MINC.<br/><br/>selection-screen comment 40(20) tReci.<br/><br/>parameters: pReci as checkbox default 'X' memory id MRECI.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tPfunc.<br/><br/>parameters: pFunc as checkbox default 'X' memory id MFUNC.<br/><br/>selection-screen comment 40(20) tRecf.<br/><br/>parameters: pRecf as checkbox default 'X' memory id MRECF.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tRecC.<br/><br/>parameters: pRecC as checkbox default 'X' memory id MRECC.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tFDoc.<br/><br/>parameters: pFDoc as checkbox default 'X' memory id MFDOC.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tCDoc.<br/><br/>parameters: pCDoc as checkbox default 'X' memory id MCDOC.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tPscr.<br/><br/>parameters: pScr as checkbox default 'X' memory id MSCR.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tPdict.<br/><br/>parameters: pDict as checkbox default 'X' memory id MDICT.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tSortT.<br/><br/>parameters: pSortT as checkbox default ' ' memory id MSORTT.<br/><br/>selection-screen end of line.<br/><br/>selection-screen: end of block b3.<br/><br/>&nbsp;<br/><br/>* File details<br/><br/>selection-screen: begin of block b4 with frame title tBlock4.<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(20) tPhtml.<br/><br/>parameters: pHtml radiobutton group g1 default 'X'.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 5(29) tBack.<br/><br/>parameters: pBack as checkbox default 'X'.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(20) tPtxt.<br/><br/>parameters: pTxt radiobutton group g1.<br/><br/>selection-screen end of line.<br/><br/>&nbsp;<br/><br/>selection-screen skip.<br/><br/>&nbsp;<br/><br/>* Download to SAP server<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(25) tServ.<br/><br/>parameters: pServ radiobutton group g2.<br/><br/>selection-screen end of line.<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 8(20) tSPath.<br/><br/>parameters: pLogical like filename-fileintern memory id MLOGICAL.<br/><br/>selection-screen end of line.<br/><br/>selection-screen comment /28(60) tSDPath.<br/><br/>&nbsp;<br/><br/>* Download to PC<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(25) tPc.<br/><br/>parameters: pPc radiobutton group g2 default 'X'.<br/><br/>selection-screen end of line.<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 8(20) tPpath.<br/><br/>parameters: pFolder like rlgrap-filename memory id MFOLDER.<br/><br/>selection-screen end of line.<br/><br/>selection-screen: end of block b4.<br/><br/>&nbsp;<br/><br/>* Display options<br/><br/>selection-screen: begin of block b5 with frame title tBlock5.<br/><br/>* Display final report<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tRep.<br/><br/>parameters: pRep as checkbox default 'X'.<br/><br/>selection-screen end of line.<br/><br/>* Display progress messages<br/><br/>selection-screen begin of line.<br/><br/>selection-screen comment 1(33) tProMess.<br/><br/>parameters: pProMess as checkbox default 'X'.<br/><br/>selection-screen end of line.<br/><br/>selection-screen: end of block b5.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* Display a directory picker window<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for pFolder.<br/><br/>&nbsp;<br/><br/>data: objFile type ref to cl_gui_frontend_services.<br/><br/>data: pickedFolder type string.<br/><br/>data: initialFolder type string.<br/><br/>&nbsp;<br/><br/>if sy-batch is initial.<br/><br/>create object objFile.<br/><br/>&nbsp;<br/><br/>if not pFolder is initial.<br/><br/>initialFolder = pFolder.<br/><br/>else.<br/><br/>objFile-&gt;get_temp_directory( changing temp_dir = initialFolder<br/><br/>exceptions cntl_error = 1<br/><br/>error_no_gui = 2<br/><br/>not_supported_by_gui = 3 ).<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>objFile-&gt;directory_browse( exporting initial_folder = initialFolder<br/><br/>changing selected_folder = pickedFolder<br/><br/>exceptions cntl_error = 1<br/><br/>error_no_gui = 2<br/><br/>not_supported_by_gui = 3 ).<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>pFolder = pickedFolder.<br/><br/>else.<br/><br/>write: / 'An error has occured picking a folder'.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>case 'X'.<br/><br/>when pPc.<br/><br/>if pFolder is initial.<br/><br/>*       User must enter a path to save to<br/><br/>message e000(oo) with 'You must enter a file path'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>when pServ.<br/><br/>if pLogical is initial.<br/><br/>*       User must enter a logical path to save to<br/><br/>message e000(oo) with 'You must enter a logical file name'.<br/><br/>endif.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on pLogical.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>if not pServ is initial.<br/><br/>call function 'FILE_GET_NAME' exporting logical_filename = pLogical<br/><br/>importing file_name = serverFolder<br/><br/>exceptions file_not_found = 1<br/><br/>others = 2.<br/><br/>if sy-subrc = 0.<br/><br/>if serverFolder is initial.<br/><br/>message e000(oo) with 'No file path returned from logical filename'.<br/><br/>else.<br/><br/>*       Path to display on the selection screen<br/><br/>tSDPath = serverFolder.<br/><br/>*       Remove the trailing slash off the path as the subroutine buildFilename will add an extra one<br/><br/>shift serverFolder right deleting trailing serverSlashSeparator.<br/><br/>shift serverFolder left deleting leading space.<br/><br/>endif.<br/><br/>else.<br/><br/>message e000(oo) with 'Logical filename does not exist'.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soProg-low.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'PROG'<br/><br/>object_name  = soProg-low<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soProg-low<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soProg-high.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'PROG'<br/><br/>object_name  = soProg-high<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soProg-high<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soxslt-low.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4'<br/><br/>exporting<br/><br/>object_type           = 'XSLT'<br/><br/>object_name           = soxslt-low<br/><br/>suppress_selection    = 'X'<br/><br/>use_alv_grid          = ''<br/><br/>without_personal_list = ''<br/><br/>importing<br/><br/>object_name_selected  = soxslt-low<br/><br/>exceptions<br/><br/>cancel                = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soxslt-high.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4'<br/><br/>exporting<br/><br/>object_type           = 'XSLT'<br/><br/>object_name           = soxslt-high<br/><br/>suppress_selection    = 'X'<br/><br/>use_alv_grid          = ''<br/><br/>without_personal_list = ''<br/><br/>importing<br/><br/>object_name_selected  = soxslt-high<br/><br/>exceptions<br/><br/>cancel                = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soClass-low.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'F4_DD_ALLTYPES' exporting object = soClass-low<br/><br/>suppress_selection = 'X'<br/><br/>display_only = ''<br/><br/>only_types_for_clifs = 'X'<br/><br/>importing result = soClass-low.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soClass-high.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'F4_DD_ALLTYPES' exporting object = soClass-high<br/><br/>suppress_selection = 'X'<br/><br/>display_only = ''<br/><br/>only_types_for_clifs = 'X'<br/><br/>importing result = soClass-high.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soFName-low.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'FUNC'<br/><br/>object_name  = soFname-low<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soFName-low<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soFName-high.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'FUNC'<br/><br/>object_name  = soFname-high<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soFName-high<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soFGroup-low.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'FUGR'<br/><br/>object_name  = soFGroup-low<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soFGroup-low<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>at selection-screen on value-request for soFGroup-high.<br/><br/>* ---------------------------------------------------------------------------------------------------------------------<br/><br/>call function 'REPOSITORY_INFO_SYSTEM_F4' exporting object_type  = 'FUGR'<br/><br/>object_name  = soFGroup-high<br/><br/>suppress_selection   = 'X'<br/><br/>use_alv_grid = ''<br/><br/>without_personal_list = ''<br/><br/>importing object_name_selected = soFGroup-high<br/><br/>exceptions cancel = 1.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* initialisation<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>initialization.<br/><br/>* Parameter screen texts.<br/><br/>tBlock1 = 'Author (Optional)'.<br/><br/>tBlock2 = 'Objects to download'.<br/><br/>tBlock3 = 'Additional downloads for programs, function modules and classes'.<br/><br/>tBlock4 = 'Download parameters'.<br/><br/>tBlock5 = 'Display options'.<br/><br/>tAuth   = 'Author name'.<br/><br/>tPmod   = 'Include programs modified by author'.<br/><br/>tCust   = 'Only customer objects'.<br/><br/>tNRange = 'Alt customer name range'.<br/><br/>tRtable = 'Tables / Structures'.<br/><br/>trtabtyp = 'Table types'.<br/><br/>tPtable = 'Table name'.<br/><br/>tTnote  = 'Note: tables are stored under the username of the last person who modified them'.<br/><br/>tRfunc  = 'Function modules'.<br/><br/>tPfname = 'Function name'.<br/><br/>tFgroup = 'Function group'.<br/><br/>tRClass  = 'Classes'.<br/><br/>tPcname = 'Class name'.<br/><br/>tMess   = 'Message class'.<br/><br/>tMName  = 'Class name'.<br/><br/>tMLang  = 'Language'.<br/><br/>tProg   = 'Programs'.<br/><br/>tRpname = 'Program name'.<br/><br/>tPack   = 'Package'.<br/><br/>tPtxt   = 'Text document'.<br/><br/>tPhtml  = 'HTML document'.<br/><br/>tBack   = 'Include background colour'.<br/><br/>tPtext  = 'Text elements'.<br/><br/>tPinc   = 'Include programs'.<br/><br/>tRecI   = 'Recursive search'.<br/><br/>tPpath  = 'File path'.<br/><br/>tSPath  = 'Logical file name'.<br/><br/>tPmes   = 'Message classes'.<br/><br/>tPfunc  = 'Function modules'.<br/><br/>tFDoc    = 'Function module documentation'.<br/><br/>tCDoc    = 'Class documentation'.<br/><br/>tRecf   = 'Recursive search'.<br/><br/>tRecC   = 'Class recursive search'.<br/><br/>tPscr   = 'Screens'.<br/><br/>tPdict  = 'Dictionary structures'.<br/><br/>tSortT  = 'Sort table fields alphabetically'.<br/><br/>tServ   = 'Download to server'.<br/><br/>tPc     = 'Download to PC'.<br/><br/>tRep    = 'Display download report'.<br/><br/>tProMess  = 'Display progress messages'.<br/><br/>tRxslt     = 'Transformations'.<br/><br/>tPxslt    = 'XSLT Name'.<br/><br/>tTtyp = 'Table Types'.<br/><br/>tXslt = 'Transformation'.<br/><br/>&nbsp;<br/><br/>* Determine the frontend operating system type.<br/><br/>if sy-batch is initial.<br/><br/>perform determineFrontendOPSystem using frontendSlashSeparator frontendOpSystem.<br/><br/>endif.<br/><br/>perform determineServerOpsystem using serverSlashSeparator serverFileSystem serverOpsystem.<br/><br/>&nbsp;<br/><br/>* Determine if the external command exists.  If it doesn't then disable the server input field<br/><br/>perform findExternalCommand using serverFileSystem.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>start-of-selection.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>perform checkComboBoxes.<br/><br/>perform fillSelectionRanges.<br/><br/>startTime = sy-uzeit.<br/><br/>&nbsp;<br/><br/>* Don't display status messages if we are running in the background<br/><br/>if not sy-batch is initial.<br/><br/>pProMess = ''.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Fool the HTML routines to stop them hyperlinking anything with a space in them<br/><br/>if pCName is initial.<br/><br/>customerNameSpace  = '^'.<br/><br/>else.<br/><br/>customerNameSpace = pCName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Set the file extension and output type of the file<br/><br/>if pTxt is initial.<br/><br/>downloadFileExtension = HTMLEXTENSION.<br/><br/>else.<br/><br/>downloadFileExtension = TEXTEXTENSION.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Determine which operating slash and download directory to use<br/><br/>case 'X'.<br/><br/>when pPc.<br/><br/>slashSeparatorToUse = frontendSlashSeparator.<br/><br/>downloadFolder = pFolder.<br/><br/>when pServ.<br/><br/>slashSeparatorToUse = serverSlashSeparator.<br/><br/>downloadFolder = serverFolder.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>* Main program flow.<br/><br/>case 'X'.<br/><br/>*   Select tables<br/><br/>when rTable.<br/><br/>perform retrieveTables using iDictionary[]<br/><br/>soTableNames[]<br/><br/>soAuthor[]<br/><br/>soPack[].<br/><br/>&nbsp;<br/><br/>when rTabType.<br/><br/>perform retrieveTableTypes using iTableTypes[]<br/><br/>soTableTypeNames[]<br/><br/>soAuthor[]<br/><br/>soPack[].<br/><br/>&nbsp;<br/><br/>*   Select message classes tables<br/><br/>when rMess.<br/><br/>perform retrieveMessageClass using iMessages[]<br/><br/>soAuthor[]      "Author<br/><br/>pMname          "Message class name<br/><br/>pMLang          "Message class language<br/><br/>pMod            "Modified by author<br/><br/>soPack[].       "Package<br/><br/>&nbsp;<br/><br/>*   Select function modules<br/><br/>when rFunc.<br/><br/>perform retrieveFunctions using soFunctionName[]   "Function name<br/><br/>soFunctionGroup[]  "Function group<br/><br/>iFunctions[]       "Found functions<br/><br/>soAuthor[]         "Author<br/><br/>pText              "Get text elements<br/><br/>pScr               "Get screens<br/><br/>pCust              "Customer data only<br/><br/>customerNameSpace  "Customer name range<br/><br/>soPack[].             "Package<br/><br/>&nbsp;<br/><br/>*       Find Dict structures, messages, functions, includes etc.<br/><br/>perform scanForAdditionalFuncStuff using iFunctions[]<br/><br/>pRecI                   "Search for includes recursively<br/><br/>pRecF                   "Search for functions recursively<br/><br/>pInc                    "Search for includes<br/><br/>pFunc                   "Search for functions<br/><br/>pDict                   "search for dictionary objects<br/><br/>pMess                   "Search for messages<br/><br/>pTrans                  "Search for transformations<br/><br/>pCust                   "Customer data only<br/><br/>customerNameSpace.      "Customer name range<br/><br/>&nbsp;<br/><br/>*   Select Classes<br/><br/>when rClass.<br/><br/>perform retrieveClasses using iClasses[]<br/><br/>iFunctions[]<br/><br/>soClassName[]       "Class name<br/><br/>soAuthor[]          "Author<br/><br/>customerNameSpace   "Customer name range<br/><br/>pMod                "Also modified by author<br/><br/>pCust               "Customer object only<br/><br/>pMess               "Find messages<br/><br/>pText               "Text Elements<br/><br/>pDict               "Dictionary structures<br/><br/>pFunc               "Get functions<br/><br/>pInc                "Get includes<br/><br/>pTrans<br/><br/>pRecF               "Search recursively for functions<br/><br/>pRecI               "Search recursively for includes<br/><br/>pRecC               "Search recursively for classes<br/><br/>pMLang              "Language<br/><br/>soPack[].           "Package<br/><br/>&nbsp;<br/><br/>loop at iFunctions.<br/><br/>*       Find Dict structures, messages, functions, includes etc.<br/><br/>perform scanForAdditionalFuncStuff using iFunctions[]<br/><br/>pRecI                   "Search for includes recursively<br/><br/>pRecF                   "Search for functions recursively<br/><br/>pInc                    "Search for includes<br/><br/>pFunc                   "Search for functions<br/><br/>pDict                   "search for dictionary objects<br/><br/>pMess                   "Search for messages<br/><br/>pTrans                  "Search for transformations<br/><br/>pCust                   "Customer data only<br/><br/>customerNameSpace.      "Customer name range<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Select programs<br/><br/>when rProg.<br/><br/>perform retrievePrograms using iPrograms[]<br/><br/>iProgFunctions[]<br/><br/>soProgramName[]    "Program name<br/><br/>soAuthor[]         "Author<br/><br/>customerNamespace  "Customer name range<br/><br/>pMod               "Also modified by author<br/><br/>pCust              "Customer object only<br/><br/>pMess              "Find messages<br/><br/>pText              "Text Elements<br/><br/>pDict              "Dictionay structures<br/><br/>pFunc              "Get functions<br/><br/>pInc               "Get includes<br/><br/>pScr               "Get screens<br/><br/>pTrans             "Get Transformations<br/><br/>pRecF              "Search recursively for functions<br/><br/>pRecI              "Search recursively for includes<br/><br/>soPack[].             "Package<br/><br/>&nbsp;<br/><br/>when rXslt.<br/><br/>perform retrieveXslt using iTransformations[]<br/><br/>soXsltName[]           "XSL Transformation name<br/><br/>soAuthor[]             "Author<br/><br/>customerNamespace      "Customer name range<br/><br/>pMod                   "Also modified by author<br/><br/>pCust                  "Customer object only<br/><br/>soPack[].              "Package<br/><br/>&nbsp;<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>end-of-selection.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>if forcedExit = 0.<br/><br/>*   Decide what to download<br/><br/>case 'X'.<br/><br/>*     Download tables<br/><br/>when rTable.<br/><br/>if not ( iDictionary[] is initial ).<br/><br/>perform downloadDDStructures using iDictionary[]<br/><br/>iDictFilename[]<br/><br/>downloadFolder<br/><br/>HTMLEXtension<br/><br/>space<br/><br/>pSortT<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>when rTabType.<br/><br/>if not ( iTableTypes[] is initial ).<br/><br/>perform downloadDDTableTypes using iTabletypes[]<br/><br/>iTableTypeFilename[]<br/><br/>downloadFolder<br/><br/>htmlExtension<br/><br/>space<br/><br/>pSortt<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*     Download message class<br/><br/>when rMess.<br/><br/>if not ( iMessages[] is initial ).<br/><br/>sort iMessages ascending by arbgb msgnr.<br/><br/>loop at iMessages.<br/><br/>append iMessages to iSingleMessageClass.<br/><br/>at end of arbgb.<br/><br/>perform downloadMessageClass using iSingleMessageClass[]<br/><br/>iMessages-arbgb<br/><br/>downloadFolder<br/><br/>downloadFileExtension<br/><br/>pHtml<br/><br/>space<br/><br/>customerNameSpace<br/><br/>pInc<br/><br/>pDict<br/><br/>pMess<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>clear iSingleMessageClass[].<br/><br/>endat.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*     Download functions<br/><br/>when rFunc.<br/><br/>if not ( iFunctions[] is initial ).<br/><br/>perform downloadFunctions using iFunctions[]<br/><br/>iDictFilename[]<br/><br/>iTableTypeFilename[]<br/><br/>downloadFolder<br/><br/>downloadFileExtension<br/><br/>space<br/><br/>pFDoc<br/><br/>pHtml<br/><br/>customerNameSpace<br/><br/>pInc<br/><br/>pDict<br/><br/>TEXTEXTENSION<br/><br/>HTMLEXTENSION<br/><br/>pSortT<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*     Download Classes<br/><br/>when rClass.<br/><br/>if not ( iClasses[] is initial ).<br/><br/>perform downloadClasses using iClasses[]<br/><br/>iFunctions[]<br/><br/>iDictFilename[]<br/><br/>iTableTypeFilename[]<br/><br/>downloadFolder<br/><br/>downloadFileExtension<br/><br/>HTMLEXTENSION<br/><br/>TEXTEXTENSION<br/><br/>pHtml<br/><br/>customerNameSpace<br/><br/>pInc<br/><br/>pDict<br/><br/>pCDoc<br/><br/>pSortT<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*     Download programs<br/><br/>when rProg.<br/><br/>if not ( iPrograms[] is initial ).<br/><br/>perform downloadPrograms using iPrograms[]<br/><br/>iProgFunctions[]<br/><br/>iDictFilename[]<br/><br/>iTableTypeFilename[]<br/><br/>downloadFolder<br/><br/>downloadFileExtension<br/><br/>HTMLEXTENSION<br/><br/>TEXTEXTENSION<br/><br/>pHtml<br/><br/>customerNameSpace<br/><br/>pInc<br/><br/>pDict<br/><br/>'' "Documentation<br/><br/>pSortT<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>when rXSLT.<br/><br/>if not ( iTransformations[] is initial ).<br/><br/>perform downloadXSLT using iTransformations[]<br/><br/>downloadFolder<br/><br/>downloadFileExtension<br/><br/>htmlExtension<br/><br/>textExtension<br/><br/>pHtml<br/><br/>customerNamespace<br/><br/>slashSeparatorToUse<br/><br/>pServ<br/><br/>space<br/><br/>pProMess<br/><br/>serverFileSystem<br/><br/>pBack.<br/><br/>endif.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>*   Free all the memory IDs we may have built up in the program<br/><br/>*   Free up any memory used for caching HTML versions of objects<br/><br/>perform freeMemory using iPrograms[]<br/><br/>iFunctions[]<br/><br/>iProgFunctions[]<br/><br/>iDictionary[]<br/><br/>iTableTypes[]<br/><br/>iTransformations[].<br/><br/>&nbsp;<br/><br/>if not pRep is initial.<br/><br/>get time.<br/><br/>runTime = sy-uzeit - startTime.<br/><br/>&nbsp;<br/><br/>case 'X'.<br/><br/>when rTable.<br/><br/>perform fillTreeNodeTables using iDictionary[]<br/><br/>iTreeDisplay[]<br/><br/>runTime.<br/><br/>when rTabType.<br/><br/>perform fillTreeNodeTableTypes using iTableTypes[]<br/><br/>iTreeDisplay[]<br/><br/>runtime.<br/><br/>&nbsp;<br/><br/>when rMess.<br/><br/>perform fillTreeNodeMessages using iMessages[]<br/><br/>iTreeDisplay[]<br/><br/>runTime.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>when rFunc.<br/><br/>perform fillTreeNodeFunctions using iFunctions[]<br/><br/>iTreeDisplay[]<br/><br/>runTime.<br/><br/>&nbsp;<br/><br/>when rClass.<br/><br/>perform fillTreeNodeClasses using iClasses[]<br/><br/>iFunctions[]<br/><br/>iTreeDisplay[]<br/><br/>runTime.<br/><br/>&nbsp;<br/><br/>when rProg.<br/><br/>perform fillTreeNodePrograms using iPrograms[]<br/><br/>iProgFunctions[]<br/><br/>iTreeDisplay[]<br/><br/>runTime.<br/><br/>&nbsp;<br/><br/>when rXSLT.<br/><br/>perform fillTreeNodeXSLT using iTransformations[]<br/><br/>iTreeDisplay[]<br/><br/>runtime.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>if not ( iTreeDisplay[] is initial ).<br/><br/>perform displayTree using iTreeDisplay[].<br/><br/>else.<br/><br/>statusBarMessage = 'No items found matching selection criteria'.<br/><br/>perform displayStatus using statusBarMessage 2.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Clear out all the internal tables<br/><br/>clear iPrograms[].<br/><br/>clear iFunctions[].<br/><br/>clear iClasses[].<br/><br/>clear iProgFunctions[].<br/><br/>clear iMessages[].<br/><br/>clear iDictionary[].<br/><br/>clear iDictFilename[].<br/><br/>clear iTableTypeFilename[].<br/><br/>clear iTransformations[].<br/><br/>clear iTableTypes[].<br/><br/>&nbsp;<br/><br/>*--- Memory IDs<br/><br/>* User name<br/><br/>set parameter id 'MAUTH' field pAuth.<br/><br/>* Message class<br/><br/>set parameter id 'MMNAME' field pMname.<br/><br/>* Customer namespace<br/><br/>set parameter id 'MNAMESPACE' field pCName.<br/><br/>* Folder<br/><br/>set parameter id 'MFOLDER' field pFolder.<br/><br/>* Logical filepath<br/><br/>set parameter id 'MLOGICAL' field pLogical.<br/><br/>* Text element checkbox<br/><br/>set parameter id 'MTEXT' field pText.<br/><br/>* Messages checkbox<br/><br/>set parameter id 'MMESS' field pMess.<br/><br/>* Includes checkbox<br/><br/>set parameter id 'MINC' field pInc.<br/><br/>* Recursive includes checkbox.<br/><br/>set parameter id 'MRECI' field pReci.<br/><br/>* Functions checkbox<br/><br/>set parameter id 'MFUNC' field pFunc.<br/><br/>* Recursive functions checkbox<br/><br/>set parameter id 'MRECF' field pRecf.<br/><br/>* Recursive classes checkbox<br/><br/>set parameter id 'MRECF' field pRecC.<br/><br/>* Function module documentation checkbox<br/><br/>set parameter id 'MFDOC' field pFDoc.<br/><br/>* Class documentation checkbox<br/><br/>set parameter id 'MCDOC' field pCDoc.<br/><br/>* Screens checkbox<br/><br/>set parameter id 'MSCR' field pScr.<br/><br/>* Dictionary checkbox<br/><br/>set parameter id 'MDICT' field pDict.<br/><br/>* Sort table ascending checkBox<br/><br/>set parameter id 'MSORTT' field pSortT.<br/><br/>* Table Types checkbox<br/><br/>set parameter id 'MTTYP' field pTTyp.<br/><br/>* XSLT checkbox<br/><br/>set parameter id 'MXSLT' field pTrans.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>***********************************************************************************************************************<br/><br/>***************************************************SUBROUTINES*********************************************************<br/><br/>***********************************************************************************************************************<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  free memory...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form freeMemory using iLocPrograms like iPrograms[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>iLocProgfunctions like iProgFunctions[]<br/><br/>iLocDictionary like iDictionary[]<br/><br/>iLocTableTypes like iTableTypes[]<br/><br/>iLocTransformation like iTransformations[] .<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;wafunction&gt; like line of iLocfunctions.<br/><br/>field-symbols: &lt;waProgram&gt; like line of iLocPrograms.<br/><br/>field-symbols: &lt;waDictStruct&gt; type tDictTable.<br/><br/>field-symbols: &lt;waTableTypeStruct&gt; like line of iLocTableTypes.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>&nbsp;<br/><br/>loop at iLocFunctions assigning &lt;waFunction&gt;.<br/><br/>loop at &lt;waFunction&gt;-iDictStruct assigning &lt;waDictStruct&gt;.<br/><br/>free memory id &lt;waDictStruct&gt;-tablename.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iLocProgFunctions assigning &lt;waFunction&gt;.<br/><br/>loop at &lt;waFunction&gt;-iDictStruct assigning &lt;waDictStruct&gt;.<br/><br/>free memory id &lt;waDictStruct&gt;-tablename.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iLocPrograms assigning &lt;waProgram&gt;.<br/><br/>loop at &lt;waProgram&gt;-iDictStruct assigning &lt;waDictStruct&gt;.<br/><br/>free memory id &lt;waDictStruct&gt;-tablename.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iLocDictionary assigning &lt;waDictStruct&gt;.<br/><br/>free memory id &lt;waDictStruct&gt;-tablename.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iLocTableTypes assigning &lt;waTableTypeStruct&gt;.<br/><br/>free memory id &lt;waTableTypeStruct&gt;-typename.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iLocTransformation assigning &lt;waTransformation&gt;.<br/><br/>free memory id &lt;waTransformation&gt;-xsltName.<br/><br/>endloop.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  checkComboBoxes...  Check input parameters<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form checkComboBoxes.<br/><br/>&nbsp;<br/><br/>if pAuth is initial.<br/><br/>if soPack[] is initial.<br/><br/>case 'X'.<br/><br/>when rTable.<br/><br/>if soTable[] is initial.<br/><br/>statusBarMessage = 'You must enter either a table name or author.'.<br/><br/>endif.<br/><br/>when rFunc.<br/><br/>if ( soFName[] is initial ) and ( soFGroup[] is initial ).<br/><br/>if soFName[] is initial.<br/><br/>statusBarMessage = 'You must enter either a function name or author.'.<br/><br/>else.<br/><br/>if soFGroup[] is initial.<br/><br/>statusBarMessage = 'You must enter either a function group, or an author name.'.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>when rProg.<br/><br/>if soProg[] is initial.<br/><br/>statusBarMessage = 'You must enter either a program name or author name.'.<br/><br/>endif.<br/><br/>endcase.<br/><br/>endif.<br/><br/>else.<br/><br/>*   Check the user name of the person objects are to be downloaded for<br/><br/>if pAuth = 'SAP*' or pauth = 'SAP'.<br/><br/>statusBarMessage = 'Sorry cannot download all objects for SAP standard user'.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not statusBarMessage is initial.<br/><br/>perform displayStatus using statusBarMessage 3.<br/><br/>forcedExit = 1.<br/><br/>stop.<br/><br/>endif.<br/><br/>endform.                                                                                "checkComboBoxes<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* fillSelectionRanges...      for selection routines<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillSelectionRanges.<br/><br/>&nbsp;<br/><br/>data: strLength type i.<br/><br/>&nbsp;<br/><br/>strLength = strlen( pcName ).<br/><br/>&nbsp;<br/><br/>if not pAuth is initial.<br/><br/>soAuthor-sign = 'I'.<br/><br/>soAuthor-option = 'EQ'.<br/><br/>soAuthor-low = pAuth.<br/><br/>append soAuthor.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Tables<br/><br/>if not soTable is initial.<br/><br/>soTableNames[] = soTable[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soTableNames.<br/><br/>if soTableNames-low+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soTableNames-low into soTableNames-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soTableNames-high+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soTableNames-high into soTableNames-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soTableNames.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Function names<br/><br/>if not soFName is initial.<br/><br/>soFunctionName[] = soFname[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soFunctionName.<br/><br/>if soFunctionName-low+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soFunctionName-low into soFunctionName-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soFunctionName-high+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soFunctionName-high into soFunctionName-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soFunctionName.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Table Types<br/><br/>if not soTabTyp is initial.<br/><br/>soTableTypeNames[] = soTabTyp[].<br/><br/>&nbsp;<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pCname is initial.<br/><br/>loop at soTableTypeNames.<br/><br/>if soTableTypeNames-low+0(strlength) &lt;&gt; pcname.<br/><br/>concatenate pCname soTableTypeNames-low into soTableTypeNames-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soTableNames-high+0(strlength) &lt;&gt; pcname.<br/><br/>concatenate pcname soTableTypeNames-high into soTableTypeNames-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soTableTypeNames.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Function group<br/><br/>if not soFGroup is initial.<br/><br/>soFunctionGroup[] = soFGroup[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soFunctionName.<br/><br/>if soFunctionGroup-low+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soFunctionGroup-low into soFunctionGroup-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soFunctionGroup-high+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soFunctionGroup-high into soFunctionGroup-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soFunctionGroup.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Class names<br/><br/>if not soClass is initial.<br/><br/>soClassName[] = soClass[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soClassName.<br/><br/>if soClassName-low+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soClassName-low into soClassName-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soClassName-high+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soClassName-high into soClassName-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soClassName.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Program names<br/><br/>if not soProg is initial.<br/><br/>soProgramName[] = soProg[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soProgramName.<br/><br/>if soProgramName-low+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soProgramName-low into soProgramName-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soProgramName-high+0(strLength) &lt;&gt; pcName.<br/><br/>concatenate pcName soProgramName-high into soProgramName-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soProgramName.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* XSLT names<br/><br/>if not soXslt is initial.<br/><br/>soXsltName[] = soXslt[].<br/><br/>*   Add in the customer namespace if we need to<br/><br/>if not pcName is initial.<br/><br/>loop at soXsltName.<br/><br/>if soXsltName-low+0(strlength) &lt;&gt; pcName.<br/><br/>concatenate pcName soXsltName-low into soXsltname-low.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if soXsltName-high+0(strlength) &lt;&gt; pcName.<br/><br/>concatenate pcName soXsltName-high into soXsltName-high.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify soXsltName.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                                          " fillSelectionRanges<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveTables...             Search for tables in dictionary<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrieveTables using iLocDictStructure like iDictionary[]<br/><br/>soTable like soTable[]<br/><br/>soAuthor like soAuthor[]<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: iDictStructure type standard table of tDictTable.<br/><br/>data: waDictStructure type tDictTable.<br/><br/>&nbsp;<br/><br/>select a~tabname as tableName<br/><br/>into corresponding fields of table iDictStructure<br/><br/>from dd02l as a<br/><br/>inner join tadir as b<br/><br/>on a~tabname = b~obj_name<br/><br/>where a~tabname in soTable<br/><br/>and a~tabclass &lt;&gt; 'CLUSTER'<br/><br/>and a~tabclass &lt;&gt; 'POOL'<br/><br/>and a~tabclass &lt;&gt; 'VIEW'<br/><br/>and a~as4user in soAuthor<br/><br/>and a~as4local = 'A'<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'TABL'<br/><br/>and b~devclass in soLocPackage[].<br/><br/>&nbsp;<br/><br/>loop at iDictStructure into waDictStructure.<br/><br/>perform findTableDescription using waDictStructure-tablename<br/><br/>waDictStructure-tableTitle.<br/><br/>&nbsp;<br/><br/>perform findTableDefinition using waDictStructure-tableName<br/><br/>waDictStructure-iStructure[].<br/><br/>&nbsp;<br/><br/>append waDictStructure to iLocDictStructure.<br/><br/>clear waDictStructure.<br/><br/>endloop.<br/><br/>endform.                                                                                                "retrieveTables<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveTableTypes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrieveTableTypes  using iLocTableTypes      like iTableTypes[]<br/><br/>soTableTypeNames    like soTable[]<br/><br/>soAuthor            like soAuthor[]<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>select *<br/><br/>into corresponding fields of table iLocTableTypes<br/><br/>from dd40l as a<br/><br/>inner join dd40t as t<br/><br/>on a~typename = t~typename<br/><br/>inner join tadir as b<br/><br/>on a~typename = b~obj_name<br/><br/>where a~typename in sotabletypenames<br/><br/>and t~ddlanguage eq sy-langu<br/><br/>and a~as4user in soauthor<br/><br/>and a~as4local = 'A'<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'TTYP'<br/><br/>and b~devclass in solocpackage[].<br/><br/>&nbsp;<br/><br/>endform.                                                                                          " RETRIEVETABLETYPES<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveXSLT...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form retrieveXSLT using ilocTransformations like iTransformations[]<br/><br/>rangexslt   like soxsltname[]<br/><br/>rangeauthor like soAuthor[]<br/><br/>value(custnamerange)<br/><br/>value(alsomodifiedbyauthor)<br/><br/>value(customerprogsonly)<br/><br/>value(solocpackage) like sopack[].<br/><br/>&nbsp;<br/><br/>data: warangexslt like line of rangexslt.<br/><br/>&nbsp;<br/><br/>if rangexslt[] is initial.<br/><br/>*   We are finding all programs by an author<br/><br/>perform findAllXsltForAuthor using iLocTransformations[]<br/><br/>rangexslt[]<br/><br/>rangeauthor[]<br/><br/>custnamerange<br/><br/>alsomodifiedbyauthor<br/><br/>customerprogsonly<br/><br/>solocpackage[].<br/><br/>else.<br/><br/>read table rangexslt index 1 into warangexslt.<br/><br/>if warangexslt-low cs asterix.<br/><br/>perform findXsltByWildcard using ilocTransformations[]<br/><br/>rangexslt[]<br/><br/>rangeauthor[]<br/><br/>custnamerange<br/><br/>customerprogsonly<br/><br/>solocpackage[].<br/><br/>else.<br/><br/>perform checkXsltDoesExist using ilocTransformations[]<br/><br/>rangexslt[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                               "retrieveXSLT<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  findTableDescription...  Search for table description in dictionary<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findTableDescription using value(tableName)<br/><br/>tableDescription.<br/><br/>&nbsp;<br/><br/>select single ddtext<br/><br/>from dd02t<br/><br/>into tableDescription<br/><br/>where tabname = tableName<br/><br/>and ddlanguage = pMLang.<br/><br/>endform.                                                                                          "findTableDescription<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  findTableDefinition... Find the structure of a table from the SAP database.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findTableDefinition using value(tablename)<br/><br/>iDictStruct like dumIDictStructure[].<br/><br/>&nbsp;<br/><br/>data gotstate like dcobjif-gotstate.<br/><br/>data: definition type standard table of DD03P with header line.<br/><br/>data: iDomainDataA type standard table of dd07v with header line.<br/><br/>data: iDomainDataN type standard table of dd07v with header line.<br/><br/>data: waDictStruct type tDictTableStructure.<br/><br/>data: waDomainStruct type tDomainStructure.<br/><br/>data: wadd02v_n type dd02v.<br/><br/>&nbsp;<br/><br/>clear iDictStruct[].<br/><br/>&nbsp;<br/><br/>call function 'DD_INT_TABL_GET'<br/><br/>exporting<br/><br/>tabname              = tablename<br/><br/>langu                = pmlang<br/><br/>importing<br/><br/>gotstate             = gotstate<br/><br/>dd02v_n              = wadd02v_n<br/><br/>tables<br/><br/>dd03p_n              = definition<br/><br/>exceptions<br/><br/>internal_error       = 1.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0 and not wadd02v_n is initial.<br/><br/>call function 'DD_TABL_EXPAND'<br/><br/>exporting<br/><br/>dd02v_wa                = wadd02v_n<br/><br/>mode                    = 46<br/><br/>prid                    = 0<br/><br/>tables<br/><br/>dd03p_tab               = definition<br/><br/>exceptions<br/><br/>illegal_parameter       = 1.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0 and gotstate = 'A'.<br/><br/>loop at definition.<br/><br/>move-corresponding definition to waDictStruct.<br/><br/>perform removeLeadingZeros changing waDictStruct-position.<br/><br/>perform removeLeadingZeros changing waDictStruct-leng.<br/><br/>&nbsp;<br/><br/>*     Add any domain data<br/><br/>call function 'DD_DOMA_GET'<br/><br/>exporting<br/><br/>domain_name         = definition-domname<br/><br/>get_state           = 'M  '<br/><br/>langu               = pmlang<br/><br/>*          prid                = 0<br/><br/>withtext            = 'X'<br/><br/>tables<br/><br/>dd07v_tab_a         = iDomainDataA<br/><br/>dd07v_tab_n         = iDomainDataN<br/><br/>exceptions<br/><br/>illegal_value       = 1<br/><br/>op_failure          = 2.<br/><br/>&nbsp;<br/><br/>loop at iDomainDataA.<br/><br/>move-corresponding iDomainDataA to waDomainStruct.<br/><br/>append waDomainStruct to waDictStruct-iDomains.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>clear iDomainDataA[].<br/><br/>append waDictStruct to iDictStruct.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                                           "findTableDefinition<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveMessageClass...   Retrieve a message class from the SAP database<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrieveMessageClass using iLocMessages like iMessages[]<br/><br/>rangeAuthor like soAuthor[]<br/><br/>value(messageClassName)<br/><br/>value(messageClassLang)<br/><br/>value(modifiedBy)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: waMessage type tMessage.<br/><br/>data: iMClasses type standard table of arbgb.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>if not messageClassName is initial.<br/><br/>*   Check to see if the message class exists in the package<br/><br/>if not soLocPackage[] is initial.<br/><br/>select obj_name as arbgb<br/><br/>into table iMClasses<br/><br/>from tadir<br/><br/>where pgmid = 'R3TR'<br/><br/>and object = 'MSAG'<br/><br/>and devclass in soLocPackage.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>replace '*' with '%' into messageClassName.<br/><br/>if iMCLasses[] is initial.<br/><br/>select t100~arbgb<br/><br/>t100~text<br/><br/>t100~msgnr<br/><br/>t100a~stext<br/><br/>appending corresponding fields of table iLocMessages<br/><br/>from t100<br/><br/>inner join t100a<br/><br/>on t100a~arbgb = t100~arbgb<br/><br/>where t100a~masterLang = messageClassLang<br/><br/>and t100~sprsl = messageClassLang<br/><br/>and t100~arbgb like messageClassName<br/><br/>and t100a~respUser in rangeAuthor[].<br/><br/>else.<br/><br/>select t100~arbgb<br/><br/>t100~text<br/><br/>t100~msgnr<br/><br/>t100a~stext<br/><br/>appending corresponding fields of table iLocMessages<br/><br/>from t100<br/><br/>inner join t100a<br/><br/>on t100a~arbgb = t100~arbgb<br/><br/>for all entries in iMClasses<br/><br/>where t100~sprsl = messageClassLang<br/><br/>and ( t100~arbgb like messageClassName and t100~arbgb = iMClasses-table_line )<br/><br/>and t100a~masterLang = messageClassLang<br/><br/>and t100a~respUser in rangeAuthor[].<br/><br/>endif.<br/><br/>else.<br/><br/>if modifiedBy is initial.<br/><br/>*       Select by author<br/><br/>select t100~arbgb                             "#EC CI_BUFFJOIN<br/><br/>t100~msgnr<br/><br/>t100~text<br/><br/>t100a~stext<br/><br/>appending corresponding fields of table iLocMessages<br/><br/>from t100<br/><br/>inner join t100a<br/><br/>on t100a~arbgb = t100~arbgb<br/><br/>inner join tadir<br/><br/>on t100~arbgb = tadir~obj_name<br/><br/>where t100a~masterLang = messageClassLang<br/><br/>and t100a~respUser in rangeAuthor[]<br/><br/>and tadir~pgmid = 'R3TR'<br/><br/>and tadir~object = 'MSAG'<br/><br/>and tadir~devclass in soLocPackage[].<br/><br/>&nbsp;<br/><br/>else.<br/><br/>*     Select also by the last person who modified the message class<br/><br/>select t100~arbgb                             "#EC CI_BUFFJOIN<br/><br/>t100~msgnr<br/><br/>t100~text<br/><br/>t100a~stext<br/><br/>appending corresponding fields of table iLocMessages<br/><br/>from t100<br/><br/>inner join t100a<br/><br/>on t100a~arbgb = t100~arbgb<br/><br/>inner join tadir<br/><br/>on t100~arbgb = tadir~obj_name<br/><br/>where t100a~masterLang = messageClassLang<br/><br/>and t100a~respUser in rangeAuthor[]<br/><br/>and t100a~lastUser in rangeAuthor[]<br/><br/>and tadir~pgmid = 'R3TR'<br/><br/>and tadir~object = 'MSAG'<br/><br/>and tadir~devclass in soLocPackage[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                                          "retrieveMessageClass<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveFunctions...   Retrieve function modules from SAP DB.  May be called in one of two ways<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrieveFunctions using soFName like soFunctionName[]<br/><br/>soFGroup like soFunctionGroup[]<br/><br/>iLocFunctionNames like iFunctions[]<br/><br/>value(solocAuthor) like soAuthor[]<br/><br/>value(getTextElements)<br/><br/>value(getScreens)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: waFunctionName type tFunction.<br/><br/>data: noGroupsFound type abap_bool value TRUE.<br/><br/>data: previousFG type v_fdir-area.<br/><br/>&nbsp;<br/><br/>* select by function name and/or function group.<br/><br/>select a~funcName as functionName<br/><br/>a~area as functionGroup<br/><br/>into corresponding fields of table iLocfunctionNames<br/><br/>from v_fdir as a<br/><br/>inner join tlibv as b<br/><br/>on a~area = b~area<br/><br/>inner join tadir as c<br/><br/>on a~area = c~obj_name<br/><br/>where a~funcName in soFName[]<br/><br/>and a~area in soFGroup[]<br/><br/>and a~generated = ''<br/><br/>and b~uname in soLocAuthor[]<br/><br/>and pgmid = 'R3TR'<br/><br/>and object = 'FUGR'<br/><br/>and devclass in solocPackage[]<br/><br/>order by a~area.<br/><br/>&nbsp;<br/><br/>loop at iLocFunctionNames into waFunctionName.<br/><br/>perform retrieveFunctionDetail using waFunctionName-functionName<br/><br/>waFunctionName-progname<br/><br/>waFunctionName-includeNumber<br/><br/>waFunctionName-functionTitle.<br/><br/>&nbsp;<br/><br/>perform findMainFunctionInclude using waFunctionName-progname<br/><br/>wafunctionName-functionGroup<br/><br/>waFunctionName-includeNumber<br/><br/>waFunctionName-functionMainInclude.<br/><br/>&nbsp;<br/><br/>perform findFunctionTopInclude using waFunctionName-progname<br/><br/>wafunctionName-functionGroup<br/><br/>waFunctionName-topIncludeName.<br/><br/>&nbsp;<br/><br/>*   Find all user defined includes within the function group<br/><br/>perform scanForFunctionIncludes using waFunctionName-progname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunctionName-iIncludes[].<br/><br/>*   Find main message class<br/><br/>perform findMainMessageClass using waFunctionName-progname<br/><br/>waFunctionName-messageClass.<br/><br/>&nbsp;<br/><br/>*   Find any screens declared within the main include<br/><br/>if not getScreens is initial.<br/><br/>if previousFG is initial or previousFG &lt;&gt; waFunctionName-functionGroup.<br/><br/>perform findFunctionScreenFlow using waFunctionName.<br/><br/>&nbsp;<br/><br/>*       Search for any GUI texts<br/><br/>perform retrieveGUITitles using waFunctionName-iGUITitle[]<br/><br/>waFunctionName-progname.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not getTextElements is initial.<br/><br/>*     Find the program texts from out of the database.<br/><br/>perform retrieveProgramTexts using waFunctionName-iSelectionTexts[]<br/><br/>waFunctionName-iTextElements[]<br/><br/>waFunctionName-progname.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>previousFG = waFunctionName-functionGroup.<br/><br/>modify iLocFunctionNames from waFunctionName.<br/><br/>endloop.<br/><br/>endform.                                                                                             "retrieveFunctions<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveFunctionDetail...   Retrieve function module details from SAP DB.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrieveFunctionDetail using value(functionName)<br/><br/>progname<br/><br/>includeName<br/><br/>titleText.<br/><br/>&nbsp;<br/><br/>select single pname<br/><br/>include<br/><br/>from tfdir<br/><br/>into (progname, includeName)<br/><br/>where funcName = functionName.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>select single stext<br/><br/>from tftit<br/><br/>into titleText<br/><br/>where spras = pMLang<br/><br/>and funcName = functionName.<br/><br/>endif.<br/><br/>endform.                                                                                        "retrieveFunctionDetail                                                                                  "findFunctionTopInclude<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanForAdditionalFuncStuff... Search for additional things relating to functions<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForAdditionalFuncStuff using iLocFunctions like iFunctions[]<br/><br/>value(recursiveIncludes)<br/><br/>value(recursiveFunctions)<br/><br/>value(searchForIncludes)<br/><br/>value(searchForFunctions)<br/><br/>value(searchForDictionary)<br/><br/>value(searchForMessages)<br/><br/>value(searchForTransformations)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange).<br/><br/>&nbsp;<br/><br/>data: waFunction type tFunction.<br/><br/>data: waInclude type tInclude.<br/><br/>&nbsp;<br/><br/>loop at iLocFunctions into waFunction.<br/><br/>if not searchForIncludes is initial.<br/><br/>*     Search in the main program<br/><br/>perform scanForIncludePrograms using waFunction-progname<br/><br/>recursiveIncludes<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iIncludes[].<br/><br/>&nbsp;<br/><br/>*     Search in the main include<br/><br/>perform scanForIncludePrograms using waFunction-functionMainInclude<br/><br/>recursiveIncludes<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iIncludes[].<br/><br/>&nbsp;<br/><br/>*     Search in the top include<br/><br/>perform scanForIncludePrograms using waFunction-topIncludeName<br/><br/>recursiveIncludes<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iIncludes[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not searchForFunctions is initial.<br/><br/>perform scanForFunctions using waFunction-functionMainInclude<br/><br/>waFunction-programLinkName<br/><br/>recursiveIncludes<br/><br/>recursiveFunctions<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocFunctions[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify iLocFunctions from waFunction.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>loop at iLocFunctions into waFunction.<br/><br/>*   Now we have everthing perhaps we had better find all the dictionary structures<br/><br/>if not searchForDictionary is initial.<br/><br/>perform scanForTables using waFunction-progname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waFunction-progname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[]<br/><br/>waFunction-iTableTypes[].<br/><br/>&nbsp;<br/><br/>perform scanForTables using waFunction-functionMainInclude<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waFunction-functionMainInclude<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[]<br/><br/>waFunction-iTableTypes[].<br/><br/>&nbsp;<br/><br/>loop at waFunction-iIncludes into waInclude.<br/><br/>perform scanForTables using waInclude-includeName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waInclude-includeName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iDictStruct[]<br/><br/>waFunction-iTableTypes[].<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>modify iLocFunctions from waFunction.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Now search for all messages<br/><br/>if not searchForMessages is initial.<br/><br/>perform scanForMessages using waFunction-progName<br/><br/>waFunction-messageClass<br/><br/>waFunction-iMessages[].<br/><br/>modify iLocFunctions from waFunction.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Search for TRansformations.<br/><br/>if not searchForTransformations is initial.<br/><br/>perform scanForTransformations using waFunction-progName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iTransformations[].<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                    "scanForAdditionalFuncStuff<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanForClasses... Search each class or method for other classes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForClasses using value(className)<br/><br/>value(classLinkName)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocClasses like iClasses[]<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data iLines type standard table of string with header line.<br/><br/>data: head type string.<br/><br/>data: tail type string.<br/><br/>data: lineLength type i value 0.<br/><br/>data: waLine type string.<br/><br/>data: waClass type tClass.<br/><br/>data: waSearchClass type tClass.<br/><br/>data: castClassName type program.<br/><br/>data: exceptionCustomerNameRange type string.<br/><br/>&nbsp;<br/><br/>* Build the name of the possible cusotmer exception classes<br/><br/>concatenate customerNameRange 'CX_' into  exceptionCustomerNameRange.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castClassName = className.<br/><br/>read report castClassName into iLines.<br/><br/>&nbsp;<br/><br/>loop at iLines into waLine.<br/><br/>*   Find custom tables.<br/><br/>lineLength = strLen( waLine ).<br/><br/>if lineLength &gt; 0.<br/><br/>if waLine(1) = ASTERIX.<br/><br/>continue.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>translate waLine to upper case.<br/><br/>&nbsp;<br/><br/>find TYPEREFTO in waLine ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>*       Have found a reference to another class<br/><br/>split waLine at TYPE into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at 'REF' into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at 'TO' into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>if tail cs PERIOD.<br/><br/>split tail at PERIOD into head tail.<br/><br/>else.<br/><br/>if tail cs COMMA.<br/><br/>split tail at COMMA into head tail.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>*       Try and find classes which are only referenced through static mehods<br/><br/>find '=&gt;' in waLine match offset sy-fdpos.<br/><br/>if sy-subrc = 0.<br/><br/>head = waline+0(sy-fdpos).<br/><br/>shift head left deleting leading space.<br/><br/>condense head.<br/><br/>find 'call method' in head ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>shift head left deleting leading space.<br/><br/>split head at space into head tail.<br/><br/>split tail at space into head tail.<br/><br/>*           Should have the class name here<br/><br/>head = tail.<br/><br/>else.<br/><br/>*           Still have a class name even though it does not have the words call method in front<br/><br/>if waLine cs '='.<br/><br/>split waLine at '=' into tail head.<br/><br/>shift head left deleting leading space.<br/><br/>split head at '=' into head tail.<br/><br/>endif.<br/><br/>sy-subrc = 0.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>try.<br/><br/>if head+0(1) = 'Y' or head+0(1) = 'Z' or head cs customerNameRange.<br/><br/>*           We have found a class best append it to our class table if we do not already have it.<br/><br/>read table iLocClasses into waSearchClass with key clsName = head.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>if head+0(3) = 'CX_'<br/><br/>or head+0(4) = 'ZCX_'<br/><br/>or head+0(4) = 'YCX_'<br/><br/>or head cs exceptionCustomerNameRange.<br/><br/>&nbsp;<br/><br/>waClass-exceptionClass = TRUE.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waClass-clsname = head.<br/><br/>&nbsp;<br/><br/>*             Check the package<br/><br/>if not soLocPackage[] is initial.<br/><br/>select single obj_name<br/><br/>from tadir<br/><br/>into waClass-clsName<br/><br/>where pgmid = 'R3TR'<br/><br/>and object = 'CLAS'<br/><br/>and obj_name = waClass-clsName<br/><br/>and devclass in soLocPackage[].<br/><br/>if sy-subrc = 0.<br/><br/>append waClass to iLocClasses.<br/><br/>endif.<br/><br/>else.<br/><br/>append waClass to iLocClasses.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                                "scanForClasses<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanForIncludePrograms... Search each program for include programs<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForIncludePrograms using value(programName)<br/><br/>value(recursiveIncludes)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocIncludes like dumiIncludes[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: waTokens type stokes.<br/><br/>data: waInclude type tInclude.<br/><br/>data: waIncludeExists type tInclude.<br/><br/>data: maxLines type i.<br/><br/>data: nextLine type i.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>&nbsp;<br/><br/>append INCLUDE to iKeywords.<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements keywords from iKeywords.<br/><br/>&nbsp;<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>maxLines = lines( iTokens ).<br/><br/>loop at iTokens where str = INCLUDE and type = 'I'.<br/><br/>nextLine = sy-tabix + 1.<br/><br/>if nextLine &lt;= maxLines.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>&nbsp;<br/><br/>*      Are we only to find customer includes?<br/><br/>if not customerOnly is initial.<br/><br/>try.<br/><br/>if waTokens-str+0(1) = 'Y' or waTokens-str+0(1) = 'Z' or waTokens-str cs customerNameRange<br/><br/>or waTokens-str+0(2) = 'MZ' or waTokens-str+0(2) = 'MY'.<br/><br/>&nbsp;<br/><br/>else.<br/><br/>continue.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waInclude-includeName = waTokens-str.<br/><br/>&nbsp;<br/><br/>*      Best find the program title text as well.<br/><br/>perform findProgramOrIncludeTitle using waInclude-includeName<br/><br/>waInclude-includeTitle.<br/><br/>&nbsp;<br/><br/>*      Don't append the include if we already have it listed<br/><br/>read table iLocIncludes into waIncludeExists with key includeName = waInclude-includeName.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>append waInclude to iLocIncludes.<br/><br/>&nbsp;<br/><br/>if not recursiveIncludes is initial.<br/><br/>*          Do a recursive search for other includes<br/><br/>perform scanForIncludePrograms using waInclude-includeName<br/><br/>recursiveIncludes<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocIncludes[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                        "scanForIncludePrograms<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanForIncludePrograms... Search each program for include programs<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForTransformations using value(programName)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocTransformation like iTransformations[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: waTokens type stokes.<br/><br/>data: waTransformation type tTransformation.<br/><br/>data: waTransformationExists type tTransformation.<br/><br/>data: maxLines type i.<br/><br/>data: nextLine type i.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>&nbsp;<br/><br/>append 'CALL' to iKeywords.<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements keywords from iKeywords.<br/><br/>&nbsp;<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>maxLines = lines( iTokens ).<br/><br/>loop at iTokens where str = TRANSFORMATION and type = 'I'.<br/><br/>nextLine = sy-tabix + 1.<br/><br/>if nextLine &lt;= maxLines.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>&nbsp;<br/><br/>*      Are we only to find customer transformations?<br/><br/>if not customerOnly is initial.<br/><br/>try.<br/><br/>if waTokens-str+0(1) = 'Y' or waTokens-str+0(1) = 'Z' or waTokens-str cs customerNameRange.<br/><br/>else.<br/><br/>continue.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTransformation-xsltName = waTokens-str.<br/><br/>&nbsp;<br/><br/>*      Don't append the include if we already have it listed<br/><br/>read table iLocTransformation into waTRansformationExists with key xsltName = waTransformation-xsltName.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>append waTransformation to iLocTransformation.<br/><br/>&nbsp;<br/><br/>perform scanForTransIncludes using waTransformation-xsltName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocTransformation[].<br/><br/>&nbsp;<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                        "scanForIncludePrograms<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanforTransIncludes...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanforTransIncludes using value(xsltName)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocTransformations like iTransformations[].<br/><br/>&nbsp;<br/><br/>data: iXsltSource type o2pageline_table.<br/><br/>data: waXsltAttributes type o2xsltattr.<br/><br/>data: waXSLTSource like line of iXSLTSource.<br/><br/>data: dummy type string.<br/><br/>data: waTransformationExists type tTransformation.<br/><br/>data: waTransformation type tTransformation.<br/><br/>&nbsp;<br/><br/>cl_o2_api_xsltdesc=&gt;load( exporting p_xslt_desc = xsltname<br/><br/>importing p_source = iXsltSource<br/><br/>p_attributes = waXsltAttributes<br/><br/>exceptions not_existing = 1<br/><br/>permission_failure = 2<br/><br/>error_occured = 3<br/><br/>version_not_found = 4 ).<br/><br/>&nbsp;<br/><br/>loop at iXsltSource into waXSLTSource.<br/><br/>if waXsltSource-line cs '&lt;xsl:include'.<br/><br/>split waXsltSource-line at '"' into dummy waXsltSource-line.<br/><br/>split waXsltSource-line at '"' into waXSLTSource dummy.<br/><br/>&nbsp;<br/><br/>*      Are we only to find customer transformations?<br/><br/>if not customerOnly is initial.<br/><br/>try.<br/><br/>if waXsltSource-line+0(1) = 'Y' or waXsltSource-line+0(1) = 'Z' or waXsltSource-line cs customerNameRange.<br/><br/>else.<br/><br/>continue.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*      Don't append the include if we already have it listed<br/><br/>read table iLocTransformations into waTransformationExists with key xsltName = waXsltSource-line.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>waTransformation-xsltName = waXSLTSource-line.<br/><br/>append waTransformation to iLocTransformations.<br/><br/>&nbsp;<br/><br/>*        Ok we have an include.  Are there any sub includes<br/><br/>perform scanforTransIncludes using waTransformation-xsltName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocTransformations[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* scanForFunctions... Search each program for function modules<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForFunctions using value(programName)<br/><br/>value(programLinkName)<br/><br/>value(recursiveIncludes)<br/><br/>value(recursiveFunctions)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocFunctions like iFunctions[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: waTokens type stokes.<br/><br/>data: waFunction type tFunction.<br/><br/>data: waFunctionComparison type tFunction.<br/><br/>data: maxLines type i.<br/><br/>data: nextLine type i.<br/><br/>data: castProgramName type program.<br/><br/>data: skipThisloop type abap_bool.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements.<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>maxLines = lines( iTokens ).<br/><br/>loop at iTokens where str = FUNCTION and type = 'I'.<br/><br/>&nbsp;<br/><br/>nextLine = sy-tabix + 1.<br/><br/>if nextLine &lt;= maxLines.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>&nbsp;<br/><br/>*      Are we only to find customer functions<br/><br/>skipThisLoop = FALSE.<br/><br/>if not customerOnly is initial.<br/><br/>try.<br/><br/>if waTokens-str+1(1) = 'Y' or waTokens-str+1(1) = 'Z' or waTokens-str cs customerNameRange.<br/><br/>else.<br/><br/>skipThisLoop = TRUE.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>cleanup.<br/><br/>skipThisLoop = TRUE.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if skipThisLoop = FALSE.<br/><br/>waFunction-functionName = waTokens-str.<br/><br/>replace all occurrences of '''' in waFunction-functionName with ' '.<br/><br/>condense waFunction-functionName.<br/><br/>&nbsp;<br/><br/>*        Don't add a function if we alread have it listed.<br/><br/>read table iLocFunctions with key functionName = waFunction-functionName into waFunctionComparison.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>*          Add in the link name if the function is linked to a program<br/><br/>waFunction-programLinkName = programLinkName.<br/><br/>&nbsp;<br/><br/>*          Don't download functions which are called through an RFC destination<br/><br/>nextline = sy-tabix + 2.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>if waTokens-str &lt;&gt; DESTINATION.<br/><br/>&nbsp;<br/><br/>*            Find the function group<br/><br/>select single area from v_fdir into wafunction-functionGroup where funcName = waFunction-functionName.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>*              Best find the function number as well.<br/><br/>perform retrieveFunctionDetail using waFunction-functionName<br/><br/>waFunction-progname<br/><br/>waFunction-includeNumber<br/><br/>waFunction-functionTitle.<br/><br/>&nbsp;<br/><br/>perform findMainFunctionInclude using waFunction-progname<br/><br/>waFunction-functionGroup<br/><br/>waFunction-includeNumber<br/><br/>waFunction-functionMainInclude.<br/><br/>&nbsp;<br/><br/>perform findFunctionTopInclude using waFunction-progname<br/><br/>wafunction-functionGroup<br/><br/>waFunction-topIncludeName.<br/><br/>&nbsp;<br/><br/>*              Find main message class<br/><br/>perform findMainMessageClass using waFunction-progname<br/><br/>waFunction-messageClass.<br/><br/>&nbsp;<br/><br/>append waFunction to iLocFunctions.<br/><br/>&nbsp;<br/><br/>*              Now lets search a little bit deeper and do a recursive search for other includes<br/><br/>if not recursiveIncludes is initial.<br/><br/>perform scanForIncludePrograms using waFunction-functionMainInclude<br/><br/>recursiveIncludes<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waFunction-iIncludes[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*              Now lets search a little bit deeper and do a recursive search for other functions<br/><br/>if not recursiveFunctions is initial.<br/><br/>perform scanForFunctions using waFunction-functionMainInclude<br/><br/>space<br/><br/>recursiveIncludes<br/><br/>recursiveFunctions<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocFunctions[].<br/><br/>endif.<br/><br/>clear waFunction.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>clear waFunction.<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                              "scanForFunctions<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  scanForFunctionIncludes... Find all user defined includes within the function group<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form scanForFunctionIncludes using poolName<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocIncludes like dumiIncludes[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: waTokens type stokes.<br/><br/>data: waInclude type tInclude.<br/><br/>data: waIncludeExists type tInclude.<br/><br/>data: maxLines type i.<br/><br/>data: nextLine type i.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = poolName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>&nbsp;<br/><br/>append INCLUDE to iKeywords.<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements keywords from iKeywords.<br/><br/>&nbsp;<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>maxLines = lines( iTokens ).<br/><br/>loop at iTokens where str = INCLUDE and type = 'I'.<br/><br/>nextLine = sy-tabix + 1.<br/><br/>if nextLine &lt;= maxLines.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>&nbsp;<br/><br/>if waTokens-str cp '*F++'.<br/><br/>*        Are we only to find customer includes?<br/><br/>if not customerOnly is initial.<br/><br/>try.<br/><br/>if waTokens-str+0(2) = 'LY' or waTokens-str+0(2) = 'LZ' or waTokens-str cs customerNameRange.<br/><br/>else.<br/><br/>continue.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waInclude-includeName = waTokens-str.<br/><br/>&nbsp;<br/><br/>*        Best find the program title text as well.<br/><br/>perform findProgramOrIncludeTitle using waInclude-includeName<br/><br/>waInclude-includeTitle.<br/><br/>&nbsp;<br/><br/>*        Don't append the include if we already have it listed<br/><br/>read table iLocIncludes into waIncludeExists with key includeName = waInclude-includeName.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>append waInclude to iLocIncludes.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                       "scanForFunctionIncludes<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  findProgramOrIncludeTitle...   Finds the title text of a program.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findProgramOrIncludeTitle using value(programName)<br/><br/>titleText.<br/><br/>&nbsp;<br/><br/>select single text<br/><br/>from trdirt<br/><br/>into titleText<br/><br/>where name = programName<br/><br/>and sprsl = pMLang.<br/><br/>endform.                                                                                     "findProgramOrIncludeTitle<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* retrievePrograms...    find programs and sub objects from SAP DB<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form retrievePrograms using iLocProgram like iPrograms[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>rangeProgram like soProgramName[]<br/><br/>rangeAuthor like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(alsoModifiedByauthor)<br/><br/>value(customerProgsOnly)<br/><br/>value(getMessages)<br/><br/>value(getTextElements)<br/><br/>value(getCustDictStructures)<br/><br/>value(getFunctions)<br/><br/>value(getIncludes)<br/><br/>value(getScreens)<br/><br/>value(getTransformations)<br/><br/>value(recursiveFuncSearch)<br/><br/>value(recursiveIncludeSearch)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: waRangeProgram like line of rangeProgram.<br/><br/>&nbsp;<br/><br/>if rangeProgram[] is initial.<br/><br/>*   We are finding all programs by an author<br/><br/>perform findAllProgramsForAuthor using iLocProgram[]<br/><br/>rangeProgram[]<br/><br/>rangeAuthor[]<br/><br/>custNameRange<br/><br/>alsoModifiedByAuthor<br/><br/>customerProgsOnly<br/><br/>soLocPackage[].<br/><br/>else.<br/><br/>read table rangeProgram index 1 into waRangeProgram.<br/><br/>if waRangeProgram-low cs ASTERIX.<br/><br/>perform findProgramsByWildcard using iLocProgram[]<br/><br/>rangeProgram[]<br/><br/>rangeAuthor[]<br/><br/>custNameRange<br/><br/>customerProgsOnly<br/><br/>soLocPackage[].<br/><br/>else.<br/><br/>perform checkProgramDoesExist using iLocProgram[]<br/><br/>rangeProgram[].<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Find extra items<br/><br/>perform scanForAdditionalProgStuff using iLocProgram[]<br/><br/>iLocFunctions[]<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getScreens<br/><br/>getCustDictStructures<br/><br/>getFunctions<br/><br/>getIncludes<br/><br/>getTransformations<br/><br/>customerProgsOnly<br/><br/>custNameRange<br/><br/>recursiveIncludeSearch<br/><br/>recursiveFuncSearch.<br/><br/>endform.                                                                               "retrievePrograms<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  scanForAdditionalProgStuff...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form scanForAdditionalProgStuff using iLocProgram like iPrograms[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>value(getTextElements)<br/><br/>value(getMessages)<br/><br/>value(getScreens)<br/><br/>value(getCustDictStructures)<br/><br/>value(getFunctions)<br/><br/>value(getIncludes)<br/><br/>value(getTransformations)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>value(recursiveIncludeSearch)<br/><br/>value(recursiveFuncSearch).<br/><br/>&nbsp;<br/><br/>data: waProgram type tProgram.<br/><br/>data: waInclude type tInclude.<br/><br/>data: myTabix type syTabix.<br/><br/>&nbsp;<br/><br/>* Best to find all the includes used in a program first<br/><br/>if not getIncludes is initial.<br/><br/>loop at iLocProgram into waProgram.<br/><br/>myTabix = sy-tabix.<br/><br/>perform scanForIncludePrograms using waProgram-progName<br/><br/>recursiveIncludeSearch<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waProgram-iIncludes[].<br/><br/>&nbsp;<br/><br/>modify iLocProgram from waProgram index myTabix.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Once we have a list of all the includes we need to loop round them an select all the other objects<br/><br/>loop at iLocProgram into waProgram.<br/><br/>myTabix = sy-tabix.<br/><br/>perform findProgramDetails using waProgram-progName<br/><br/>waProgram-subc<br/><br/>waProgram-programTitle<br/><br/>waProgram<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getScreens<br/><br/>getTransformations<br/><br/>getCustDictStructures<br/><br/>customerOnly<br/><br/>customerNameRange.<br/><br/>&nbsp;<br/><br/>*   Find any screens<br/><br/>if not getScreens is initial.<br/><br/>perform findProgramScreenFlow using waProgram.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>loop at waProgram-iIncludes into waInclude.<br/><br/>perform findProgramDetails using waInclude-includeName<br/><br/>'I'<br/><br/>waInclude-includeTitle<br/><br/>waProgram<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getScreens<br/><br/>getTransformations<br/><br/>getCustDictStructures<br/><br/>customerOnly<br/><br/>customerNameRange.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>modify iLocProgram from waProgram index myTabix.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>* Now we have all the program includes and details we need to find extra functions<br/><br/>if not getFunctions is initial.<br/><br/>loop at iLocProgram into waProgram.<br/><br/>*     Find any functions defined in the code<br/><br/>perform scanForFunctions using waProgram-progname<br/><br/>waProgram-progname<br/><br/>space<br/><br/>space<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocFunctions[].<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   We have a list of all the functions so lets go and find details and other function calls<br/><br/>perform scanForAdditionalFuncStuff using iLocFunctions[]<br/><br/>recursiveIncludeSearch<br/><br/>recursiveFuncSearch<br/><br/>getIncludes<br/><br/>getFunctions<br/><br/>getCustDictStructures<br/><br/>getMessages<br/><br/>getTransformations<br/><br/>customerOnly<br/><br/>customerNameRange.<br/><br/>endif.<br/><br/>endform.                                                                     "scanForAdditionalProgStuff<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findProgramDetails...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findProgramDetails using value(programName)<br/><br/>value(programType)<br/><br/>programTitle<br/><br/>waProgram type tProgram<br/><br/>value(getTextElements)<br/><br/>value(getMessages)<br/><br/>value(getScreens)<br/><br/>value(getTransformations)<br/><br/>value(getCustDictStructures)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange).<br/><br/>&nbsp;<br/><br/>perform findProgramOrIncludeTitle using programName<br/><br/>programTitle.<br/><br/>&nbsp;<br/><br/>if not getTextElements is initial.<br/><br/>*   Find the program texts from out of the database.<br/><br/>perform retrieveProgramTexts using waProgram-iSelectionTexts[]<br/><br/>waProgram-iTextElements[]<br/><br/>programName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Search for any GUI texts<br/><br/>if not getScreens is initial and ( programType = 'M' or programType = '1' ).<br/><br/>perform retrieveGUITitles using waProgram-iGUITitle[]<br/><br/>programName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Find individual messages<br/><br/>if not getMessages is initial.<br/><br/>if programType = 'M' or programType = '1'.<br/><br/>perform findMainMessageClass using programName<br/><br/>waProgram-messageClass.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform scanForMessages using programName<br/><br/>waProgram-messageClass<br/><br/>waProgram-iMessages[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Find any XSLT Transformations<br/><br/>if not getTransformations is initial.<br/><br/>perform scanForTransformations using programName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waProgram-iTransformations[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not getCustDictStructures is initial.<br/><br/>perform scanForTables using programName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waProgram-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using programName<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waProgram-iDictStruct[]<br/><br/>waProgram-iTableTypes[].<br/><br/>endif.<br/><br/>endform.                                                                             "findProgramDetails<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findAllProgramsForAuthor...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findAllProgramsForAuthor using iLocProgram like iPrograms[]<br/><br/>rangeProgram like soProgramName[]<br/><br/>rangeAuthor like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(alsoModifiedByauthor)<br/><br/>value(customerProgsOnly)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: altCustomerNameRange type string.<br/><br/>field-symbols: &lt;waProgram&gt; type tProgram.<br/><br/>data: genFlag type genFlag.<br/><br/>&nbsp;<br/><br/>* build up the customer name range used for select statements<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>* select by name and author<br/><br/>if not alsoModifiedByAuthor is initial.<br/><br/>*   Programs modified by author<br/><br/>*   Program to search for is an executable program<br/><br/>if customerProgsOnly is initial.<br/><br/>*     Select all programs<br/><br/>select a~progname<br/><br/>a~subc<br/><br/>appending corresponding fields of table ilocProgram<br/><br/>from reposrc as a<br/><br/>inner join tadir as b<br/><br/>on a~progname = b~obj_name<br/><br/>where a~progname in rangeProgram<br/><br/>and a~cnam in rangeAuthor<br/><br/>and ( a~subc = '1' or a~subc = 'M' or a~subc = 'S' )<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'PROG'<br/><br/>and b~devclass in soLocPackage.<br/><br/>&nbsp;<br/><br/>else.<br/><br/>*     Select only customer specific programs<br/><br/>select progname<br/><br/>subc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>from reposrc as a<br/><br/>inner join tadir as b<br/><br/>on a~progname = b~obj_name<br/><br/>where a~progname  in rangeProgram<br/><br/>and ( a~progname like altCustomerNameRange<br/><br/>or a~progname like 'Z%'<br/><br/>or a~progname like 'Y%'<br/><br/>or a~progname like 'SAPMZ%'<br/><br/>or a~progname like 'SAPMY%')<br/><br/>and a~cnam in rangeAuthor<br/><br/>and ( a~subc = '1' or a~subc = 'M' or a~subc = 'S' )<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'PROG'<br/><br/>and b~devclass in soLocPackage.<br/><br/>endif.<br/><br/>else.<br/><br/>&nbsp;<br/><br/>*   Programs created by author<br/><br/>if customerProgsOnly is initial.<br/><br/>*     Select all programs<br/><br/>select progname<br/><br/>subc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>from reposrc as a<br/><br/>inner join tadir as b<br/><br/>on a~progname = b~obj_name<br/><br/>where a~progname in rangeProgram<br/><br/>and ( a~subc = '1' or a~subc = 'M' or a~subc = 'S' )<br/><br/>and ( a~cnam in rangeAuthor or a~unam in rangeAuthor )<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'PROG'<br/><br/>and b~devclass in soLocPackage.<br/><br/>else.<br/><br/>*     Select only customer specific programs<br/><br/>select a~progname<br/><br/>a~subc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>from reposrc as a<br/><br/>inner join tadir as b<br/><br/>on a~progname = b~obj_name<br/><br/>where a~progname in rangeProgram<br/><br/>and ( a~progname like altCustomerNameRange<br/><br/>or a~progname like 'Z%'<br/><br/>or a~progname like 'Y%'<br/><br/>or a~progname like 'SAPMZ%'<br/><br/>or a~progname like 'SAPMY%')<br/><br/>and ( a~subc = '1' or a~subc = 'M' or a~subc = 'S' )<br/><br/>and ( a~cnam in rangeAuthor or a~unam in rangeAuthor )<br/><br/>and b~pgmid = 'R3TR'<br/><br/>and b~object = 'PROG'<br/><br/>and b~devclass in soLocPackage.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                       "findAllProgramsForAuthor<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findAllXSLTForAuthor...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findAllXSLTForAuthor using ilocTransformations  like iTransformations[]<br/><br/>rangexslt like soxsltname[]<br/><br/>rangeauthor like soauthor[]<br/><br/>value(custnamerange)<br/><br/>value(alsomodifiedbyauthor)<br/><br/>value(customerprogsonly)<br/><br/>value(solocpackage) like sopack[].<br/><br/>&nbsp;<br/><br/>data: altCustomerNameRange type string.<br/><br/>data: waTransformation like line of iTransformations.<br/><br/>field-symbols: &lt;waxslt&gt; type tTransformation.<br/><br/>data: genFlag type genflag.<br/><br/>&nbsp;<br/><br/>* build up the customer name range used for select statements<br/><br/>concatenate custNameRange '%' into altcustomernamerange.<br/><br/>&nbsp;<br/><br/>* select by name and author<br/><br/>if not alsomodifiedbyauthor is initial.<br/><br/>*   Programs modified by author<br/><br/>*   Program to search for is an executable program<br/><br/>if customerprogsonly is initial.<br/><br/>*     Select all XSLT programs<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    author    in rangeauthor<br/><br/>and    obj_name  in rangexslt<br/><br/>and    devclass  in solocpackage.<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>&nbsp;<br/><br/>else.<br/><br/>*     Select only customer specific programs<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    author    in rangeauthor<br/><br/>and    obj_name  in rangexslt<br/><br/>and    devclass  in solocpackage<br/><br/>and ( obj_name like altcustomernamerange<br/><br/>or obj_name like 'Z%'<br/><br/>or obj_name like 'Y%').<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>endif.<br/><br/>else.<br/><br/>*   Programs created by author<br/><br/>if customerprogsonly is initial.<br/><br/>*     Select all programs<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    author    in rangeauthor<br/><br/>and    obj_name  in rangexslt<br/><br/>and    devclass  in solocpackage.<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>else.<br/><br/>*     Select only customer specific programs<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    author    in rangeauthor<br/><br/>and    obj_name  in rangexslt<br/><br/>and    devclass  in solocpackage<br/><br/>and ( obj_name like altcustomernamerange<br/><br/>or obj_name like 'Z%'<br/><br/>or obj_name like 'Y%').<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                       "findAllXSLTForAuthor<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findXsltByWildcard...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findXsltByWildcard using iLocTransformations like iTransformations[]<br/><br/>value(rangexslt) like soxsltname[]<br/><br/>value(rangeauthor) like soauthor[]<br/><br/>value(custnamerange)<br/><br/>value(customerprogsonly)<br/><br/>value(solocpackage) like sopack[].<br/><br/>&nbsp;<br/><br/>data: altcustomernamerange type string.<br/><br/>data: waTransformation like line of ilocTransformations.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>data: genflag type genflag.<br/><br/>&nbsp;<br/><br/>if customerprogsonly is initial.<br/><br/>*   build up the customer name range used for select statements<br/><br/>if custnamerange &lt;&gt; '^'.<br/><br/>concatenate custnamerange '%' into altcustomernamerange.<br/><br/>&nbsp;<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    obj_name  in rangexslt<br/><br/>and    obj_name  like altcustomernamerange<br/><br/>and    author    in rangeauthor.<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>else.<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    obj_name  in rangexslt<br/><br/>and    author    in rangeauthor.<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>endif.<br/><br/>else.<br/><br/>*   Only customer xslt<br/><br/>if custnamerange &lt;&gt; '^'.<br/><br/>concatenate custnamerange '%' into altcustomernamerange.<br/><br/>&nbsp;<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    obj_name  in rangexslt<br/><br/>and    obj_name  like altcustomernamerange<br/><br/>and    ( obj_name like 'Z%' or<br/><br/>obj_name like 'Y%' ).<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>else.<br/><br/>select obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    obj_name  in rangexslt<br/><br/>and    ( obj_name like 'Z%' or<br/><br/>obj_name like 'Y%' ).<br/><br/>&nbsp;<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endselect.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                         "findxsltByWildcard<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  checkXsltDoesExist...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form checkXsltDoesExist using ilocTransformations like iTransformations[]<br/><br/>rangexslt like soxsltname[].<br/><br/>&nbsp;<br/><br/>data: waTransformation type tTransformation.<br/><br/>&nbsp;<br/><br/>*-- Make sure XSLT exists<br/><br/>select single obj_name<br/><br/>into   waTransformation-xsltname<br/><br/>from   tadir<br/><br/>where  pgmid     = 'R3TR'<br/><br/>and    object    = 'XSLT'<br/><br/>and    obj_name  in rangexslt.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>append waTransformation to iLocTransformations.<br/><br/>endif.<br/><br/>endform.                                                                          "checkxsltDoesExist<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  checkProgramDoesExist...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form checkProgramDoesExist using iLocProgram like iPrograms[]<br/><br/>rangeProgram like soProgramName[].<br/><br/>&nbsp;<br/><br/>*  Check to see if the program is an executable program<br/><br/>select progname<br/><br/>subc<br/><br/>into corresponding fields of table iLocProgram<br/><br/>from reposrc<br/><br/>where progname in rangeProgram<br/><br/>and ( subc = '1' or<br/><br/>subc = 'I' or<br/><br/>subc = 'M' or<br/><br/>subc = 'S' ).<br/><br/>endform.                                                                          "checkProgramDoesExist<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findProgramsByWildcard.. Search in the system for programs<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form checkAndAddTableType using waDictionary-tableName<br/><br/>iLocTableTypes like iTableTypes[].<br/><br/>&nbsp;<br/><br/>select *<br/><br/>into corresponding fields of table iLocTableTypes<br/><br/>from dd40l as a<br/><br/>inner join dd40t as t<br/><br/>on a~typename = t~typename<br/><br/>where a~typename = waDictionary-tableName<br/><br/>and t~ddlanguage eq sy-langu<br/><br/>and a~as4local = 'A'.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findProgramsByWildcard.. Search in the system for programs<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findProgramsByWildcard using iLocProgram like iPrograms[]<br/><br/>value(rangeProgram) like soProgramName[]<br/><br/>value(rangeAuthor) like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(customerProgsOnly)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: altCustomerNameRange type string.<br/><br/>field-symbols: &lt;waProgram&gt; type tProgram.<br/><br/>data: genFlag type genFlag.<br/><br/>&nbsp;<br/><br/>if customerProgsOnly is initial.<br/><br/>*   build up the customer name range used for select statements<br/><br/>if custNameRange &lt;&gt; '^'.<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>select progname<br/><br/>subc<br/><br/>from reposrc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>where progname  in rangeProgram<br/><br/>and progname like altCustomerNameRange<br/><br/>and ( subc = '1' or subc = 'M' or subc = 'S' )<br/><br/>and ( cnam in rangeAuthor or unam in rangeAuthor ).<br/><br/>else.<br/><br/>select progname<br/><br/>subc<br/><br/>from reposrc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>where progname  in rangeProgram<br/><br/>and ( subc = '1' or subc = 'M' or subc = 'S' )<br/><br/>and ( cnam in rangeAuthor or unam in rangeAuthor ).<br/><br/>endif.<br/><br/>else.<br/><br/>*   Only customer programs<br/><br/>if custNameRange &lt;&gt; '^'.<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>select progname<br/><br/>subc<br/><br/>from reposrc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>where progname  in rangeProgram<br/><br/>and ( progname like altCustomerNameRange<br/><br/>or progname like 'Z%'<br/><br/>or progname like 'Y%'<br/><br/>or progname like 'SAPMZ%'<br/><br/>or progname like 'SAPMY%')<br/><br/>and ( subc = '1' or subc = 'M' or subc = 'S' )<br/><br/>and ( cnam in rangeAuthor or unam in rangeAuthor ).<br/><br/>else.<br/><br/>select progname<br/><br/>subc<br/><br/>from reposrc<br/><br/>appending corresponding fields of table iLocProgram<br/><br/>where progname  in rangeProgram<br/><br/>and ( progname like 'Z%'<br/><br/>or progname like 'Y%'<br/><br/>or progname like 'SAPMZ%'<br/><br/>or progname like 'SAPMY%')<br/><br/>and ( subc = '1' or subc = 'M' or subc = 'S' )<br/><br/>and ( cnam in rangeAuthor or unam in rangeAuthor ).<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                         "findProgramsByWildcard<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveProgramTexts... Find the text elements and selection texts for a program<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form retrieveProgramTexts using iLocSelectionTexts like dumiTextTab[]<br/><br/>iLocTextElements like dumiTextTab[]<br/><br/>value(programName).<br/><br/>&nbsp;<br/><br/>data: iTextTable type standard table of tTextTable with header line.<br/><br/>data: waTexts type tTextTable.<br/><br/>data: castProgramName(50).<br/><br/>&nbsp;<br/><br/>move programName to castProgramName.<br/><br/>&nbsp;<br/><br/>read textpool castProgramName into iTextTable language pMLang.<br/><br/>delete iTextTable where key = 'R'.<br/><br/>&nbsp;<br/><br/>* Selection texts.<br/><br/>loop at iTextTable where id = 'S'.<br/><br/>move iTextTable-key to waTexts-key.<br/><br/>move iTextTable-entry to waTexts-entry.<br/><br/>append waTexts to iLocSelectiontexts.<br/><br/>clear waTexts.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>* Text elements.<br/><br/>delete iTextTable where key = 'S'.<br/><br/>loop at iTextTable where id = 'I'.<br/><br/>move iTextTable-key to waTexts-key.<br/><br/>move iTextTable-entry to waTexts-entry.<br/><br/>append waTexts to iLocTextElements.<br/><br/>endloop.<br/><br/>endform.                                                                           "retrieveProgramTexts<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  retrieveGUITitles...  Search for any GUI texts<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form retrieveGUITitles using iLocGUITitle like dumIGUITitle[]<br/><br/>value(programName).<br/><br/>&nbsp;<br/><br/>select obj_code<br/><br/>text<br/><br/>from d347t<br/><br/>appending corresponding fields of table iLocGUItitle<br/><br/>where progname = programName.<br/><br/>endform.                                                                              "retrieveGUITitles<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   findMainMessageClass... find the message class stated at the top of  program.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findMainMessageClass using value(programName)<br/><br/>messageClass.<br/><br/>&nbsp;<br/><br/>select single msgid<br/><br/>from trdire into messageClass<br/><br/>where report = programName.<br/><br/>endform.                                                                           "findMainMessageClass<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* retrieveClasses...    find classes and sub objects from SAP DB<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form retrieveClasses using iLocClasses like iClasses[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>rangeClass like soClassName[]<br/><br/>rangeAuthor like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(alsoModifiedByauthor)<br/><br/>value(customerProgsOnly)<br/><br/>value(getMessages)<br/><br/>value(getTextElements)<br/><br/>value(getCustDictStructures)<br/><br/>value(getFunctions)<br/><br/>value(getIncludes)<br/><br/>value(getTransformations)<br/><br/>value(recursiveFuncSearch)<br/><br/>value(recursiveIncludeSearch)<br/><br/>value(recursiveClassSearch)<br/><br/>value(language)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: waRangeClass like line of rangeClass.<br/><br/>data: waClass like line of iLocCLasses[].<br/><br/>&nbsp;<br/><br/>if rangeClass[] is initial.<br/><br/>*   We are finding all programs by an author<br/><br/>perform findAllClassesForAuthor using iLocClasses[]<br/><br/>rangeClass[]<br/><br/>rangeAuthor[]<br/><br/>custNameRange<br/><br/>alsoModifiedByAuthor<br/><br/>customerProgsOnly<br/><br/>language.<br/><br/>else.<br/><br/>read table rangeClass index 1 into waRangeClass.<br/><br/>if waRangeClass-low cs ASTERIX.<br/><br/>perform findClassesByWildcard using iLocClasses[]<br/><br/>rangeClass[]<br/><br/>rangeAuthor[]<br/><br/>custNameRange<br/><br/>customerProgsOnly<br/><br/>language.<br/><br/>else.<br/><br/>perform checkClassDoesExist using iLocClasses[]<br/><br/>rangeClass[].<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Check the package<br/><br/>if not soLocPackage[] is initial.<br/><br/>loop at iLocClasses into waClass.<br/><br/>select single obj_name<br/><br/>from tadir<br/><br/>into waClass-clsName<br/><br/>where pgmid = 'R3TR'<br/><br/>and object = 'CLAS'<br/><br/>and obj_name = waClass-clsName<br/><br/>and devclass in soLocPackage[].<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>delete iLocClasses.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Find extra items<br/><br/>if not iLocClasses[] is initial.<br/><br/>perform scanForAdditionalClassStuff using iLocClasses[]<br/><br/>iLocFunctions[]<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getCustDictStructures<br/><br/>getFunctions<br/><br/>getIncludes<br/><br/>getTransformations<br/><br/>customerProgsOnly<br/><br/>custNameRange<br/><br/>recursiveIncludeSearch<br/><br/>recursiveFuncSearch<br/><br/>recursiveClassSearch<br/><br/>soLocPackage[].<br/><br/>endif.<br/><br/>endform.                                                                                "retrieveClasses<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findAllClassesForAuthor...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findAllClassesForAuthor using iLocClass like iClasses[]<br/><br/>rangeClass like soClassName[]<br/><br/>rangeAuthor like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(alsoModifiedByauthor)<br/><br/>value(customerClassesOnly)<br/><br/>value(language).<br/><br/>&nbsp;<br/><br/>data: altCustomerNameRange type string.<br/><br/>&nbsp;<br/><br/>* build up the customer name range used for select statements<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>* select by name and author<br/><br/>if not alsoModifiedByAuthor is initial.<br/><br/>*   Classes modified by author<br/><br/>if customerClassesOnly is initial.<br/><br/>*     Select all classes<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>else.<br/><br/>*     Select only customer specific classes<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like altCustomerNameRange<br/><br/>or clsname like 'Z%'<br/><br/>or clsname like 'Y%')<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like altCustomerNameRange<br/><br/>or clsname like 'Z%'<br/><br/>or clsname like 'Y%')<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>*   Programs created by author<br/><br/>if customerClassesOnly is initial.<br/><br/>*     Select all classes<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and author in rangeAuthor<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and author in rangeAuthor<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>else.<br/><br/>*     Select only customer specific classes<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like altCustomerNameRange<br/><br/>or clsname like 'Z%'<br/><br/>or clsname like 'Y%')<br/><br/>and langu = language<br/><br/>and author in rangeAuthor<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like altCustomerNameRange<br/><br/>or clsname like 'Z%'<br/><br/>or clsname like 'Y%')<br/><br/>and langu = language<br/><br/>and author in rangeAuthor<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                        "findAllClassesForAuthor<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findClassesByWildcard...  Find classes using a wildcard search<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findClassesByWildcard using iLocClass like iClasses[]<br/><br/>rangeClass like soClassName[]<br/><br/>value(rangeAuthor) like soAuthor[]<br/><br/>value(custNameRange)<br/><br/>value(customerClassesOnly)<br/><br/>value(language).<br/><br/>&nbsp;<br/><br/>data: altCustomerNameRange type string.<br/><br/>&nbsp;<br/><br/>if customerClassesOnly is initial.<br/><br/>*   Searching for customer and SAP classes<br/><br/>if custNameRange &lt;&gt; '^'.<br/><br/>*     build up the customer name range used for select statements<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and clsname like custNameRange<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and clsname like custNameRange<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>else.<br/><br/>*     Searching using normal name ranges<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>*   searching for only customer classes<br/><br/>if custNameRange &lt;&gt; '^'.<br/><br/>*     build up the customer name range used for select statements<br/><br/>concatenate custNameRange '%' into altCustomerNameRange.<br/><br/>&nbsp;<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and clsname like custNameRange<br/><br/>and langu = language<br/><br/>and ( clsname like 'ZC%' or clsname like 'YC%' )<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and langu = language<br/><br/>and ( clsname like 'ZC%' or clsname like 'YC%' )<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>else.<br/><br/>*     Searching using normal name ranges<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like 'ZC%' or clsname like 'YC%' )<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select clsname descript msg_id<br/><br/>from vseoclass<br/><br/>appending corresponding fields of table ilocClass<br/><br/>where clsname in rangeClass<br/><br/>and ( clsname like 'ZC%' or clsname like 'YC%' )<br/><br/>and ( author in rangeAuthor or changedby in rangeAuthor )<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                          "findClassesByWildcard<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  checkClassDoesExist...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form checkClassDoesExist using iLocClass like iClasses[]<br/><br/>rangeClass like soClassName[].<br/><br/>&nbsp;<br/><br/>data: waClass type tClass.<br/><br/>&nbsp;<br/><br/>select single clsname descript msg_id<br/><br/>from vseoclass<br/><br/>into corresponding fields of waClass<br/><br/>where clsname in rangeClass<br/><br/>and version = '1'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select single clsname descript msg_id<br/><br/>from vseoclass<br/><br/>into corresponding fields of waClass<br/><br/>where clsname in rangeClass<br/><br/>and version = '0'<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not waClass-clsname is initial.<br/><br/>append waClass to iLocClass.<br/><br/>endif.<br/><br/>endform.                                                                            "checkClassDoesExist<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  scanForAdditionalClassStuff...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form scanForAdditionalClassStuff using iLocClasses like iClasses[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>value(getTextElements)<br/><br/>value(getMessages)<br/><br/>value(getCustDictStructures)<br/><br/>value(getFunctions)<br/><br/>value(getIncludes)<br/><br/>value(getTransformations)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>value(recursiveIncludeSearch)<br/><br/>value(recursiveFuncSearch)<br/><br/>value(recursiveClassSearch)<br/><br/>value(soLocPackage) like soPack[].<br/><br/>&nbsp;<br/><br/>data: waClass type tClass.<br/><br/>data: waMethod type tMethod.<br/><br/>data: myTabix type syTabix.<br/><br/>data: scanningForClasses type abap_bool value FALSE.<br/><br/>data: classNewLines type i value 0.<br/><br/>data: classCurrentLines type i value 0.<br/><br/>&nbsp;<br/><br/>loop at iLocClasses into waClass where scanned is initial.<br/><br/>*  Once we have a list of all the classes we need to loop round them an select all the other objects<br/><br/>myTabix = sy-tabix.<br/><br/>perform findClassDetails using waClass-clsName<br/><br/>waClass<br/><br/>iLocFunctions[]<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getFunctions<br/><br/>getCustDictStructures<br/><br/>getTransformations<br/><br/>customerOnly<br/><br/>customerNameRange.<br/><br/>&nbsp;<br/><br/>*   Set the scanned class so we do not check them again when running recursively.<br/><br/>waClass-scanned = 'X'.<br/><br/>modify iLocClasses from waClass index myTabix.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>* Now we have all the classes and details we need to find extra classes<br/><br/>if not recursiveClassSearch is initial.<br/><br/>classCurrentLines = lines( iLocClasses ).<br/><br/>loop at iLocClasses into waClass.<br/><br/>*     Don't try and find any other details for an exception class<br/><br/>if ( waClass-clsName ns 'ZCX_' or waClass-clsName ns 'CX_'  ).<br/><br/>*       Find any classes defined in the main class definition<br/><br/>perform scanForClasses using waClass-privateClassKey<br/><br/>waClass-clsname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocClasses[]<br/><br/>soLocPackage[].<br/><br/>&nbsp;<br/><br/>perform scanForClasses using waClass-publicClassKey<br/><br/>waClass-clsname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocClasses[]<br/><br/>soLocPackage[].<br/><br/>&nbsp;<br/><br/>perform scanForClasses using waClass-protectedClassKey<br/><br/>waClass-clsname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocClasses[]<br/><br/>soLocPackage[].<br/><br/>&nbsp;<br/><br/>loop at waClass-iMethods into waMethod.<br/><br/>*         Find any classes defined in any of the methods<br/><br/>perform scanForClasses using waMethod-methodKey<br/><br/>waClass-clsname<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocClasses[]<br/><br/>soLocPackage[].<br/><br/>endloop.<br/><br/>endif.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   We have a list of all the classes so lets go and find their details<br/><br/>classNewLines = lines( iLocClasses ).<br/><br/>if classNewLines &gt; classCurrentLines.<br/><br/>perform scanForAdditionalClassStuff using iLocClasses[]<br/><br/>iLocFunctions[]<br/><br/>getTextElements<br/><br/>getMessages<br/><br/>getCustDictStructures<br/><br/>getFunctions<br/><br/>getIncludes<br/><br/>getTransformations<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>recursiveIncludeSearch<br/><br/>recursiveFuncSearch<br/><br/>recursiveClassSearch<br/><br/>soLocPackage[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                   "scanForAdditionalClassStuff<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findClassDetails...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findClassDetails using value(className)<br/><br/>waClass type tClass<br/><br/>iLocFunctions like iFunctions[]<br/><br/>value(getTextElements)<br/><br/>value(getMessages)<br/><br/>value(getFunctions)<br/><br/>value(getCustDictStructures)<br/><br/>value(getTransformations)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange).<br/><br/>&nbsp;<br/><br/>data: iEmptySelectionTexts type standard table of tTextTable.<br/><br/>data: myTabix type syTabix.<br/><br/>data: waMethod type tMethod.<br/><br/>data: rnBlankAuthor like soAuthor[].<br/><br/>data: rnBlankPackage like soPack[].<br/><br/>data: waInterface type tInterface.<br/><br/>&nbsp;<br/><br/>* Build up the keys we will use for finding data<br/><br/>perform buildClassKeys using waClass.<br/><br/>&nbsp;<br/><br/>if waClass-descript is initial.<br/><br/>perform findClassDescription using className<br/><br/>waClass-descript.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Find the class attributes.<br/><br/>select single exposure msg_id state clsfinal r3release<br/><br/>from vseoclass<br/><br/>into (waClass-exposure, waClass-msg_id, waClass-state,<br/><br/>waClass-clsfinal, waClass-r3release)<br/><br/>where clsName = waClass-clsName.<br/><br/>&nbsp;<br/><br/>* Don't try and find any other details for an exception class<br/><br/>if ( waClass-clsName cs 'ZCX_' or waClass-clsName cs 'CX_'  ).<br/><br/>*   Exception texts<br/><br/>perform findExceptionTexts using waClass-publicClassKey<br/><br/>waClass-iConcepts[].<br/><br/>waClass-scanned = 'X'.<br/><br/>else.<br/><br/>if not getTextElements is initial.<br/><br/>*     Find the class texts from out of the database.<br/><br/>perform retrieveProgramTexts using iEmptySelectionTexts[]<br/><br/>waClass-iTextElements[]<br/><br/>waClass-textElementKey.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Find any declared dictionary structures<br/><br/>if not getCustDictStructures is initial.<br/><br/>perform scanForTables using waClass-privateClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForTables using waClass-publicClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForTables using waClass-protectedClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForTables using waClass-typesClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waClass-privateClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[]<br/><br/>waClass-iTableTypes[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waClass-publicClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[]<br/><br/>waClass-iTableTypes[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waClass-protectedClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[]<br/><br/>waClass-iTableTypes[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waClass-typesClassKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[]<br/><br/>waClass-iTableTypes[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Find all the interfaces used in this class<br/><br/>perform findClassInterfaces using className<br/><br/>waClass-iInterfaces[].<br/><br/>&nbsp;<br/><br/>*   Find all the methods defined by the interfaces<br/><br/>perform findInterfaceMethods using className<br/><br/>waClass-iInterfaces[]<br/><br/>waClass-iMethods[].<br/><br/>&nbsp;<br/><br/>*   Methods<br/><br/>*   Find all the methods for this class<br/><br/>perform findClassMethods using className<br/><br/>waClass-iMethods[].<br/><br/>&nbsp;<br/><br/>loop at waClass-iMethods[] into waMethod.<br/><br/>myTabix = sy-tabix.<br/><br/>*     Find individual messages<br/><br/>if not getMessages is initial.<br/><br/>perform scanForMessages using waMethod-methodKey<br/><br/>waClass-msg_id<br/><br/>waClass-iMessages[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not getCustDictStructures is initial.<br/><br/>*       Find any declared dictionary structures<br/><br/>perform scanForTables using waMethod-methodKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[].<br/><br/>&nbsp;<br/><br/>perform scanForLikeOrType using waMethod-methodKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iDictStruct[]<br/><br/>waClass-iTableTypes[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not getfunctions is initial.<br/><br/>perform scanForFunctions using waMethod-methodKey<br/><br/>waClass-clsName<br/><br/>space<br/><br/>space<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>iLocFunctions[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*     Find any XSLT Transformations<br/><br/>if not getTransformations is initial.<br/><br/>perform scanForTransformations using waMethod-methodKey<br/><br/>customerOnly<br/><br/>customerNameRange<br/><br/>waClass-iTransformations[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>modify waClass-iMethods from waMethod index myTabix.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   If the class has specified a message class but were unable to find any specific messages<br/><br/>*   then retrieve the whole message class.<br/><br/>if ( not waClass-msg_id is initial and waClass-iMessages[] is initial ).<br/><br/>perform retrieveMessageClass using waClass-iMessages[]<br/><br/>rnBlankAuthor[]<br/><br/>waClass-msg_id<br/><br/>pMLang<br/><br/>''<br/><br/>rnBlankPackage[].<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                               "findClassDetails<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* Find all interface methods used by the class<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findInterfaceMethods using value(className)<br/><br/>iLocInterfaces like dumiInterfaces[]<br/><br/>iLocMethods like dumiMethods[].<br/><br/>&nbsp;<br/><br/>types: begin of tIntMethod,<br/><br/>interfaceName like vseomethod-clsname,<br/><br/>cmpName like vseomethod-cmpname,<br/><br/>exposure like vseomethod-exposure,<br/><br/>end of tIntMethod.<br/><br/>data: waMethod type tMethod.<br/><br/>data: waInterface like line of iLocInterfaces.<br/><br/>data: iIntMethod type standard table of tIntMethod with header line.<br/><br/>&nbsp;<br/><br/>loop at iLocInterfaces into waInterface.<br/><br/>select a~clsname as interfaceName<br/><br/>a~cmpName<br/><br/>b~exposure<br/><br/>appending table iIntMethod<br/><br/>from seocompo as a<br/><br/>inner join seocompodf as b<br/><br/>on a~clsname = b~clsname<br/><br/>and a~cmpname = b~cmpname<br/><br/>where a~clsname = waInterface-interfaceName.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>loop at iIntMethod.<br/><br/>concatenate iIntMethod-interfaceName '~' iIntMethod-cmpname into waMethod-cmpname.<br/><br/>waMethod-exposure = iIntMethod-exposure.<br/><br/>&nbsp;<br/><br/>select single descript<br/><br/>from seocompotx<br/><br/>into waMethod-descript<br/><br/>where clsname = iIntMethod-interfaceName<br/><br/>and cmpname = iIntMethod-cmpname<br/><br/>and langu = pMLang.<br/><br/>&nbsp;<br/><br/>perform findMethodKey using className<br/><br/>waMethod-cmpName<br/><br/>waMethod-methodKey.<br/><br/>&nbsp;<br/><br/>if not waMethod-methodKey is initial.<br/><br/>append waMethod to iLocMethods.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>clear waMethod.<br/><br/>endloop.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*   Check to see if their are any interfaces being used by this class<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findClassInterfaces using value(className)<br/><br/>iLocInterfaces like dumiInterfaces[].<br/><br/>&nbsp;<br/><br/>data: isInheritance type abap_bool value abap_true.<br/><br/>data: iInterfaces type standard table of vseoimplem with header line.<br/><br/>data: waLocInterface like line of iLocInterfaces.<br/><br/>&nbsp;<br/><br/>select * from vseoimplem<br/><br/>into table iInterfaces<br/><br/>where clsname = className.<br/><br/>&nbsp;<br/><br/>while isInheritance = ABAP_TRUE.<br/><br/>perform findClassParent using className<br/><br/>className.<br/><br/>&nbsp;<br/><br/>if className is initial.<br/><br/>isInheritance = ABAP_FALSE.<br/><br/>else.<br/><br/>select * from vseoimplem<br/><br/>appending table iInterfaces<br/><br/>where clsname = className.<br/><br/>endif.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>if not iInterfaces[] is initial.<br/><br/>sort iInterfaces ascending by refclsname.<br/><br/>delete adjacent duplicates from iInterfaces comparing refclsname.<br/><br/>&nbsp;<br/><br/>loop at iInterfaces.<br/><br/>waLocInterface-interfaceName = iInterfaces-refclsname.<br/><br/>append wALocInterface to iLocInterfaces.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  Find the parent of the current class<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findClassParent using value(className)<br/><br/>parentClassName.<br/><br/>&nbsp;<br/><br/>data: waInheritance type seor_inheritance_r.<br/><br/>data: clskey type seoclskey.<br/><br/>&nbsp;<br/><br/>clskey-clsname = className.<br/><br/>&nbsp;<br/><br/>call function 'SEO_INHERITANC_READ'<br/><br/>exporting<br/><br/>clskey                   = clskey<br/><br/>version                  = seoc_version_active<br/><br/>importing<br/><br/>inheritance              = waInheritance<br/><br/>*       redefinitions            = redefinitions<br/><br/>exceptions<br/><br/>class_not_existing       = 1.<br/><br/>&nbsp;<br/><br/>parentClassName = waInheritance-refclsname.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  buildClassKeys...   Finds the title text of a class.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form buildClassKeys using waClass type tClass.<br/><br/>&nbsp;<br/><br/>data: classNameLength type i.<br/><br/>data: loops type i.<br/><br/>&nbsp;<br/><br/>classNameLength = strlen( waClass-clsName ).<br/><br/>&nbsp;<br/><br/>cl_oo_classname_service=&gt;get_pubsec_name( exporting clsname = waClass-clsName<br/><br/>receiving result = waClass-publicClassKey ).<br/><br/>&nbsp;<br/><br/>cl_oo_classname_service=&gt;get_prisec_name( exporting clsname = waClass-clsName<br/><br/>receiving result = waClass-privateClassKey ).<br/><br/>&nbsp;<br/><br/>cl_oo_classname_service=&gt;get_prosec_name( exporting clsname = waClass-clsName<br/><br/>receiving result = waClass-protectedClassKey ).<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>* Text element key - length of text element key has to be 32 characters.<br/><br/>loops = 30 - classNameLength.<br/><br/>waClass-textElementKey = waClass-clsName.<br/><br/>do loops times.<br/><br/>concatenate waClass-textElementKey '=' into waClass-textElementKey.<br/><br/>enddo.<br/><br/>* Save this for later.<br/><br/>concatenate waClass-textElementKey 'CP' into waClass-textElementKey.<br/><br/>&nbsp;<br/><br/>* Types Class key - length of class name has to be 32 characters.<br/><br/>loops = 30 - classNameLength.<br/><br/>waClass-typesClassKey = waClass-clsName.<br/><br/>do loops times.<br/><br/>concatenate waClass-typesClassKey '=' into waClass-typesClassKey.<br/><br/>enddo.<br/><br/>* Save this for later<br/><br/>concatenate waClass-typesClassKey 'CT' into waClass-typesClassKey.<br/><br/>endform.                                                                                 "buildClassKeys<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findClassDescription...   Finds the title text of a class.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findClassDescription using value(className)<br/><br/>titleText.<br/><br/>&nbsp;<br/><br/>select single descript<br/><br/>from vseoclass<br/><br/>into titleText<br/><br/>where clsname = className<br/><br/>and langu = pMLang.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select single descript<br/><br/>from vseoclass<br/><br/>into titleText<br/><br/>where clsname = className.<br/><br/>endif.<br/><br/>endform.                                                                           "findClassDescription<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findExceptionTexts...   Fiond the texts of an exception class.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findExceptionTexts using publicClassKey<br/><br/>iConcepts like dumiConcepts[].<br/><br/>&nbsp;<br/><br/>data: castClassName type program.<br/><br/>data: iTempLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: waTokens type stokes.<br/><br/>data: waCurrentToken type stokes.<br/><br/>data: waConcept like line of iConcepts.<br/><br/>data: tokenLength type i.<br/><br/>data: myRow type i.<br/><br/>&nbsp;<br/><br/>castClassName = publicClassKey.<br/><br/>read report castClassName into iTempLines.<br/><br/>&nbsp;<br/><br/>append 'CONSTANTS' to iKeywords.<br/><br/>scan abap-source iTempLines tokens into iTokens statements into iStatements keywords from iKeywords.<br/><br/>&nbsp;<br/><br/>delete iTokens where str = 'CONSTANTS'.<br/><br/>delete iTokens where str = 'VALUE'.<br/><br/>delete iTokens where str = 'TYPE'.<br/><br/>&nbsp;<br/><br/>loop at iTokens into waTokens where str = 'SOTR_CONC'.<br/><br/>*   The loop before holds the constant name<br/><br/>myRow = sy-tabix - 1.<br/><br/>read table iTokens index myRow into waCurrentToken.<br/><br/>waConcept-constName = waCurrentToken-str.<br/><br/>&nbsp;<br/><br/>*   The loop after holds the constant name<br/><br/>myRow = myRow + 2.<br/><br/>read table iTokens index myRow into waCurrentToken.<br/><br/>tokenLength = strLen( waCurrentToken-str ).<br/><br/>if tokenLength = 34.<br/><br/>*     Most likely an exception text.<br/><br/>replace all occurrences of '''' in waCurrentToken-str with ' ' .<br/><br/>waConcept-concept = waCurrentToken-str.<br/><br/>append waConcept to iConcepts.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findClassMethods...   Finds the methods of a class.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findClassMethods using value(className)<br/><br/>iLocMethods like dumiMethods[].<br/><br/>&nbsp;<br/><br/>data: iMethods type standard table of tMethod with header line.<br/><br/>data: iRedefinedMethods type standard table of seoredef with header line.<br/><br/>data: originalClassName type seoclsname.<br/><br/>data: waMethod like line of iMethods.<br/><br/>&nbsp;<br/><br/>select cmpName descript exposure<br/><br/>from vseomethod<br/><br/>into corresponding fields of table iMethods<br/><br/>where clsname = className<br/><br/>and version = '1'<br/><br/>and langu = pMLang<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>select cmpName descript exposure<br/><br/>from vseomethod<br/><br/>into corresponding fields of table iMethods<br/><br/>where clsname = className<br/><br/>and version = '0'<br/><br/>and langu = pMLang<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>select *<br/><br/>from seoredef<br/><br/>into table iRedefinedMethods<br/><br/>where clsname = className<br/><br/>and version = '1'.<br/><br/>&nbsp;<br/><br/>*  For Each method we must find the original class the method was created in<br/><br/>loop at iRedefinedMethods.<br/><br/>perform findRedefinitionClass using iRedefinedMethods-refclsname<br/><br/>iRedefinedMethods-mtdname<br/><br/>originalClassName.<br/><br/>&nbsp;<br/><br/>waMethod-cmpname = iRedefinedMethods-mtdname.<br/><br/>&nbsp;<br/><br/>select single descript exposure<br/><br/>from vseomethod<br/><br/>into corresponding fields of  waMethod<br/><br/>where clsname = originalClassName<br/><br/>and cmpname = iRedefinedMethods-mtdname<br/><br/>and version = '1'<br/><br/>and langu = pMLang<br/><br/>and ( state = '0' or state = '1' ).<br/><br/>&nbsp;<br/><br/>concatenate `Redefined: ` waMethod-descript into waMethod-descript.<br/><br/>append waMethod to iMethods.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>* Find the method key so that we can acces the source code later<br/><br/>loop at iMethods.<br/><br/>perform findMethodKey using className<br/><br/>iMethods-cmpName<br/><br/>iMethods-methodKey.<br/><br/>append iMethods to iLocMethods.<br/><br/>endloop.<br/><br/>endform.                                                                               "findClassMethods<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* findRedefinitionClass... find the original class the method was redefined from<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findRedefinitionClass using value(redefinedClassName) type seoclsname<br/><br/>value(methodName) type seocpdname<br/><br/>originalClassName type seoclsname.<br/><br/>&nbsp;<br/><br/>data: waRedef type seoredef.<br/><br/>&nbsp;<br/><br/>select single *<br/><br/>from seoredef<br/><br/>into waRedef<br/><br/>where refclsName = redefinedClassName<br/><br/>and mtdname = methodName.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>*   There is a higher class still.<br/><br/>originalClassName = waRedef-refclsName.<br/><br/>perform findRedefinitionClassRecur using waRedef-refclsname<br/><br/>waRedef-mtdname<br/><br/>originalClassName.<br/><br/>else.<br/><br/>*   We are at the higher class.<br/><br/>originalClassName = waRedef-refclsName.<br/><br/>endif.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* findRedefinitionClassRecur... Recursively find the original class the method was redefined from<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findRedefinitionClassRecur using value(redefinedClassName) type seoclsname<br/><br/>value(methodName) type seocpdname<br/><br/>originalClassName type seoclsname.<br/><br/>&nbsp;<br/><br/>data: waRedef type seoredef.<br/><br/>&nbsp;<br/><br/>select single *<br/><br/>from seoredef<br/><br/>into waRedef<br/><br/>where clsName = redefinedClassName<br/><br/>and mtdname = methodName.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>*   There is a higher class still.<br/><br/>originalClassName = waRedef-refclsName.<br/><br/>perform findRedefinitionClassRecur using waRedef-refclsname<br/><br/>waRedef-mtdname<br/><br/>originalClassName.<br/><br/>endif.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* findMethodKey... find the unique key which identifes this method<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findMethodKey using value(className)<br/><br/>value(methodName)<br/><br/>methodKey.<br/><br/>&nbsp;<br/><br/>data: methodID type seocpdkey.<br/><br/>data: locMethodKey type program.<br/><br/>&nbsp;<br/><br/>methodID-clsname = className.<br/><br/>methodID-cpdName = methodName.<br/><br/>&nbsp;<br/><br/>cl_oo_classname_service=&gt;get_method_include( exporting mtdkey = methodID<br/><br/>receiving result = locMethodKey<br/><br/>exceptions class_not_existing = 1<br/><br/>method_not_existing = 2 ).<br/><br/>&nbsp;<br/><br/>methodKey = locMethodKey.<br/><br/>endform.                                                                                  "findMethodKey<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* scanForMessages... Search each program for messages<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form scanForMessages using value(programName)<br/><br/>value(mainMessageClass)<br/><br/>iLocMessages like iMessages[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: waMessage type tMessage.<br/><br/>data: waMessageComparison type tMessage.<br/><br/>data: watokens type stokes.<br/><br/>data: nextLine type i.<br/><br/>data: stringLength type i value 0.<br/><br/>data: workingOnMessage type abap_bool value FALSE.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>&nbsp;<br/><br/>append MESSAGE to iKeywords.<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements keywords from iKeywords.<br/><br/>&nbsp;<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>loop at iTokens.<br/><br/>if iTokens-str = MESSAGE.<br/><br/>workingOnMessage = TRUE.<br/><br/>continue.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if workingOnMessage = TRUE.<br/><br/>stringLength = strlen( iTokens-str ).<br/><br/>&nbsp;<br/><br/>*     Message declaration 1<br/><br/>if stringLength = 4 and iTokens-str+0(1) ca sy-abcde.<br/><br/>waMessage-msgnr = iTokens-str+1(3).<br/><br/>waMessage-arbgb = mainMessageClass.<br/><br/>else.<br/><br/>if iTokens-str cs '''' or iTokens-str cs '`'.<br/><br/>*         Message declaration 2<br/><br/>translate iTokens-str using ''' '.<br/><br/>translate iTokens-str using '` '.<br/><br/>condense iTokens-str.<br/><br/>shift iTokens-str left deleting leading space.<br/><br/>waMessage-text = iTokens-str.<br/><br/>waMessage-arbgb = 'Hard coded'.<br/><br/>else.<br/><br/>if iTokens-str = 'ID'.<br/><br/>*           Message declaration 3<br/><br/>nextLine = sy-tabix + 1.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>translate waTokens-str using ''' '.<br/><br/>condense iTokens-str.<br/><br/>shift waTokens-str left deleting leading space.<br/><br/>if not waTokens-str = 'SY-MSGID'.<br/><br/>waMessage-arbgb = waTokens-str.<br/><br/>&nbsp;<br/><br/>nextLine = nextLine + 4.<br/><br/>read table iTokens index nextLine into waTokens.<br/><br/>translate waTokens-str using ''' '.<br/><br/>condense waTokens-str.<br/><br/>shift waTokens-str left deleting leading space.<br/><br/>waMessage-msgnr = waTokens-str.<br/><br/>else.<br/><br/>workingOnMessage = FALSE.<br/><br/>endif.<br/><br/>else.<br/><br/>if stringLength &gt;= 5 and iTokens-str+4(1) = '('.<br/><br/>*              Message declaration 4<br/><br/>waMessage-msgnr = iTokens-str+1(3).<br/><br/>shift iTokens-str left up to '('.<br/><br/>replace '(' into iTokens-str with space.<br/><br/>replace ')' into iTokens-str with space.<br/><br/>condense iTokens-str.<br/><br/>waMessage-arbgb = iTokens-str.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*      find the message text<br/><br/>if not waMessage-arbgb is initial and not waMessage-msgnr is initial and waMessage-text is initial.<br/><br/>select single text<br/><br/>from t100<br/><br/>into waMessage-text<br/><br/>where sprsl = pMLang<br/><br/>and arbgb = waMessage-arbgb<br/><br/>and msgnr = waMessage-msgnr.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*      Append the message<br/><br/>if not waMessage is initial.<br/><br/>if not waMessage-text is initial.<br/><br/>*          Don't append the message if we already have it listed<br/><br/>read table iLocMessages with key arbgb = waMessage-arbgb<br/><br/>msgnr = waMessage-msgnr<br/><br/>into waMessageComparison.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>append waMessage to iLocMessages.<br/><br/>endif.<br/><br/>endif.<br/><br/>clear waMessage.<br/><br/>workingOnMessage = FALSE.<br/><br/>endif.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                 "scanForMessages<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* scanForTables... Search each program for dictionary tables<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form scanForTables using value(programName)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocDictionary like iDictionary[].<br/><br/>&nbsp;<br/><br/>data: iIncludeLines type standard table of string with header line.<br/><br/>data: iTokens type standard table of stokes with header line.<br/><br/>data: iStatements type standard table of sstmnt with header line.<br/><br/>data: iKeywords type standard table of text20 with header line.<br/><br/>data: waDictionary type tDictTable.<br/><br/>data: waDictionaryComparison type tDictTable.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iIncludeLines.<br/><br/>&nbsp;<br/><br/>append TABLES to iKeywords.<br/><br/>&nbsp;<br/><br/>scan abap-source iIncludeLines tokens into iTokens with includes statements into iStatements keywords from iKeywords.<br/><br/>clear iIncludeLines[].<br/><br/>&nbsp;<br/><br/>sort iTokens ascending by str.<br/><br/>delete iTokens where str = TABLES.<br/><br/>&nbsp;<br/><br/>loop at iTokens.<br/><br/>if not CustomerOnly is initial.<br/><br/>try.<br/><br/>case iTokens-str+0(1).<br/><br/>when 'Y' or 'Z' or customerNameRange.<br/><br/>when others.<br/><br/>continue.<br/><br/>endcase.<br/><br/>*        if ( iTokens-str+0(1) &lt;&gt; 'Y' or iTokens-str+0(1) &lt;&gt; 'Z' or iTokens-str ns customerNameRange ).<br/><br/>*          continue.<br/><br/>*        endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waDictionary-tablename = iTokens-str.<br/><br/>*   Don't append the object if we already have it listed<br/><br/>read table iLocDictionary into waDictionaryComparison with key tablename = waDictionary-tableName.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>perform findTableDescription using waDictionary-tablename<br/><br/>waDictionary-tableTitle.<br/><br/>&nbsp;<br/><br/>perform findTableDefinition using waDictionary-tableName<br/><br/>waDictionary-iStructure[].<br/><br/>&nbsp;<br/><br/>append waDictionary to iLocDictionary.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                 "scanForTables<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findProgramScreenFlow...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findProgramScreenFlow using waProgram type tProgram.<br/><br/>&nbsp;<br/><br/>data: iFlow type standard table of tScreenFlow with header line.<br/><br/>&nbsp;<br/><br/>call function 'DYNPRO_PROCESSINGLOGIC'<br/><br/>exporting<br/><br/>rep_name  = waProgram-progname<br/><br/>tables<br/><br/>scr_logic = iFlow.<br/><br/>&nbsp;<br/><br/>sort iFlow ascending by screen.<br/><br/>delete adjacent duplicates from iFlow comparing screen.<br/><br/>if waProgram-subc &lt;&gt; 'M'.<br/><br/>delete iFlow where screen &gt;= '1000' and screen &lt;= '1099'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>loop at iFlow.<br/><br/>append iFlow to waProgram-iScreenFlow.<br/><br/>endloop.<br/><br/>endform.                                                                          "findProgramScreenFlow<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  findMainFunctionInclude...  Find the main include that contains the source code<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findMainFunctionInclude using value(programName)<br/><br/>value(functionGroup)<br/><br/>value(functionIncludeNo)<br/><br/>functionIncludeName.<br/><br/>&nbsp;<br/><br/>data: namespace TYPE string,<br/><br/>iResults type match_result_tab,<br/><br/>waResult type match_result,<br/><br/>startingPosition type i.<br/><br/>&nbsp;<br/><br/>find all occurrences of '/' in functionGroup results iResults.<br/><br/>if sy-subrc = 0.<br/><br/>read table iResults index sy-tfill into waResult.<br/><br/>startingPosition = waResult-offset + 1.<br/><br/>namespace = functiongroup+0(startingPosition).<br/><br/>functionGroup = functionGroup+startingPosition.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate namespace 'L' functionGroup 'U' functionIncludeNo into functionIncludeName.<br/><br/>endform.                                                                                       "findMainFunctionInclude<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  findFunctionTopInclude...  Find the top include for the function group<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form findFunctionTopInclude using value(programName)<br/><br/>value(functionGroup)<br/><br/>topIncludeName.<br/><br/>&nbsp;<br/><br/>data: namespace TYPE string,<br/><br/>iResults type match_result_tab,<br/><br/>waResult type match_result,<br/><br/>startingPosition type i.<br/><br/>&nbsp;<br/><br/>find all occurrences of '/' in functionGroup results iResults.<br/><br/>if sy-subrc = 0.<br/><br/>read table iResults index sy-tfill into waResult.<br/><br/>startingPosition = waResult-offset + 1.<br/><br/>namespace = functiongroup+0(startingPosition).<br/><br/>functionGroup = functionGroup+startingPosition.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate namespace 'L' functionGroup 'TOP' into topIncludeName.<br/><br/>endform.                                                                                        "findFunctionTopInclude<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  findFunctionScreenFlow...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findFunctionScreenFlow using waFunction type tFunction.<br/><br/>&nbsp;<br/><br/>data: iFlow type standard table of tScreenFlow with header line.<br/><br/>&nbsp;<br/><br/>call function 'DYNPRO_PROCESSINGLOGIC'<br/><br/>exporting<br/><br/>REP_NAME  = waFunction-progName<br/><br/>tables<br/><br/>SCR_LOGIC = iFlow.<br/><br/>&nbsp;<br/><br/>sort iFlow ascending by screen.<br/><br/>delete adjacent duplicates from iFlow comparing screen.<br/><br/>&nbsp;<br/><br/>loop at iFlow.<br/><br/>append iFlow to waFunction-iScreenFlow.<br/><br/>endloop.<br/><br/>endform.                                                                          "findFunctionScreenFlow<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* scanForLikeOrType... Look for any dictionary objects referenced by a like or type statement<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form scanForLikeOrType using value(programName)<br/><br/>value(customerOnly)<br/><br/>value(customerNameRange)<br/><br/>iLocDictionary like iDictionary[]<br/><br/>iLocTableTypes like iTableTypes[].<br/><br/>&nbsp;<br/><br/>data iLines type standard table of string with header line.<br/><br/>data: head type string.<br/><br/>data: tail type string.<br/><br/>data: junk type string.<br/><br/>data: lineType type string.<br/><br/>data: lineLength type i value 0.<br/><br/>data: endOfLine type abap_bool value TRUE.<br/><br/>data: waDictionary type tDictTable.<br/><br/>data: waDictionaryComparison type tDictTable.<br/><br/>data: waLine type string.<br/><br/>data: castProgramName type program.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>* Read the program code from the textpool.<br/><br/>castProgramName = programName.<br/><br/>read report castProgramName into iLines.<br/><br/>&nbsp;<br/><br/>loop at iLines into waLine.<br/><br/>*   Find custom tables.<br/><br/>lineLength = strLen( waLine ).<br/><br/>if lineLength &gt; 0.<br/><br/>if waLine(1) = ASTERIX.<br/><br/>continue.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>translate waLine to upper case.<br/><br/>&nbsp;<br/><br/>*     Determine the lineType.<br/><br/>if endOfLine = TRUE.<br/><br/>shift waLine up to LIKE.<br/><br/>if sy-subrc = 0.<br/><br/>lineType = LIKE.<br/><br/>else.<br/><br/>shift waLine up to TYPE.<br/><br/>if sy-subrc = 0.<br/><br/>find 'BEGIN OF' in waLine.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>find 'END OF' in waLine.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>find 'VALUE' in waLine.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>lineType = TYPE.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>shift waLine up to INCLUDE.<br/><br/>if sy-subrc = 0.<br/><br/>split waLine at space into junk iLines.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>shift waLine up to STRUCTURE.<br/><br/>if sy-subrc = 0.<br/><br/>lineType = STRUCTURE.<br/><br/>else.<br/><br/>continue.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>lineType = COMMA.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>case linetype.<br/><br/>when LIKE or TYPE or STRUCTURE.<br/><br/>*         Work on the appropriate lineType<br/><br/>shift waLine up to space.<br/><br/>shift waLine left deleting leading space.<br/><br/>if waLine cs TABLE.<br/><br/>split waLine at TABLE into head tail.<br/><br/>split tail at 'OF' into head tail.<br/><br/>waLine = tail.<br/><br/>shift waLine left deleting leading space.<br/><br/>replace all occurrences of 'WITH HEADER LINE' in waLine with ''.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*         Are we only to download SAP dictionary structures.<br/><br/>if not CustomerOnly is initial.<br/><br/>try.<br/><br/>if waLine+0(1) = 'Y' or waLine+0(1) = 'Z' or waLine cs customerNameRange.<br/><br/>else.<br/><br/>lineType = ''.<br/><br/>continue.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if waLine cs COMMA.<br/><br/>split waLine at COMMA into head tail.<br/><br/>if waLine cs DASH.<br/><br/>split head at DASH into head tail.<br/><br/>endif.<br/><br/>if waLine cs OCCURS.<br/><br/>split waLine at SPACE into head tail.<br/><br/>endif.<br/><br/>else.<br/><br/>if waLine cs PERIOD.<br/><br/>split waLine at PERIOD into head tail.<br/><br/>if waLine cs DASH.<br/><br/>split head at DASH into head tail.<br/><br/>endif.<br/><br/>if waLine cs OCCURS.<br/><br/>split waLine at SPACE into head tail.<br/><br/>endif.<br/><br/>else.<br/><br/>split waLine at SPACE into head tail.<br/><br/>if waLine cs DASH.<br/><br/>split head at DASH into head tail.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not head is initial.<br/><br/>waDictionary-tableName = head.<br/><br/>*           Don't append the object if we already have it listed<br/><br/>read table iLocDictionary into waDictionaryComparison<br/><br/>with key tablename = waDictionary-tableName.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>perform findTableDescription using waDictionary-tablename<br/><br/>waDictionary-tableTitle.<br/><br/>&nbsp;<br/><br/>perform findTableDefinition using waDictionary-tableName<br/><br/>waDictionary-iStructure[].<br/><br/>&nbsp;<br/><br/>*             Only append if the item is a table and not a structure or data element<br/><br/>if waDictionary-iStructure[] is initial.<br/><br/>*               Not a table, but is it a table type?<br/><br/>perform checkandAddTableType using waDictionary-tableName<br/><br/>iLocTableTypes[].<br/><br/>else.<br/><br/>*               It is a table<br/><br/>append waDictionary to iLocDictionary.<br/><br/>endif.<br/><br/>endif.<br/><br/>clear waDictionary.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>lineType = ''.<br/><br/>endcase.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                              "scanForLikeOrType<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  displayStatus...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form displayStatus using value(message)<br/><br/>value(delay).<br/><br/>&nbsp;<br/><br/>call function 'SAPGUI_PROGRESS_INDICATOR'<br/><br/>exporting<br/><br/>percentage = 0<br/><br/>text       = message<br/><br/>exceptions<br/><br/>others     = 1.<br/><br/>&nbsp;<br/><br/>if delay &gt; 0.<br/><br/>wait up to delay seconds.<br/><br/>endif.<br/><br/>endform.                                                                                  "displayStatus<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  removeLeadingZeros...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form removeLeadingZeros changing myValue.<br/><br/>&nbsp;<br/><br/>call function 'CONVERSION_EXIT_ALPHA_OUTPUT'<br/><br/>exporting<br/><br/>INPUT   = myValue<br/><br/>importing<br/><br/>OUTPUT  = myValue<br/><br/>exceptions<br/><br/>others  = 1.<br/><br/>endform.                                                                             "removeLeadingZeros<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* determineFrontendOPSystem.... Determine the frontend operating system type.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form determineFrontendOPSystem using separator<br/><br/>operatingSystem.<br/><br/>&nbsp;<br/><br/>data: platformID type i value 0.<br/><br/>&nbsp;<br/><br/>create object objFile.<br/><br/>&nbsp;<br/><br/>call method objFile-&gt;get_platform receiving platform = platformID<br/><br/>exceptions cntl_error = 1<br/><br/>error_no_gui = 2<br/><br/>not_supported_by_gui = 3.<br/><br/>case platformID.<br/><br/>when objFile-&gt;PLATFORM_WINDOWS95<br/><br/>or objFile-&gt;PLATFORM_WINDOWS98<br/><br/>or objFile-&gt;PLATFORM_NT351<br/><br/>or objFile-&gt;PLATFORM_NT40<br/><br/>or objFile-&gt;PLATFORM_NT50<br/><br/>or objFile-&gt;PLATFORM_MAC<br/><br/>or objFile-&gt;PLATFORM_OS2<br/><br/>or 14.      "XP<br/><br/>separator = ''.<br/><br/>operatingSystem = NON_UNIX.<br/><br/>when others.<br/><br/>separator = '/'.<br/><br/>operatingSystem = UNIX.<br/><br/>endcase.<br/><br/>endform.                                                                      "determineFrontendOpSystem<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* determineServerOPSystem.... Determine the server operating system type.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form determineServerOPSystem using separator<br/><br/>serverFileSystem<br/><br/>serverOpSystem.<br/><br/>&nbsp;<br/><br/>* Find the file system<br/><br/>select single fileSys<br/><br/>from opSystem<br/><br/>into serverFileSystem<br/><br/>where opSys = sy-opsys.<br/><br/>&nbsp;<br/><br/>find 'WINDOWS' in serverFilesystem ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>separator = ''.<br/><br/>serverOpSystem = NON_UNIX.<br/><br/>serverFileSystem = 'Windows NT'.<br/><br/>else.<br/><br/>find 'DOS' in serverFilesystem ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>separator = ''.<br/><br/>serverOpSystem = NON_UNIX.<br/><br/>else.<br/><br/>separator = '/'.<br/><br/>serverOpSystem = UNIX.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                        "determineServerOpSystem<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* findExternalCommand.... Determine if the external command exists.  If it doesn't then disable the<br/><br/>*                         server input field<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form findExternalCommand using value(locServerFileSystem).<br/><br/>&nbsp;<br/><br/>data: castServerOpSys type syopsys.<br/><br/>&nbsp;<br/><br/>castServerOpSys = locServerFileSystem.<br/><br/>&nbsp;<br/><br/>call function 'SXPG_COMMAND_CHECK'<br/><br/>exporting<br/><br/>commandname                      = 'ZDTX_MKDIR'<br/><br/>operatingsystem                  = castServerOpSys<br/><br/>exceptions<br/><br/>command_not_found                = 1<br/><br/>others                           = 0.<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>loop at screen.<br/><br/>if screen-name = 'PLOGICAL'.<br/><br/>screen-input = 0.<br/><br/>modify screen.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if screen-name = 'PSERV'.<br/><br/>screen-input = 0.<br/><br/>modify screen.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if screen-name = 'PPC'.<br/><br/>screen-input = 0.<br/><br/>modify screen.<br/><br/>endif.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>message s000(oo) with 'Download to server disabled,' 'external command ZDTX_MKDIR not defined.'.<br/><br/>endif.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>********************************************************************************************************<br/><br/>*****************************************DOWNLOAD ROUTINES**********************************************<br/><br/>********************************************************************************************************<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* downloadDDStructures... download database objects to file<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form downloadDDStructures using iLocDictionary like iDictionary[]<br/><br/>iLocDictionaryFilename like iDictFilename[]<br/><br/>value(pathname)<br/><br/>value(HtmlFileExtension)<br/><br/>value(subDir)<br/><br/>value(sortTablesAsc)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waDictionary&gt; type tDictTable.<br/><br/>data: tableFilename type string.<br/><br/>data: tableFilenameWithPath type string.<br/><br/>data: iHtmlTable type standard table of string with header line.<br/><br/>data: newSubDirectory type string.<br/><br/>data: completeSavePath type string.<br/><br/>data: waDictFilename like line of iLocDictionaryFilename.<br/><br/>&nbsp;<br/><br/>loop at iLocDictionary assigning &lt;waDictionary&gt;.<br/><br/>perform buildFilename using pathName<br/><br/>subDir<br/><br/>&lt;waDictionary&gt;-tablename<br/><br/>space<br/><br/>space<br/><br/>HtmlFileExtension<br/><br/>IS_TABLE<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>tableFilenameWithPath<br/><br/>tablefilename<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>read table iLocDictionaryFilename into waDictFilename with key tableName = &lt;waDictionary&gt;-tablename<br/><br/>filename = completeSavePath.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>*     Try and import a converted table to memory as it will be much quicker than converting it again<br/><br/>import iHtmlTable from memory id &lt;waDictionary&gt;-tablename.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>if displayProgressMessage = ABAP_TRUE.<br/><br/>concatenate 'Converting table' &lt;waDictionary&gt;-tablename 'to html' into statusBarMessage separated by space.<br/><br/>perform displayStatus using statusBarMessage 0.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform convertDDtoHTML using &lt;waDictionary&gt;-iStructure[]<br/><br/>iHtmlTable[]<br/><br/>&lt;waDictionary&gt;-tableName<br/><br/>&lt;waDictionary&gt;-tableTitle<br/><br/>sortTablesAsc<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>export iHtmlTable to memory id &lt;waDictionary&gt;-tablename.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iHtmlTable[]<br/><br/>tableFilenameWithPath<br/><br/>tableFilename<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iHtmlTable[]<br/><br/>tableFilenameWithPath<br/><br/>tableFilename<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waDictFilename-tablename = &lt;waDictionary&gt;-tablename.<br/><br/>waDictFilename-filename = completeSavePath.<br/><br/>append waDictFilename to iLocDictionaryFilename.<br/><br/>clear waDictFilename.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>clear iHtmlTable[].<br/><br/>endloop.<br/><br/>endform.                                                                           "downloadDDStructures<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  downloadDDTableTypes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadDDTableTypes using iLocTableTypes like iTableTypes[]<br/><br/>iLocTableTypeFilename like iDictFilename[]<br/><br/>value(pathname)<br/><br/>value(htmlFileExtension)<br/><br/>value(subdir)<br/><br/>value(sortTablesAsc)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;watabletypes&gt; like line of iLocTableTypes.<br/><br/>field-symbols &lt;waTtFilename&gt; like line of iLocTableTypeFilename[].<br/><br/>data: tableFilename type string.<br/><br/>data: tableFilenameWithPath type string.<br/><br/>data: iHtmlTable type standard table of string with header line.<br/><br/>data: newSubDirectory type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>loop at iLocTableTypes assigning &lt;waTableTypes&gt;.<br/><br/>perform buildFilename using pathname<br/><br/>subdir<br/><br/>&lt;waTableTypes&gt;-typename<br/><br/>space<br/><br/>space<br/><br/>htmlFileExtension<br/><br/>IS_TABLE<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>tableFilenameWithPath<br/><br/>tableFilename<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>read table iLocTableTypeFilename into &lt;waTTFilename&gt; with key tableName = &lt;waTableTypes&gt;-typename<br/><br/>filename = completeSavePath.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>*     Try and import a converted table to memory as it will be much quicker than converting it again<br/><br/>import iHtmlTable from memory id &lt;waTableTypes&gt;-typename.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>if displayProgressMessage = ABAP_TRUE.<br/><br/>concatenate 'Converting table type' &lt;waTableTypes&gt;-typename 'to html' into statusBarMessage separated by space.<br/><br/>perform displayStatus using statusBarMessage 0.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*    --     Need a specific routine for table types.  All data is in the table<br/><br/>perform convertTableTypeToHtml using iLocTableTypes[]<br/><br/>iHtmlTable[]<br/><br/>&lt;waTableTypes&gt;-typename<br/><br/>&lt;waTableTypes&gt;-ddtext<br/><br/>sortTablesAsc<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPC using iHtmlTable[]<br/><br/>tableFilenameWithPath<br/><br/>tableFilename<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iHtmlTable[]<br/><br/>tableFilenameWithPath<br/><br/>tableFilename<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>clear iHtmlTable[].<br/><br/>endloop.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>* downloadMessageClass...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form downloadMessageClass using iLocMessages like iMessages[]<br/><br/>value(messageClassName)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(HTMLfileFlag)<br/><br/>subDir<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(userHasSelectedMessageClasses)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: htmlPageName type string.<br/><br/>data: newFilenameOnly type string.<br/><br/>data: newFilenameWithPath type string.<br/><br/>data: iHtmlTable type standard table of string with header line.<br/><br/>data: newSubDirectory type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>perform appendMessagesToFile using iLocMessages[]<br/><br/>iHtmlTable[]<br/><br/>userHasSelectedMessageClasses.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>concatenate `message class ` messageClassName into htmlPageName.<br/><br/>&nbsp;<br/><br/>if htmlFileFlag is initial.<br/><br/>append '' to iHtmlTable.<br/><br/>append  '----------------------------------------------------------------------------------' to iHtmlTable.<br/><br/>&nbsp;<br/><br/>perform buildFooterMessage using iHtmlTable.<br/><br/>append iHtmlTable.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iHtmlTable[]<br/><br/>htmlPageName<br/><br/>space<br/><br/>IS_MESSAGECLASS<br/><br/>''<br/><br/>FALSE<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStructures<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>messageClassName<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>IS_MESSAGECLASS<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iHtmlTable[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>*     Save the file to the SAP server<br/><br/>perform saveFileToServer using iHtmlTable[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endform.                                                                          "downloadMessageClass<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  appendMessagesToFile<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form appendMessagesToFile using iLocMessages like iMessages[]<br/><br/>iLocHtml like dumiHtml[]<br/><br/>value(userHasSelectedMessageClasses).<br/><br/>&nbsp;<br/><br/>data: previousMessageID like iMessages-arbgb.<br/><br/>field-symbols: &lt;waMessage&gt; type tMessage.<br/><br/>data: waHtml type string.<br/><br/>&nbsp;<br/><br/>sort iLocMessages ascending by arbgb msgnr.<br/><br/>&nbsp;<br/><br/>if not iLocMessages[] is initial.<br/><br/>if userHasSelectedMessageClasses is initial.<br/><br/>*     Only add these extra lines if we are actually appending them to the end of some program code<br/><br/>append waHtml to iLocHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>&nbsp;<br/><br/>append '*Messages' to iLocHtml.<br/><br/>append '*----------------------------------------------------------' to iLocHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>loop at iLocMessages assigning &lt;waMessage&gt;.<br/><br/>if ( &lt;waMessage&gt;-arbgb &lt;&gt; previousMessageID ).<br/><br/>&nbsp;<br/><br/>if userHasSelectedMessageClasses is initial.<br/><br/>*         Only add this extra lines if we are actually appending them to the end of some program code<br/><br/>append '*' to iLocHtml.<br/><br/>concatenate `* Message class: ` &lt;waMessage&gt;-arbgb into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>previousMessageID = &lt;waMessage&gt;-arbgb.<br/><br/>clear waHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if userHasSelectedMessageClasses is initial.<br/><br/>*       Only add this extra lines if we are actually appending them to the end of some program code<br/><br/>concatenate '*' &lt;waMessage&gt;-msgnr `   ` &lt;waMessage&gt;-text into waHtml.<br/><br/>else.<br/><br/>concatenate &lt;waMessage&gt;-msgnr `   ` &lt;waMessage&gt;-text into waHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>append waHtml to iLocHtml.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                           "appendMessagesToFile<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  downloadFunctions...       Download function modules to file.<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form downloadFunctions using iLocFunctions like iFunctions[]<br/><br/>iLocDictionaryFilename like iDictFilename[]<br/><br/>iLocTableTypeFilename like iTableTypeFilename[]<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(subDir)<br/><br/>value(downloadDocumentation)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStruct)<br/><br/>value(textFileExtension)<br/><br/>value(htmlFileExtension)<br/><br/>value(sortTablesAsc)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: mainSubdir type string.<br/><br/>data: incSubdir type string.<br/><br/>field-symbols: &lt;waFunction&gt; type tFunction.<br/><br/>field-symbols: &lt;waInclude&gt; type tInclude.<br/><br/>data: iEmptyTextelements type standard table of tTextTable.<br/><br/>data: iEmptySelectionTexts type standard table of tTextTable.<br/><br/>data: iEmptyMessages type standard table of tMessage.<br/><br/>data: iEmptyGuiTitles type standard table of tGuiTitle.<br/><br/>data: functionDocumentationExists type abap_bool value FALSE.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>loop at iLocFunctions assigning &lt;waFunction&gt;.<br/><br/>if subDir is initial.<br/><br/>incSubDir = &lt;waFunction&gt;-functionName.<br/><br/>mainSubDir = ''.<br/><br/>else.<br/><br/>concatenate Subdir &lt;waFunction&gt;-functionName into incSubDir separated by slashSeparator.<br/><br/>mainSubDir = SubDir.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if not downloadDocumentation is initial.<br/><br/>perform downloadFunctionDocs using &lt;waFunction&gt;-functionName<br/><br/>&lt;waFunction&gt;-functionTitle<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>convertToHtml<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>mainSubDir<br/><br/>functionDocumentationExists<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download main source code<br/><br/>perform readFunctionAndDownload using &lt;waFunction&gt;-iTextelements[]<br/><br/>&lt;waFunction&gt;-iSelectionTexts[]<br/><br/>&lt;wafunction&gt;-iMessages[]<br/><br/>&lt;wafunction&gt;-functionName<br/><br/>&lt;wafunction&gt;-functionMainInclude<br/><br/>&lt;waFunction&gt;-functionTitle<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>mainSubDir<br/><br/>convertToHtml<br/><br/>functionDocumentationExists<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>*   Download top include<br/><br/>perform readIncludeAndDownload using iEmptyTextelements[]<br/><br/>iEmptySelectionTexts[]<br/><br/>iEmptyMessages[]<br/><br/>iEmptyGuiTitles[]<br/><br/>&lt;waFunction&gt;-topIncludeName<br/><br/>&lt;waFunction&gt;-functionName<br/><br/>&lt;waFunction&gt;-functionTitle<br/><br/>IS_FUNCTION<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>mainSubDir<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>*   Download screens.<br/><br/>if not &lt;waFunction&gt;-iScreenFlow[] is initial.<br/><br/>perform downloadScreens using &lt;wafunction&gt;-iScreenFlow[]<br/><br/>&lt;wafunction&gt;-progname<br/><br/>userFilePath<br/><br/>textFileExtension<br/><br/>mainSubDir<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download GUI titles<br/><br/>if not &lt;waFunction&gt;-iGUITitle[] is initial.<br/><br/>perform downloadGUITitles using &lt;wafunction&gt;-iGUITitle<br/><br/>userFilePath<br/><br/>textFileExtension<br/><br/>mainsubDir<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download all other includes<br/><br/>loop at &lt;wafunction&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>perform readIncludeAndDownload using iEmptyTextelements[]<br/><br/>iEmptySelectionTexts[]<br/><br/>iEmptyMessages[]<br/><br/>iEmptyGuiTitles[]<br/><br/>&lt;waInclude&gt;-IncludeName<br/><br/>space<br/><br/>&lt;waInclude&gt;-IncludeTitle<br/><br/>IS_PROGRAM<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>incSubDir<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Download all dictionary structures<br/><br/>if not &lt;wafunction&gt;-iDictStruct[] is initial.<br/><br/>perform downloadDDStructures using &lt;wafunction&gt;-iDictStruct[]<br/><br/>iLocDictionaryFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>mainSubDir<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download all Table Types<br/><br/>if not &lt;waFunction&gt;-iTableTypes[] is initial.<br/><br/>perform downloadDDTableTypes using &lt;waFunction&gt;-iTableTypes[]<br/><br/>iLocTableTypeFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>mainSubDir<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download Transformations<br/><br/>if not &lt;waFunction&gt;-iTransformations[] is initial.<br/><br/>perform downloadXSLT using &lt;waFunction&gt;-iTransformations[]<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>htmlFileExtension<br/><br/>textFileExtension<br/><br/>convertToHtml<br/><br/>customerNamespace<br/><br/>slashSeparatorToUse<br/><br/>saveToServer<br/><br/>subdir<br/><br/>displayProgressMessage<br/><br/>serverFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                              "downloadFunctions<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   readIcludeAndDownload...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form readIncludeAndDownload using iLocTextElements like dumiTextTab[]<br/><br/>iLocSelectionTexts like dumiTextTab[]<br/><br/>iLocMessages like iMessages[]<br/><br/>iLocGUITitles like dumIGUITitle[]<br/><br/>value(programName)<br/><br/>value(functionName)<br/><br/>value(programDescription)<br/><br/>value(overideProgType)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(additionalSubDir)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: localFilenameWithPath type string.<br/><br/>data: localFilenameOnly type string.<br/><br/>data: newSubdirectory type string.<br/><br/>data: objectName type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>read report programName into iLines.<br/><br/>&nbsp;<br/><br/>* Download GUI titles for main program<br/><br/>if not iLocGUITitles[] is initial.<br/><br/>perform appendGUITitles using iLocGUITitles[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download text elements for main program<br/><br/>if not iLocTextElements[] is initial.<br/><br/>perform appendTextElements using iLocTextElements[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download selection texts for main program<br/><br/>if not iLocSelectiontexts[] is initial.<br/><br/>perform appendSelectionTexts using iLocSelectiontexts[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download messages classes for main program.<br/><br/>if not iLocMessages[] is initial.<br/><br/>perform appendMessagesToFile using iLocMessages[]<br/><br/>iLines[]<br/><br/>space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append '' to iLines.<br/><br/>append '----------------------------------------------------------------------------------' to iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iLines[]<br/><br/>programName<br/><br/>programDescription<br/><br/>overideProgType<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStructures<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if functionName is initial.<br/><br/>objectName = programName.<br/><br/>else.<br/><br/>objectName = functionName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>additionalSubDir<br/><br/>objectName<br/><br/>space<br/><br/>programName<br/><br/>fileExtension<br/><br/>overideProgType<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>localFilenameWithPath<br/><br/>localfilenameOnly<br/><br/>newSubdirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endform.                                                                         "readIncludeAndDownload<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   readClassAndDownload...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form readClassAndDownload using waLocClass type tClass<br/><br/>value(className)<br/><br/>value(functionName)<br/><br/>value(overideProgType)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(additionalSubDir)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iTempLines type standard table of string with header line.<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: localFilenameWithPath type string.<br/><br/>data: localFilenameOnly type string.<br/><br/>data: newSubdirectory type string.<br/><br/>data: objectName type string.<br/><br/>data: castClassName type program.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>* Build up attribute comments<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Class attributes.                                                    *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>case waLocClass-exposure.<br/><br/>when 0.<br/><br/>append `Instantiation: Private` to iLines.<br/><br/>when 1.<br/><br/>append `Instantiation: Protected` to iLines.<br/><br/>when 2.<br/><br/>append `Instantiation: Public` to iLines.<br/><br/>endcase.<br/><br/>concatenate `Message class: ` waLocClass-msg_id into iLines.<br/><br/>append iLines.<br/><br/>case waLocClass-state.<br/><br/>when 0.<br/><br/>append `State: Only Modelled` to iLines.<br/><br/>when 1.<br/><br/>append `State: Implemented` to iLines.<br/><br/>endcase.<br/><br/>concatenate `Final Indicator: ` waLocClass-clsfinal into iLines.<br/><br/>append iLines.<br/><br/>concatenate `R/3 Release: ` waLocClass-r3Release into iLines.<br/><br/>append iLines.<br/><br/>clear iLines.<br/><br/>append iLines.<br/><br/>&nbsp;<br/><br/>castClassName = waLocClass-publicClassKey.<br/><br/>read report castClassName into iTempLines.<br/><br/>if sy-subrc = 0.<br/><br/>perform reFormatClassCode using iTempLines[].<br/><br/>&nbsp;<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Public section of class.                                             *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>loop at iTempLines.<br/><br/>append iTempLines to iLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>castClassName = waLocClass-privateClassKey.<br/><br/>read report castClassName into iTempLines.<br/><br/>if sy-subrc = 0.<br/><br/>perform reFormatClassCode using iTempLines[].<br/><br/>&nbsp;<br/><br/>append iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Private section of class.                                            *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>loop at iTempLines.<br/><br/>append iTempLines to iLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>castClassName = waLocClass-ProtectedClassKey.<br/><br/>read report castClassName into iTempLines.<br/><br/>if sy-subrc = 0.<br/><br/>perform reFormatClassCode using iTempLines[].<br/><br/>&nbsp;<br/><br/>append iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Protected section of class.                                          *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>loop at iTempLines.<br/><br/>append iTempLines to iLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>castClassName = waLocClass-typesClassKey.<br/><br/>read report castClassName into iTempLines.<br/><br/>if sy-subrc = 0.<br/><br/>append iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Types section of class.                                              *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>loop at iTempLines.<br/><br/>append iTempLines to iLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download text elements for this class<br/><br/>if not waLocClass-iTextElements[] is initial.<br/><br/>perform appendTextElements using waLocClass-iTextElements[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download messages classes for this class.<br/><br/>if not waLocClass-iMessages[] is initial.<br/><br/>perform appendMessagesToFile using waLocClass-iMessages[]<br/><br/>iLines[]<br/><br/>space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* Download exception texts for this class<br/><br/>if not waLocClass-iConcepts[] is initial.<br/><br/>perform appendExceptionTexts using waLocClass-iConcepts[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append '' to iLines.<br/><br/>append '----------------------------------------------------------------------------------' to iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertClassToHtml using iLines[]<br/><br/>className<br/><br/>waLocClass-descript<br/><br/>overideProgType<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>getDictStructures<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if functionName is initial.<br/><br/>objectName = className.<br/><br/>else.<br/><br/>objectName = functionName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>additionalSubDir<br/><br/>objectName<br/><br/>space<br/><br/>className<br/><br/>fileExtension<br/><br/>overideProgType<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>localFilenameWithPath<br/><br/>localfilenameOnly<br/><br/>newSubdirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endform.                                                                           "readClassAndDownload<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   readMethodAndDownload...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form readMethodAndDownload using waLocMethod type tMethod<br/><br/>value(methodName)<br/><br/>value(methodKey)<br/><br/>value(functionName)<br/><br/>value(overideProgType)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(additionalSubDir)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: iTempLines type standard table of string with header line.<br/><br/>data: localFilenameWithPath type string.<br/><br/>data: localFilenameOnly type string.<br/><br/>data: newSubdirectory type string.<br/><br/>data: objectName type string.<br/><br/>data: castMethodKey type program.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>* Add the method scope to the downloaded file<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '*   Method attributes.                                                   *' to iLines.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>case waLocMethod-exposure.<br/><br/>when 0.<br/><br/>append `Instantiation: Private` to iLines.<br/><br/>when 1.<br/><br/>append `Instantiation: Protected` to iLines.<br/><br/>when 2.<br/><br/>append `Instantiation: Public` to iLines.<br/><br/>endcase.<br/><br/>append '**************************************************************************' to iLines.<br/><br/>append '' to iLines.<br/><br/>&nbsp;<br/><br/>castMethodKey = waLocMethod-methodKey.<br/><br/>read report castMethodKey into iTempLines.<br/><br/>loop at iTempLines.<br/><br/>append iTempLines to iLines.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append '' to iLines.<br/><br/>append '----------------------------------------------------------------------------------' to iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iLines[]<br/><br/>methodName<br/><br/>waLocMethod-descript<br/><br/>overideProgType<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStructures<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if functionName is initial.<br/><br/>objectName = methodName.<br/><br/>else.<br/><br/>objectName = functionName.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>case waLocMethod-exposure.<br/><br/>when 0.<br/><br/>*     Private<br/><br/>concatenate additionalSubDir slashSeparator 'private_methods' into additionalSubDir.<br/><br/>when 1.<br/><br/>*     Protected<br/><br/>concatenate additionalSubDir slashSeparator 'protected_methods' into additionalSubDir.<br/><br/>when 2.<br/><br/>*     Public<br/><br/>concatenate additionalSubDir slashSeparator 'public_methods' into additionalSubDir.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>additionalSubDir<br/><br/>objectName<br/><br/>space<br/><br/>methodName<br/><br/>fileExtension<br/><br/>overideProgType<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>localFilenameWithPath<br/><br/>localfilenameOnly<br/><br/>newSubdirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endform.                                                                          "readMethodAndDownload<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   readXsltAndDownload...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form readXsltAndDownload using value(xsltName)<br/><br/>xsltDescription<br/><br/>value(userFilepath)<br/><br/>value(fileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(subdir)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: iLocXsltSource type o2pageline_table.<br/><br/>data: waXsltAttributes type o2xsltattr.<br/><br/>data: localFilenameWithPath type string.<br/><br/>data: localFilenameOnly type string.<br/><br/>data: newSubDirectory type string.<br/><br/>data: objectName type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>cl_o2_api_xsltdesc=&gt;load( exporting p_xslt_desc = xsltname<br/><br/>importing p_source = iLocXsltSource<br/><br/>p_attributes = waXsltAttributes<br/><br/>exceptions not_existing = 1<br/><br/>permission_failure = 2<br/><br/>error_occured = 3<br/><br/>version_not_found = 4 ).<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>xsltDescription = waXsltAttributes-descript.<br/><br/>&nbsp;<br/><br/>append lines of iLocXsltSource to iLines.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append '' to iLines.<br/><br/>append '----------------------------------------------------------------------------------' to ilines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iLines[]<br/><br/>xsltName<br/><br/>waXsltAttributes-descript<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>space<br/><br/>space<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildfilename using userFilePath<br/><br/>subdir<br/><br/>xsltName<br/><br/>space<br/><br/>xsltName<br/><br/>fileExtension<br/><br/>IS_TRANSFORMATION<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>newSubdirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileTopc using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFilesystem.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                         "readXSLTAndDownload<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   readFunctionAndDownload...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form readFunctionAndDownload using iLocTextElements like dumiTextTab[]<br/><br/>iLocSelectionTexts like dumiTextTab[]<br/><br/>iLocMessages like iMessages[]<br/><br/>value(functionName)<br/><br/>value(functionInternalName)<br/><br/>value(shortText)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(subDir)<br/><br/>value(convertToHtml)<br/><br/>value(functionDocumentationExists)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: localFilenameWithPath type string.<br/><br/>data: localFilenameOnly type string.<br/><br/>data: newSubDirectory type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>read report functionInternalName into iLines.<br/><br/>&nbsp;<br/><br/>* If we found any text elements for this function then we ought to append them to the main include.<br/><br/>if not iLocTextElements[] is initial.<br/><br/>perform appendTextElements using iLocTextElements[]<br/><br/>iLines[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* If we found any message classes for this function then we ought to append them to the main include.<br/><br/>if not iLocMessages[] is initial.<br/><br/>perform appendMessagesToFile using iLocMessages[]<br/><br/>iLines[]<br/><br/>space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append '' to iLines.<br/><br/>append '----------------------------------------------------------------------------------' to iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertFunctionToHtml using iLines[]<br/><br/>functionName<br/><br/>shortText<br/><br/>IS_FUNCTION<br/><br/>functionDocumentationExists<br/><br/>TRUE<br/><br/>fileExtension<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStructures<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>functionName<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>IS_FUNCTION<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>localFilenameWithPath<br/><br/>localfilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>localFilenameWithPath<br/><br/>localFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>endform.                                                                        "readFunctionAndDownload<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  buildFilename...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form buildFilename using value(userPath)<br/><br/>value(additionalSubDirectory)<br/><br/>value(objectName)<br/><br/>value(mainFunctionNo)<br/><br/>value(includeName)<br/><br/>value(fileExtension)<br/><br/>value(downloadType)<br/><br/>value(downloadToServer)<br/><br/>value(slashSeparator)<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>newSubDirectory<br/><br/>completePath.<br/><br/>&nbsp;<br/><br/>* If we are running on a non UNIX environment we will need to remove forward slashes from the additional path.<br/><br/>if downloadToServer is initial.<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>if not additionalSubdirectory is initial.<br/><br/>translate additionalSubdirectory using '/_'.<br/><br/>if additionalSubdirectory+0(1) = '_'.<br/><br/>shift additionalSubdirectory left by 1 places.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>if serverOpSystem = NON_UNIX.<br/><br/>if not additionalSubdirectory is initial.<br/><br/>translate additionalSubdirectory using '/_'.<br/><br/>if additionalSubdirectory+0(1) = '_'.<br/><br/>shift additionalSubdirectory left by 1 places.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>case downloadType.<br/><br/>*   Programs<br/><br/>when IS_PROGRAM.<br/><br/>if additionalSubDirectory is initial.<br/><br/>concatenate userPath slashSeparator objectName PERIOD fileExtension into newFilenameWithPath.<br/><br/>concatenate userPath slashSeparator into completePath.<br/><br/>else.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory<br/><br/>slashSeparator objectName PERIOD fileExtension into newFilenameWithPath.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Function Modules<br/><br/>when IS_FUNCTION.<br/><br/>if additionalSubdirectory is initial.<br/><br/>find 'top' in includeName ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator 'Global-' objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>else.<br/><br/>if includeName cs mainFunctionNo and not mainFunctionNo is initial.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>else.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>endif.<br/><br/>endif.<br/><br/>newSubDirectory = objectName.<br/><br/>concatenate userPath<br/><br/>slashSeparator<br/><br/>newSubDirectory<br/><br/>slashSeparator into completePath.<br/><br/>else.<br/><br/>find 'top' in includeName ignoring case.<br/><br/>if sy-subrc = 0.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator 'Global-' objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>else.<br/><br/>if includeName cs mainFunctionNo and not mainFunctionNo is initial.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>else.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator objectName<br/><br/>PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>endif.<br/><br/>endif.<br/><br/>concatenate additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubdirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Table definition<br/><br/>when IS_TABLE.<br/><br/>if additionalSubdirectory is initial.<br/><br/>concatenate userPath slashSeparator 'Dictionary_Objects'   " slashSeparator objectName<br/><br/>slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into NewSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory<br/><br/>slashSeparator 'Dictionary_Objects'   " slashSeparator objectName<br/><br/>slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Table definition<br/><br/>when IS_TRANSFORMATION.<br/><br/>if additionalSubdirectory is initial.<br/><br/>concatenate userPath slashSeparator 'Transformations'   " slashSeparator objectName<br/><br/>slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into NewSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory<br/><br/>slashSeparator 'Transformations'   " slashSeparator objectName<br/><br/>slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Program &amp; Function documentation<br/><br/>when IS_DOCUMENTATION.<br/><br/>if additionalSubDirectory is initial.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator 'Docs-'<br/><br/>objectName PERIOD<br/><br/>fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator 'Docs-'<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userpath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Screens<br/><br/>when IS_SCREEN.<br/><br/>if additionalSubDirectory is initial.<br/><br/>concatenate userpath slashSeparator 'Screens'<br/><br/>slashSeparator 'screen_'<br/><br/>objectName PERIOD<br/><br/>fileExtension into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator 'screens' into newSubDirectory.<br/><br/>concatenate userPath slashSeparator 'screens' into completePath.<br/><br/>&nbsp;<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubdirectory<br/><br/>slashSeparator 'Screens'<br/><br/>slashSeparator 'screen_'<br/><br/>objectName PERIOD<br/><br/>fileExtension into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator 'screens' into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator 'screens' into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   GUI title<br/><br/>when IS_GUITITLE.<br/><br/>if additionalSubDirectory is initial.<br/><br/>concatenate userpath slashSeparator 'Screens'<br/><br/>slashSeparator 'gui_title_'<br/><br/>objectName PERIOD<br/><br/>fileExtension into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator 'screens' into newSubDirectory.<br/><br/>concatenate userPath slashSeparator 'screens' into completePath.<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubdirectory<br/><br/>slashSeparator 'Screens'<br/><br/>slashSeparator 'gui_title_'<br/><br/>objectName PERIOD<br/><br/>fileExtension into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator 'Screens' into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator 'Screens' into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Message Class<br/><br/>when IS_MESSAGECLASS.<br/><br/>if additionalSubDirectory is initial.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator 'Message class-'<br/><br/>objectName PERIOD<br/><br/>fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator 'Message class-'<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userpath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Class definition<br/><br/>when IS_CLASS.<br/><br/>if additionalSubdirectory is initial.<br/><br/>concatenate userPath slashSeparator objectName<br/><br/>slashSeparator 'Class-'<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory<br/><br/>slashSeparator objectName<br/><br/>slashSeparator 'Class-'<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into completePath.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Class definition<br/><br/>when IS_METHOD.<br/><br/>if additionalSubdirectory is initial.<br/><br/>concatenate userPath slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>concatenate userPath slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator objectName into completePath.<br/><br/>else.<br/><br/>concatenate userpath slashSeparator additionalSubDirectory<br/><br/>slashSeparator<br/><br/>objectName PERIOD fileExtension<br/><br/>into newFilenameWithPath.<br/><br/>&nbsp;<br/><br/>*        concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.<br/><br/>concatenate userPath slashSeparator additionalSubDirectory into completePath.<br/><br/>endif.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>translate completePath to lower case.<br/><br/>concatenate objectName PERIOD fileExtension into newFilenameOnly.<br/><br/>translate newFilenameOnly to lower case.<br/><br/>translate newFilenameWithPath to lower case.<br/><br/>translate newSubDirectory to lower case.<br/><br/>&nbsp;<br/><br/>* If we are running on a non UNIX environment we will need to remove incorrect characters from the filename.<br/><br/>if downloadToServer is initial.<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate newFilenameOnly using '/_'.<br/><br/>translate newFilenameWithPath using '/_'.<br/><br/>translate newFilenameOnly using '&lt; '.<br/><br/>translate newFilenameWithPath using '&lt; '.<br/><br/>translate newFilenameOnly using '&gt; '.<br/><br/>translate newFilenameWithPath using '&gt; '.<br/><br/>translate newFilenameOnly using '? '.<br/><br/>translate newFilenameWithPath using '? '.<br/><br/>translate newFilenameOnly using '| '.<br/><br/>translate newFilenameWithPath using '| '.<br/><br/>condense newFilenameOnly no-gaps.<br/><br/>condense newFilenameWithPath no-gaps.<br/><br/>endif.<br/><br/>else.<br/><br/>if serverOpSystem = NON_UNIX.<br/><br/>translate newFilenameOnly using '/_'.<br/><br/>translate newFilenameWithPath using '/_'.<br/><br/>translate newFilenameOnly using '&lt; '.<br/><br/>translate newFilenameWithPath using '&lt; '.<br/><br/>translate newFilenameOnly using '&gt; '.<br/><br/>translate newFilenameWithPath using '&gt; '.<br/><br/>translate newFilenameOnly using '? '.<br/><br/>translate newFilenameWithPath using '? '.<br/><br/>translate newFilenameOnly using '| '.<br/><br/>translate newFilenameWithPath using '| '.<br/><br/>condense newFilenameOnly no-gaps.<br/><br/>condense newFilenameWithPath no-gaps.<br/><br/>endif.<br/><br/>endif.<br/><br/>endform.                                                                                 "buildFilename<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*  saveFileToPc...    write an internal table to a file on the local PC<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form saveFileToPc using iDownload type standard table<br/><br/>value(filenameWithPath)<br/><br/>value(filename)<br/><br/>value(writeFieldSeparator)<br/><br/>value(truncateTrailingBlanks)<br/><br/>value(displayProgressMessage).<br/><br/>&nbsp;<br/><br/>data: statusMessage type string.<br/><br/>data: objFile type ref to cl_gui_frontend_services.<br/><br/>data: strSubrc type string.<br/><br/>&nbsp;<br/><br/>if not displayProgressMessage is initial.<br/><br/>concatenate `Downloading: ` filename into statusMessage.<br/><br/>perform displayStatus using statusMessage 0.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>create object objFile.<br/><br/>objFile-&gt;gui_download( exporting filename = filenameWithPath<br/><br/>filetype = 'ASC'<br/><br/>write_field_separator = writeFieldSeparator<br/><br/>trunc_trailing_blanks = truncateTrailingBlanks<br/><br/>changing data_tab = iDownload[]<br/><br/>exceptions file_write_error        = 1<br/><br/>no_batch                = 2<br/><br/>gui_refuse_filetransfer = 3<br/><br/>invalid_type            = 4<br/><br/>no_authority            = 5<br/><br/>unknown_error           = 6<br/><br/>header_not_allowed      = 7<br/><br/>separator_not_allowed   = 8<br/><br/>filesize_not_allowed    = 9<br/><br/>header_too_long         = 10<br/><br/>dp_error_create         = 11<br/><br/>dp_error_send           = 12<br/><br/>dp_error_write          = 13<br/><br/>unknown_dp_error        = 14<br/><br/>access_denied           = 15<br/><br/>dp_out_of_memory        = 16<br/><br/>disk_full               = 17<br/><br/>dp_timeout              = 18<br/><br/>file_not_found          = 19<br/><br/>dataprovider_exception  = 20<br/><br/>control_flush_error     = 21<br/><br/>not_supported_by_gui    = 22<br/><br/>error_no_gui            = 23 ).<br/><br/>&nbsp;<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>strSubrc = sy-subrc.<br/><br/>concatenate `File save error: ` filename ` sy-subrc: ` strSubrc into statusMessage.<br/><br/>perform displayStatus using statusMessage 3.<br/><br/>endif.<br/><br/>endform.                                                                                                  "saveFileToPc<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  saveFileToServer...    write an internal table to a file on the SAP server<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form saveFileToServer using iDownload type standard table<br/><br/>value(filenameWithPath)<br/><br/>value(filename)<br/><br/>value(path)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem).<br/><br/>&nbsp;<br/><br/>data: waDownload type string.<br/><br/>data: statusMessage type string.<br/><br/>&nbsp;<br/><br/>if not displayProgressMessage is initial.<br/><br/>concatenate `Downloading: ` filename into statusMessage.<br/><br/>perform displayStatus using statusMessage 0.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>read table iServerPaths with key table_line = path.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>perform createServerDirectory using path locServerFileSystem.<br/><br/>append path to iServerPaths.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>open dataset filenameWithPath for output in text mode encoding default.<br/><br/>if sy-subrc = 0.<br/><br/>loop at iDownload into waDownload.<br/><br/>transfer waDownload to filenameWithPath.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>message e000(oo) with 'Error transferring data to file'.<br/><br/>endif.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>close dataset filenameWithPath.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>message e000(oo) with 'Error closing file'.<br/><br/>endif.<br/><br/>else.<br/><br/>*   Unable to create a file<br/><br/>message e000(oo) with 'Error creating file on SAP server' 'check permissions'.<br/><br/>endif.<br/><br/>endform.                                                                                              "saveFileToServer<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* createServerDirectory...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form createServerDirectory using value(path)<br/><br/>value(locServerFileSystem).<br/><br/>&nbsp;<br/><br/>data: castServerOpSys type syopsys.<br/><br/>&nbsp;<br/><br/>castServerOpSys = locServerFileSystem.<br/><br/>&nbsp;<br/><br/>*  Parameters for remove command.<br/><br/>data: param1 type sxpgcolist-parameters.<br/><br/>*  Return status<br/><br/>data: funcStatus type extcmdexex-status.<br/><br/>*  Command line listing returned by the function<br/><br/>data: iServerOutput type standard table of btcxpm.<br/><br/>data: waServeroutput type btcxpm.<br/><br/>*  Targetsystem type conversion variable.<br/><br/>data: target type rfcdisplay-rfchost.<br/><br/>* Operating system<br/><br/>data: operatingSystem type sxpgcolist-opsystem.<br/><br/>*  Head for split command.<br/><br/>data: head type string..<br/><br/>data: tail type string.<br/><br/>&nbsp;<br/><br/>param1 = path.<br/><br/>target = sy-host.<br/><br/>operatingSystem = locServerFileSystem.<br/><br/>&nbsp;<br/><br/>call function 'SXPG_COMMAND_EXECUTE'<br/><br/>exporting<br/><br/>commandname                         = 'ZDTX_MKDIR'<br/><br/>additional_parameters               = param1<br/><br/>operatingsystem                     = castServerOpSys<br/><br/>targetsystem                        = target<br/><br/>stdout                              = 'X'<br/><br/>stderr                              = 'X'<br/><br/>terminationwait                     = 'X'<br/><br/>importing<br/><br/>status                              = funcStatus<br/><br/>tables<br/><br/>exec_protocol                       = iServerOutput[]<br/><br/>exceptions<br/><br/>no_permission                       = 1<br/><br/>command_not_found                   = 2<br/><br/>parameters_too_long                 = 3<br/><br/>security_risk                       = 4<br/><br/>wrong_check_call_interface          = 5<br/><br/>program_start_error                 = 6<br/><br/>program_termination_error           = 7<br/><br/>x_error                             = 8<br/><br/>parameter_expected                  = 9<br/><br/>too_many_parameters                 = 10<br/><br/>illegal_command                     = 11<br/><br/>wrong_asynchronous_parameters       = 12<br/><br/>cant_enq_tbtco_entry                = 13<br/><br/>jobcount_generation_error           = 14<br/><br/>others                              = 15.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>*   Although the function succeded did the external command actually work<br/><br/>if funcStatus = 'E'.<br/><br/>*     External command returned with an error<br/><br/>if sy-opsys cs 'Windows NT'.<br/><br/>read table iServeroutput index 1 into waServeroutput.<br/><br/>if waServeroutput-message ns 'already exists'.<br/><br/>*         An error occurred creating the directory on the server<br/><br/>message e000(oo) with 'An error occurred creating a directory'.<br/><br/>endif.<br/><br/>else.<br/><br/>read table iServerOutput index 2 into waServeroutput.<br/><br/>split waServeroutput-message at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>if tail &lt;&gt; 'Do not specify an existing file.'.<br/><br/>*         An error occurred creating the directory on the server<br/><br/>message e000(oo) with 'An error occurred creating a directory'.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>case sy-subrc.<br/><br/>when 1.<br/><br/>*       No permissions to run the command<br/><br/>message e000(oo) with 'No permissions to run external command ZDTX_MKDIR'.<br/><br/>when 2.<br/><br/>*       External command not found<br/><br/>message E000(oo) with 'External comand ZDTX_MKDIR not found'.<br/><br/>&nbsp;<br/><br/>when others.<br/><br/>*       Unable to create the directory<br/><br/>message e000(oo) with 'An error occurred creating a directory'<br/><br/>', subrc:'<br/><br/>sy-subrc.<br/><br/>endcase.<br/><br/>endif.<br/><br/>endform.                                                                                         "createServerDirectory<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* appendTextElements...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form appendTextElements using iLocTextElements like dumiTextTab[]<br/><br/>iLocLines like dumiHtml[].<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waTextElement&gt; type tTextTable.<br/><br/>data: waLine type string.<br/><br/>&nbsp;<br/><br/>if lines( iLocTextElements ) &gt; 0.<br/><br/>append '' to iLocLines.<br/><br/>&nbsp;<br/><br/>append '*Text elements' to iLocLines.<br/><br/>append '*----------------------------------------------------------' to  iLocLines.<br/><br/>loop at iLocTextElements assigning &lt;waTextElement&gt;.<br/><br/>concatenate '*  ' &lt;waTextElement&gt;-key &lt;waTextElement&gt;-entry into waLine separated by space.<br/><br/>append waLine to iLocLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                                            "appendTextElements<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* appendGUITitles...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form appendGUITitles using iLocGUItitles like dumiGUITitle[]<br/><br/>iLocLines like dumiHtml[].<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waGUITitle&gt; type tGUITitle.<br/><br/>data: waLine type string.<br/><br/>&nbsp;<br/><br/>if lines( iLocGUItitles ) &gt; 0.<br/><br/>append '' to iLocLines.<br/><br/>&nbsp;<br/><br/>append '*GUI Texts' to iLocLines.<br/><br/>append '*----------------------------------------------------------' to  iLocLines.<br/><br/>loop at iLocGUItitles assigning &lt;waGUItitle&gt;.<br/><br/>concatenate '*  ' &lt;waGUItitle&gt;-obj_code '--&gt;' &lt;waGUItitle&gt;-text into waLine separated by space.<br/><br/>append waLine to iLocLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                                               "appendGUITitles<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* appendSelectionTexts...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form appendSelectionTexts using iLocSelectionTexts like dumiTextTab[]<br/><br/>iLocLines like dumiHtml[].<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waSelectionText&gt; type tTextTable.<br/><br/>data: waLine type string.<br/><br/>&nbsp;<br/><br/>if lines( iLocSelectionTexts ) &gt; 0.<br/><br/>append '' to iLocLines.<br/><br/>append '' to iLocLines.<br/><br/>&nbsp;<br/><br/>append '*Selection texts' to iLocLines.<br/><br/>append '*----------------------------------------------------------' to  iLocLines.<br/><br/>loop at iLocSelectiontexts assigning &lt;waSelectionText&gt;.<br/><br/>concatenate '*  ' &lt;waSelectionText&gt;-key &lt;waSelectionText&gt;-entry into waLine separated by space.<br/><br/>append waLine to iLocLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                                          "appendSelectionTexts<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* appendExceptionTexts...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form appendExceptionTexts using iConcepts like dumiConcepts[]<br/><br/>iLocLines like dumiHtml[].<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waConcept&gt; type tConcept.<br/><br/>data: waLine type string.<br/><br/>data: conceptText type sotr_txt.<br/><br/>&nbsp;<br/><br/>if lines( iConcepts ) &gt; 0.<br/><br/>append '' to iLocLines.<br/><br/>&nbsp;<br/><br/>append '*Exception texts' to iLocLines.<br/><br/>append '*----------------------------------------------------------' to  iLocLines.<br/><br/>loop at iConcepts assigning &lt;waConcept&gt;.<br/><br/>*     Find the text for this concept<br/><br/>call function 'SOTR_GET_TEXT_KEY' exporting concept = &lt;waConcept&gt;-concept<br/><br/>langu = pMLang<br/><br/>search_in_second_langu = 'X'<br/><br/>*                                                  second_langu = 'DE'<br/><br/>importing e_text = conceptText<br/><br/>exceptions no_entry_found = 1<br/><br/>parameter_error = 2<br/><br/>others  = 3.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>concatenate '*  ' &lt;waConcept&gt;-constName '-' conceptText  into waLine separated by space.<br/><br/>append waLine to iLocLines.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endif.<br/><br/>endform.                                                                                          "appendExceptionTexts<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* downloadFunctionDocs...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadFunctionDocs using value(functionName)<br/><br/>value(functionDescription)<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>subDir<br/><br/>documentationDownloaded<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: iDocumentation type standard table of funct with header line.<br/><br/>data: iExceptions type standard table of rsexc with header line.<br/><br/>data: iExport type standard table of rsexp with header line.<br/><br/>data: iParameter type standard table of rsimp with header line.<br/><br/>data: iTables type standard table of rstbl with header line.<br/><br/>data: iScriptLines type standard table of tline with header line.<br/><br/>data: htmlPageName type string.<br/><br/>data: newFilenameWithPath type string.<br/><br/>data: newFilenameOnly type string.<br/><br/>data: object like dokhl-object.<br/><br/>data: stringLength type i value 0.<br/><br/>data: newSubDirectory type string.<br/><br/>data: waLine(255).<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>documentationDownloaded = FALSE.<br/><br/>object = functionName.<br/><br/>&nbsp;<br/><br/>call function 'FUNCTION_IMPORT_DOKU'<br/><br/>exporting<br/><br/>funcName           = functionName<br/><br/>tables<br/><br/>DOKUMENTATION      = iDocumentation<br/><br/>EXCEPTION_LIST     = iExceptions<br/><br/>EXPORT_PARAMETER   = iExport<br/><br/>IMPORT_PARAMETER   = iParameter<br/><br/>TABLES_PARAMETER   = iTables<br/><br/>exceptions<br/><br/>ERROR_MESSAGE      = 1<br/><br/>FUNCTION_NOT_FOUND = 2<br/><br/>INVALID_NAME       = 3<br/><br/>others             = 4.<br/><br/>&nbsp;<br/><br/>call function 'DOCU_GET'<br/><br/>exporting<br/><br/>ID                     = 'FU'<br/><br/>LANGU                  = pMLang<br/><br/>OBJECT                 = object<br/><br/>TYP                    = 'T'<br/><br/>VERSION_ACTIVE_OR_LAST = 'L'<br/><br/>tables<br/><br/>line                   = iScriptLines<br/><br/>exceptions<br/><br/>NO_DOCU_ON_SCREEN      = 1<br/><br/>NO_DOCU_SELF_DEF       = 2<br/><br/>NO_DOCU_TEMP           = 3<br/><br/>RET_CODE               = 4<br/><br/>others                 = 5.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0 and not ( iScriptLines[] is initial ).<br/><br/>append 'SHORT TEXT' to iLines.<br/><br/>concatenate space functionDescription into functionDescription separated by space.<br/><br/>append functionDescription to iLines.<br/><br/>append space to iLines.<br/><br/>loop at iScriptLines.<br/><br/>move iScriptLines-tdline to iLines.<br/><br/>concatenate space iLines into iLines separated by space.<br/><br/>while iLines CP '&amp;*' or iLines CP '*&amp;'.<br/><br/>replace '&amp;' into iLines with space.<br/><br/>shift iLines left deleting leading space.<br/><br/>endwhile.<br/><br/>append iLines.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>clear iLines.<br/><br/>if not ( iDocumentation[] is initial ).<br/><br/>append iLines.<br/><br/>append 'PARAMETER DOCUMENTATION' to iLines.<br/><br/>append '-----------------------' to iLines.<br/><br/>append iLines.<br/><br/>&nbsp;<br/><br/>describe field iDocumentation-parameter length stringLength in character mode.<br/><br/>stringLength = stringLength + 3.<br/><br/>loop at iDocumentation.<br/><br/>move iDocumentation-parameter to waLine.<br/><br/>move iDocumentation-stext to waLine+stringLength.<br/><br/>append waLine to iLines.<br/><br/>endloop.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate `Documentation - ` functionName into htmlPageName.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append iLines.<br/><br/>append  '----------------------------------------------------------------------------------' to iLines.<br/><br/>append iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iLines[]<br/><br/>htmlPageName<br/><br/>space<br/><br/>IS_DOCUMENTATION<br/><br/>TRUE<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>functionName<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>IS_DOCUMENTATION<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPC using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>documentationDownloaded = TRUE.<br/><br/>endif.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* downloadClassDocs...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadClassDocs using value(className) type seoclsname<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>subDir<br/><br/>documentationDownloaded<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>data: iDocumentation type standard table of funct with header line.<br/><br/>data: iExceptions type standard table of rsexc with header line.<br/><br/>data: iExport type standard table of rsexp with header line.<br/><br/>data: iParameter type standard table of rsimp with header line.<br/><br/>data: iTables type standard table of rstbl with header line.<br/><br/>data: iScriptLines type standard table of tline with header line.<br/><br/>data: htmlPageName type string.<br/><br/>data: newFilenameWithPath type string.<br/><br/>data: newFilenameOnly type string.<br/><br/>data: object like dokhl-object.<br/><br/>data: stringLength type i value 0.<br/><br/>data: newSubDirectory type string.<br/><br/>data: waLine(255).<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>documentationDownloaded = FALSE.<br/><br/>object = className.<br/><br/>&nbsp;<br/><br/>call function 'DOC_OBJECT_GET'<br/><br/>exporting<br/><br/>class                  = 'CL'<br/><br/>name                   = object<br/><br/>language               = pMLang<br/><br/>*     short_text             = ' '<br/><br/>*     appendix               = ' '<br/><br/>*   importing<br/><br/>*     header                 = header<br/><br/>tables<br/><br/>itf_lines              = iScriptLines[]<br/><br/>exceptions<br/><br/>object_not_found       = 1.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0 and not ( iScriptLines[] is initial ).<br/><br/>loop at iScriptLines.<br/><br/>move iScriptLines-tdline to iLines.<br/><br/>concatenate space iLines into iLines separated by space.<br/><br/>while iLines CP '&amp;*' or iLines CP '*&amp;'.<br/><br/>replace '&amp;' into iLines with space.<br/><br/>shift iLines left deleting leading space.<br/><br/>endwhile.<br/><br/>append iLines.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>concatenate `Documentation - ` className into htmlPageName.<br/><br/>&nbsp;<br/><br/>if convertToHtml is initial.<br/><br/>append iLines.<br/><br/>append  '----------------------------------------------------------------------------------' to iLines.<br/><br/>append iLines.<br/><br/>perform buildFooterMessage using iLines.<br/><br/>append iLines.<br/><br/>else.<br/><br/>perform convertCodeToHtml using iLines[]<br/><br/>htmlPageName<br/><br/>space<br/><br/>IS_DOCUMENTATION<br/><br/>TRUE<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>space<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>className<br/><br/>space<br/><br/>space<br/><br/>fileExtension<br/><br/>IS_DOCUMENTATION<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPC using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>documentationDownloaded = TRUE.<br/><br/>endif.<br/><br/>endform.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  downloadScreens...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadScreens using iLocScreenFlow like dumiScreen[]<br/><br/>value(programName)<br/><br/>value(userFilePath)<br/><br/>value(textFileExtension)<br/><br/>value(subdir)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem).<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>tables: d020t.<br/><br/>data: header like d020s.<br/><br/>data: iFields type standard table of d021s with header line.<br/><br/>data: iFlowLogic type standard table of d022s with header line.<br/><br/>field-symbols &lt;waScreen&gt; type tScreenFlow.<br/><br/>data: waCharHeader type scr_chhead.<br/><br/>data: iScreenChar type standard table of scr_chfld with header line.<br/><br/>data: iFieldsChar type standard table of scr_chfld with header line.<br/><br/>data: stars type string value '****************************************************************'.<br/><br/>data: comment1 type string value '*   This file was generated by Direct Download Enterprise.     *'.<br/><br/>data: comment2 type string value '*   Please do not change it manually.                          *'.<br/><br/>data: dynproText type string value '%_DYNPRO'.<br/><br/>data: headerText type string value '%_HEADER'.<br/><br/>data: paramsText type string value '%_PARAMS'.<br/><br/>data: descriptionText type string value '%_DESCRIPTION'.<br/><br/>data: fieldsText type string value '%_FIELDS'.<br/><br/>data: flowlogicText type string value '%_FLOWLOGIC'.<br/><br/>data: programLength type string.<br/><br/>data: newSubDirectory type string.<br/><br/>data: newFilenameWithPath type string.<br/><br/>data: newFilenameOnly type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>loop at iLocScreenFlow assigning &lt;waScreen&gt;.<br/><br/>call function 'RS_IMPORT_DYNPRO'<br/><br/>exporting<br/><br/>dylang = pMLang<br/><br/>dyname = programName<br/><br/>dynumb = &lt;waScreen&gt;-screen<br/><br/>importing<br/><br/>header = header<br/><br/>tables<br/><br/>ftab   = iFields<br/><br/>pltab  = iFlowLogic.<br/><br/>&nbsp;<br/><br/>call function 'RS_SCRP_HEADER_RAW_TO_CHAR'<br/><br/>exporting<br/><br/>header_int  = header<br/><br/>importing<br/><br/>header_char = waCharHeader<br/><br/>exceptions<br/><br/>others      = 1.<br/><br/>&nbsp;<br/><br/>*   Add in the top comments for the file<br/><br/>append stars to iScreenChar .<br/><br/>append comment1 to iScreenChar.<br/><br/>append comment2 to iScreenChar.<br/><br/>append stars to iScreenChar.<br/><br/>&nbsp;<br/><br/>*   Screen identification<br/><br/>append dynproText to iScreenChar.<br/><br/>append waCharHeader-prog to iScreenChar.<br/><br/>append waCharHeader-dnum to iScreenChar.<br/><br/>append sy-saprl to iScreenChar.<br/><br/>describe field d020t-prog length programLength in character mode.<br/><br/>concatenate `                ` programLength into iScreenChar.<br/><br/>append iScreenChar.<br/><br/>&nbsp;<br/><br/>*   Header<br/><br/>append headerText to iScreenChar.<br/><br/>append waCharHeader to iScreenChar.<br/><br/>&nbsp;<br/><br/>*   Description text<br/><br/>append descriptionText to iScreenChar.<br/><br/>select single dtxt from d020T into iScreenChar<br/><br/>where prog = programName<br/><br/>and dynr = &lt;waScreen&gt;-screen<br/><br/>and lang = pMLang.<br/><br/>append iScreenChar.<br/><br/>&nbsp;<br/><br/>*   Fieldlist text<br/><br/>append fieldsText to iScreenChar.<br/><br/>&nbsp;<br/><br/>call function 'RS_SCRP_FIELDS_RAW_TO_CHAR'<br/><br/>tables<br/><br/>fields_int  = iFields[]<br/><br/>fields_char = iFieldsChar[]<br/><br/>exceptions<br/><br/>others      = 1.<br/><br/>&nbsp;<br/><br/>loop at iFieldsChar.<br/><br/>move-corresponding iFieldsChar to iScreenChar.<br/><br/>append iScreenChar.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Flowlogic text<br/><br/>append flowlogicText to iScreenChar.<br/><br/>*   Flow logic.<br/><br/>loop at iFlowLogic.<br/><br/>append iFlowLogic to iScreenChar.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>waCharHeader-dnum<br/><br/>space<br/><br/>space<br/><br/>textFileExtension<br/><br/>IS_SCREEN<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>*     Save the screen to the local computer<br/><br/>perform saveFileToPc using iScreenChar[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>'X'<br/><br/>'X'<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>*     Save the screen to the SAP server<br/><br/>perform saveFileToServer using iScreenChar[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>clear header. clear waCharHeader.<br/><br/>clear iScreenChar[].<br/><br/>clear iFieldsChar[].<br/><br/>clear iFields[].<br/><br/>clear iFlowLogic[].<br/><br/>endloop.<br/><br/>endform.                                                                                               "downloadScreens<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  downloadGUITitles..<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadGUITitles using iLocGUITitles like dumIGUITitle[]<br/><br/>value(userFilePath)<br/><br/>value(textFileExtension)<br/><br/>value(subDir)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem).<br/><br/>&nbsp;<br/><br/>data: iLines type standard table of string with header line.<br/><br/>field-symbols: &lt;waGUITitle&gt; type tGUITitle.<br/><br/>data: newSubDirectory type string.<br/><br/>data: newFilenameWithPath type string.<br/><br/>data: newFilenameOnly type string.<br/><br/>data: completeSavePath type string.<br/><br/>&nbsp;<br/><br/>loop at iLocGUITitles assigning &lt;waGUITitle&gt;.<br/><br/>append &lt;waGUITitle&gt;-text to iLines.<br/><br/>&nbsp;<br/><br/>perform buildFilename using userFilePath<br/><br/>subDir<br/><br/>&lt;waGUITitle&gt;-obj_code<br/><br/>space<br/><br/>space<br/><br/>textFileExtension<br/><br/>IS_GUITITLE<br/><br/>saveToServer<br/><br/>slashSeparator<br/><br/>newFilenameWithPath<br/><br/>newfilenameOnly<br/><br/>newSubDirectory<br/><br/>completeSavePath.<br/><br/>&nbsp;<br/><br/>if saveToServer is initial.<br/><br/>perform saveFileToPc using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>space<br/><br/>space<br/><br/>displayProgressMessage.<br/><br/>else.<br/><br/>perform saveFileToServer using iLines[]<br/><br/>newFilenameWithPath<br/><br/>newFilenameOnly<br/><br/>completeSavePath<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>clear iLines[].<br/><br/>endloop.<br/><br/>endform.                                                                                             "downloadGUITitles<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  downloadPrograms..<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadPrograms using iLocProgram like iPrograms[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>iLocDictionaryFilename like iDictFilename[]<br/><br/>iLocTableTypeFilename like iTableTypeFilename[]<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(htmlFileExtension)<br/><br/>value(textFileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStruct)<br/><br/>value(downloadDocumentation)<br/><br/>value(sortTablesAsc)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>data: iProgFunctions type standard table of tFunction with header line.<br/><br/>field-symbols: &lt;waProgram&gt; type tProgram.<br/><br/>field-symbols: &lt;waInclude&gt; type tInclude.<br/><br/>data: iEmptyTextelements type standard table of tTextTable.<br/><br/>data: iEmptySelectionTexts type standard table of tTextTable.<br/><br/>data: iEmptyMessages type standard table of tMessage.<br/><br/>data: iEmptyGuiTitles type standard table of tGUITitle.<br/><br/>data: locConvertToHtml(1).<br/><br/>data: locFileExtension type string.<br/><br/>&nbsp;<br/><br/>sort iLocProgram ascending by progname.<br/><br/>&nbsp;<br/><br/>loop at iLocProgram assigning &lt;waProgram&gt;.<br/><br/>*   if the program to download is this program then always download as text otherwise you will get a rubbish file<br/><br/>if &lt;waprogram&gt;-progname = sy-cprog.<br/><br/>locConvertToHtml = ''.<br/><br/>locFileExtension = TEXTEXTENSION.<br/><br/>else.<br/><br/>locConvertToHtml = convertToHtml.<br/><br/>locFileExtension = fileExtension.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download the main program<br/><br/>perform readIncludeAndDownload using &lt;waProgram&gt;-iTextelements[]<br/><br/>&lt;waProgram&gt;-iSelectionTexts[]<br/><br/>&lt;waProgram&gt;-iMessages[]<br/><br/>&lt;waProgram&gt;-iGUITitle[]<br/><br/>&lt;waprogram&gt;-progname<br/><br/>space<br/><br/>&lt;waprogram&gt;-programTitle<br/><br/>IS_PROGRAM<br/><br/>userFilePath<br/><br/>locFileExtension<br/><br/>&lt;waprogram&gt;-progname<br/><br/>locConvertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>*   Download screens.<br/><br/>if not &lt;waProgram&gt;-iScreenFlow[] is initial.<br/><br/>perform downloadScreens using &lt;waProgram&gt;-iScreenFlow[]<br/><br/>&lt;waProgram&gt;-progname<br/><br/>userFilePath<br/><br/>textFileExtension<br/><br/>&lt;waprogram&gt;-progname<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download GUI titles<br/><br/>if not &lt;waProgram&gt;-iGUITitle[] is initial.<br/><br/>perform downloadGUITitles using &lt;waProgram&gt;-iGUITitle<br/><br/>userFilePath<br/><br/>textFileExtension<br/><br/>&lt;waProgram&gt;-progName<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download all other includes<br/><br/>loop at &lt;waProgram&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>perform readIncludeAndDownload using iEmptyTextelements[]<br/><br/>iEmptySelectionTexts[]<br/><br/>iEmptyMessages[]<br/><br/>iEmptyGuiTitles[]<br/><br/>&lt;waInclude&gt;-IncludeName<br/><br/>space<br/><br/>&lt;waInclude&gt;-IncludeTitle<br/><br/>IS_PROGRAM<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>&lt;waProgram&gt;-progName<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Download all dictionary structures<br/><br/>if not &lt;waProgram&gt;-iDictStruct[] is initial.<br/><br/>perform downloadDDStructures using &lt;waProgram&gt;-iDictStruct[]<br/><br/>iLocDictionaryFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>&lt;waProgram&gt;-progName<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download all Table Types<br/><br/>if not &lt;waProgram&gt;-iTableTypes[] is initial.<br/><br/>perform downloadDDTableTypes using &lt;waProgram&gt;-iTableTypes[]<br/><br/>iLocTableTypeFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>&lt;waProgram&gt;-progName<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download Transformations<br/><br/>if not &lt;waProgram&gt;-iTransformations[] is initial.<br/><br/>perform downloadXSLT using &lt;waProgram&gt;-iTransformations[]<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>htmlFileExtension<br/><br/>textFileExtension<br/><br/>convertToHtml<br/><br/>customerNamespace<br/><br/>slashSeparatorToUse<br/><br/>saveToServer<br/><br/>&lt;waProgram&gt;-progName<br/><br/>displayProgressMessage<br/><br/>serverFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download any functions used by these programs<br/><br/>loop at iLocFunctions into iProgFunctions where programLinkName = &lt;waProgram&gt;-progName.<br/><br/>append iProgFunctions.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>if not iProgFunctions[] is initial.<br/><br/>perform downloadFunctions using iProgFunctions[]<br/><br/>iLocDictionaryFilename[]<br/><br/>iTableTypeFilename[]<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>&lt;waProgram&gt;-progName<br/><br/>downloadDocumentation<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>textFileExtension<br/><br/>htmlFileExtension<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>clear iProgFunctions[].<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                              "downloadPrograms<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  downloadClasses..<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form downloadClasses using iLocClasses like iClasses[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>iLocDictionaryFilename like iDictFilename[]<br/><br/>iLocTableTypeFilename like iTableTypeFilename[]<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(htmlFileExtension)<br/><br/>value(textFileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStruct)<br/><br/>value(downloadDocumentation)<br/><br/>value(sortTablesAsc)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>data: iClassFunctions type standard table of tFunction with header line.<br/><br/>field-symbols: &lt;waClass&gt; type tClass.<br/><br/>field-symbols: &lt;waMethod&gt; type tMethod.<br/><br/>data: additionalSubDirectory type string.<br/><br/>data: classDocumentationExists type abap_bool value FALSE.<br/><br/>&nbsp;<br/><br/>sort iLocClasses ascending by clsname.<br/><br/>&nbsp;<br/><br/>loop at iLocClasses assigning &lt;waClass&gt;.<br/><br/>*   Download the class<br/><br/>perform readClassAndDownload using &lt;waClass&gt;<br/><br/>&lt;waClass&gt;-clsname<br/><br/>space<br/><br/>IS_CLASS<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>space<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>*   Download all of the methods<br/><br/>loop at &lt;waClass&gt;-iMethods assigning &lt;waMethod&gt;.<br/><br/>additionalSubDirectory = &lt;waClass&gt;-clsName.<br/><br/>perform readMethodAndDownload using &lt;waMethod&gt;<br/><br/>&lt;waMethod&gt;-cmpName<br/><br/>&lt;waMethod&gt;-methodKey<br/><br/>space<br/><br/>IS_METHOD<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>additionalSubDirectory<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Download all dictionary structures<br/><br/>if not &lt;waClass&gt;-iDictStruct[] is initial.<br/><br/>perform downloadDDStructures using &lt;waClass&gt;-iDictStruct[]<br/><br/>iLocDictionaryFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>&lt;waClass&gt;-clsName<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download all Table Types<br/><br/>if not &lt;waClass&gt;-iTableTypes[] is initial.<br/><br/>perform downloadDDTableTypes using &lt;waClass&gt;-iTableTypes[]<br/><br/>iLocTableTypeFilename[]<br/><br/>userFilePath<br/><br/>htmlFileExtension<br/><br/>&lt;waClass&gt;-clsName<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download Transformations<br/><br/>if not &lt;waClass&gt;-iTransformations[] is initial.<br/><br/>perform downloadXSLT using &lt;waClass&gt;-iTransformations[]<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>htmlFileExtension<br/><br/>textFileExtension<br/><br/>convertToHtml<br/><br/>customerNamespace<br/><br/>slashSeparatorToUse<br/><br/>saveToServer<br/><br/>&lt;waClass&gt;-clsName<br/><br/>displayProgressMessage<br/><br/>serverFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Download any functions used by these programs<br/><br/>loop at iLocFunctions into iClassFunctions where programLinkName = &lt;waClass&gt;-clsName.<br/><br/>append iClassFunctions.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>if not iClassFunctions[] is initial.<br/><br/>perform downloadFunctions using iClassFunctions[]<br/><br/>iLocDictionaryFilename[]<br/><br/>iLocTableTypeFilename[]<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>&lt;waClass&gt;-clsName<br/><br/>downloadDocumentation<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>getIncludes<br/><br/>getDictStruct<br/><br/>textFileExtension<br/><br/>htmlFileExtension<br/><br/>sortTablesAsc<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>clear iClassFunctions[].<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if downloadDocumentation = TRUE.<br/><br/>perform downloadClassDocs using &lt;waClass&gt;-clsName<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>convertToHtml<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>displayProgressMessage<br/><br/>'' "subdirectory<br/><br/>classDocumentationExists<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endif.<br/><br/>endloop.<br/><br/>endform.                                                                                               "downloadClasses<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   downloadXslt...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form downloadXslt using iLocTransformation like iTransformations[]<br/><br/>value(userFilePath)<br/><br/>value(fileExtension)<br/><br/>value(htmlFileExtension)<br/><br/>value(textFileExtension)<br/><br/>value(convertToHtml)<br/><br/>value(customerNameRange)<br/><br/>value(slashSeparator)<br/><br/>value(saveToServer)<br/><br/>value(subdir)<br/><br/>value(displayProgressMessage)<br/><br/>value(locServerFileSystem)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>&nbsp;<br/><br/>sort iLocTransformation ascending.<br/><br/>&nbsp;<br/><br/>loop at iLocTransformation assigning &lt;waTransformation&gt;.<br/><br/>*   Download the main program<br/><br/>perform readXsltAndDownload using &lt;waTransformation&gt;-xsltname<br/><br/>&lt;waTransformation&gt;-xsltDesc<br/><br/>userFilePath<br/><br/>fileExtension<br/><br/>convertToHtml<br/><br/>customerNameRange<br/><br/>slashSeparator<br/><br/>saveToServer<br/><br/>subdir<br/><br/>displayProgressMessage<br/><br/>locServerFileSystem<br/><br/>addBackground.<br/><br/>endloop.<br/><br/>endform.                                                                                              "downloadXSLT<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  reFormatClassCode...   Expand a classes public, private and protected section from the 72 characters that the class<br/><br/>*                         builder sets it to back to the wide editor mode<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form reFormatClassCode using iTempLines like dumiHtml[].<br/><br/>&nbsp;<br/><br/>field-symbols: &lt;waLine&gt; type string.<br/><br/>data: newLine type string.<br/><br/>data: iNewTable type standard table of string.<br/><br/>data: foundOne type abap_bool value FALSE.<br/><br/>&nbsp;<br/><br/>loop at iTempLines assigning &lt;waLine&gt;.<br/><br/>if not &lt;waLine&gt; is initial.<br/><br/>if foundOne = FALSE.<br/><br/>find 'data' in &lt;waLine&gt; respecting case.<br/><br/>if sy-subrc = 0.<br/><br/>foundOne = TRUE.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>find 'constants' in &lt;waLine&gt; respecting case.<br/><br/>if sy-subrc = 0.<br/><br/>foundOne = TRUE.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>if foundOne = TRUE.<br/><br/>newLine = &lt;waLine&gt;.<br/><br/>&nbsp;<br/><br/>if ( newLine cs '.' or newLine cs '*' ).<br/><br/>replace '!' in &lt;waLine&gt; with ''.<br/><br/>append newLine to iNewTable.<br/><br/>clear newLine.<br/><br/>foundOne = FALSE.<br/><br/>endif.<br/><br/>else.<br/><br/>replace '!' in &lt;waLine&gt; with ''.<br/><br/>append &lt;waLine&gt; to iNewTable.<br/><br/>endif.<br/><br/>else.<br/><br/>concatenate newLine &lt;waLine&gt; into newLine separated by space.<br/><br/>if ( newLine cs '.' or newLine cs '*' ).<br/><br/>append newLine to iNewTable.<br/><br/>clear newLine.<br/><br/>foundOne = FALSE.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>replace '!' in &lt;waLine&gt; with ''.<br/><br/>append &lt;waLine&gt; to iNewTable[].<br/><br/>endif.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>iTempLines[] = iNewTable[].<br/><br/>endform.                                                                             "reFormatClassCode<br/><br/>&nbsp;<br/><br/>***********************************************************************************************************************<br/><br/>**********************************************HTML ROUTINES************************************************************<br/><br/>***********************************************************************************************************************<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  convertDDToHTML...   Convert text description to HTML<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form convertDDToHTML using iLocDictStructure like dumiDictStructure[]<br/><br/>iLocHtml like dumiHtml[]<br/><br/>value(tableName)<br/><br/>value(tableTitle)<br/><br/>value(sortTablesAsc)<br/><br/>value(addBackground) type abap_bool..<br/><br/>&nbsp;<br/><br/>data: iColumnCaptions type standard table of string with header line.<br/><br/>data: waDictionary type tDictTableStructure.<br/><br/>data: waHtml type string.<br/><br/>data: title type string.<br/><br/>field-symbols: &lt;iLocDictStructure&gt; type tDictTableStructure.<br/><br/>* Holds one cell from the internal table<br/><br/>field-symbols: &lt;fsField&gt;.<br/><br/>* The value of one cell form the internal table<br/><br/>data: wTextCell type string.<br/><br/>data: rowCounter(3).<br/><br/>* The base type of the field we are reading<br/><br/>data: wFieldBaseType.<br/><br/>&nbsp;<br/><br/>perform buildDDColumnHeaders using iColumnCaptions[].<br/><br/>&nbsp;<br/><br/>* Add a html header to the table<br/><br/>concatenate 'Dictionary object-' tablename into title separated by space.<br/><br/>perform addHTMLHeader using iLocHtml[]<br/><br/>title<br/><br/>addBackground<br/><br/>SS_TABLE.<br/><br/>&nbsp;<br/><br/>append `&lt;body&gt;` to iLocHtml.<br/><br/>append `  &lt;table&gt;` to iLocHtml.<br/><br/>append `    &lt;tr&gt;` to iLocHtml.<br/><br/>concatenate `      &lt;td&gt;&lt;h2&gt;Table: ` tableName '&lt;/h2&gt;' into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>concatenate `  &lt;h3&gt;Description: ` tableTitle '&lt;/h3&gt;&lt;/td&gt;' into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>append `    &lt;/tr&gt;` to iLocHtml.<br/><br/>&nbsp;<br/><br/>append `    &lt;tr&gt;` to iLocHtml.<br/><br/>append `      &lt;td&gt;&lt;!--This is where our main table begins  --&gt;` to iLocHtml.<br/><br/>append `&lt;table class="innerTable"&gt;` to iLocHtml.<br/><br/>&nbsp;<br/><br/>* Do we need to sort the fields into alphabetical order<br/><br/>if not sortTablesAsc is initial.<br/><br/>sort iLocDictStructure ascending by fieldname.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>* This is where the header fields are defined<br/><br/>append `&lt;tr&gt;` to iLocHtml.<br/><br/>loop at iColumnCaptions.<br/><br/>concatenate `  &lt;th&gt;` iColumnCaptions `&lt;/th&gt;` into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>endloop.<br/><br/>append `&lt;/tr&gt;` to iLocHtml.<br/><br/>&nbsp;<br/><br/>* Add the table cells here<br/><br/>loop at iLocDictStructure assigning &lt;iLocDictStructure&gt;.<br/><br/>append `&lt;tr class="cell"&gt;` to iLocHtml.<br/><br/>rowcounter = rowcounter + 1.<br/><br/>concatenate `  &lt;td&gt;` rowcounter `&lt;/td&gt;` into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>&nbsp;<br/><br/>do.<br/><br/>*     Assign each field in the table to the field symbol<br/><br/>assign component sy-index of structure &lt;iLocDictStructure&gt; to &lt;fsField&gt;.<br/><br/>if sy-subrc = 0.<br/><br/>describe field &lt;fsField&gt; type wFieldBaseType.<br/><br/>if wFieldBaseType &lt;&gt; 'h'.<br/><br/>move &lt;fsField&gt; to wTextCell.<br/><br/>waHtml = `  &lt;td&gt;`.<br/><br/>&nbsp;<br/><br/>*         Add the caption name<br/><br/>if wTextCell is initial.<br/><br/>concatenate waHtml '&amp;nbsp;' '&lt;/td&gt;' into waHtml.<br/><br/>else.<br/><br/>concatenate waHtml wTextCell '&lt;/td&gt;' into waHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>append waHtml to iLocHtml.<br/><br/>clear waHtml.<br/><br/>endif.<br/><br/>else.<br/><br/>exit.<br/><br/>endif.<br/><br/>enddo.<br/><br/>&nbsp;<br/><br/>append `&lt;/tr&gt;` to iLocHtml.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>append `      &lt;/table&gt;` to iLocHtml.<br/><br/>append `     &lt;/td&gt;` to iLocHtml.<br/><br/>append `   &lt;/tr&gt;` to iLocHtml.<br/><br/>append '&lt;br/&gt;' to iLocHtml.<br/><br/>&nbsp;<br/><br/>* Add in any domain entries<br/><br/>perform addDomainToHTML using iLocDictStructure[]<br/><br/>iLocHtml[].<br/><br/>&nbsp;<br/><br/>* Add a html footer to the table<br/><br/>perform addHtmlFooter using iLocHtml[].<br/><br/>endform.                                                                                               "convertDDToHTML<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  addDomaintoHTML...   Add domain vlaues into the HTML<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addDomaintoHTML using iLocDictStructure like dumiDictStructure[]<br/><br/>iLocHtml like dumiHtml[].<br/><br/>&nbsp;<br/><br/>data: iColumnCaptions type standard table of string with header line.<br/><br/>data: waDictionary type tDictTableStructure.<br/><br/>data: waHtml type string.<br/><br/>data: title type string.<br/><br/>field-symbols: &lt;iLocDictStructure&gt; type tDictTableStructure.<br/><br/>data: iDomStructure type standard table of tDomainStructure with header line.<br/><br/>* Holds one cell from the internal table<br/><br/>field-symbols: &lt;fsField&gt;.<br/><br/>* The value of one cell form the internal table<br/><br/>data: wTextCell type string.<br/><br/>data: rowCounter(3).<br/><br/>* The base type of the field we are reading<br/><br/>data: wFieldBaseType.<br/><br/>data: addedHeader type flag value ''.<br/><br/>&nbsp;<br/><br/>perform buildDomColumnHeaders using iColumnCaptions[].<br/><br/>&nbsp;<br/><br/>* Add the table cells here<br/><br/>loop at iLocDictStructure assigning &lt;iLocDictStructure&gt;.<br/><br/>loop at &lt;iLocDictStructure&gt;-iDomains into iDomStructure.<br/><br/>*     OK, lets add the header since we know we have some domain texrt to add.<br/><br/>if addedHeader = ''.<br/><br/>append `  &lt;table&gt;` to iLocHtml.<br/><br/>append `    &lt;tr&gt;` to iLocHtml.<br/><br/>concatenate `      &lt;td&gt;&lt;h2&gt;Fixed Domain Values ` '&lt;/h2&gt;' into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>append `    &lt;/tr&gt;` to iLocHtml.<br/><br/>&nbsp;<br/><br/>append `    &lt;tr&gt;` to iLocHtml.<br/><br/>append `      &lt;td&gt;&lt;!--This is where our main table begins  --&gt;` to iLocHtml.<br/><br/>append `&lt;table&gt;` to iLocHtml.<br/><br/>&nbsp;<br/><br/>*       This is where the header fields are defined<br/><br/>append `&lt;tr&gt;` to iLocHtml.<br/><br/>loop at iColumnCaptions.<br/><br/>concatenate `  &lt;th&gt;` iColumnCaptions `&lt;/th&gt;` into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>endloop.<br/><br/>append `&lt;/tr&gt;` to iLocHtml.<br/><br/>addedHeader = 'X'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>append `&lt;tr class="cell"&gt;` to iLocHtml.<br/><br/>do.<br/><br/>*       Assign each field in the table to the field symbol<br/><br/>assign component sy-index of structure iDomStructure to &lt;fsField&gt;.<br/><br/>if sy-subrc = 0.<br/><br/>describe field &lt;fsField&gt; type wFieldBaseType.<br/><br/>if wFieldBaseType &lt;&gt; 'h'.<br/><br/>move &lt;fsField&gt; to wTextCell.<br/><br/>waHtml = `  &lt;td&gt;`.<br/><br/>&nbsp;<br/><br/>*           Add the caption name<br/><br/>if wTextCell is initial.<br/><br/>concatenate waHtml '&amp;nbsp;' '&lt;/td&gt;' into waHtml.<br/><br/>else.<br/><br/>concatenate waHtml wTextCell '&lt;/td&gt;' into waHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>append waHtml to iLocHtml.<br/><br/>clear waHtml.<br/><br/>endif.<br/><br/>else.<br/><br/>exit.<br/><br/>endif.<br/><br/>enddo.<br/><br/>&nbsp;<br/><br/>append `&lt;/tr&gt;` to iLocHtml.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>if addedHeader = 'X'.<br/><br/>append `      &lt;/table&gt;` to iLocHtml.<br/><br/>append `     &lt;/td&gt;` to iLocHtml.<br/><br/>append `   &lt;/tr&gt;` to iLocHtml.<br/><br/>endif.<br/><br/>endform.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  convertTableTypeToHtml<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form convertTableTypeToHtml using iLocTableTypes like iTableTypes[]<br/><br/>iLocHtml like dumIhtml[]<br/><br/>value(tableName)<br/><br/>value(tableTitle)<br/><br/>value(sortTablesAsc)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: iColumnCaptions type standard table of string with header line.<br/><br/>data: waDictionary type tDictTableStructure.<br/><br/>data: waHtml type string.<br/><br/>data: title type string.<br/><br/>field-symbols: &lt;iLocTableType&gt; like line of iLocTableTypes.<br/><br/>* Holds one cell from the internal table<br/><br/>field-symbols: &lt;fsField&gt;.<br/><br/>* The value of one cell form the internal table<br/><br/>data: wTextCell type string.<br/><br/>data: rowCounter(3).<br/><br/>&nbsp;<br/><br/>perform buildColumnHeadersTableTypes using iColumnCaptions[].<br/><br/>&nbsp;<br/><br/>* Add a html header to the table<br/><br/>concatenate 'Dictionary object (Table Type)-' tablename into title separated by space.<br/><br/>perform addHtmlHeader using iLocHtml[]<br/><br/>title<br/><br/>addBackground<br/><br/>SS_TABLE.<br/><br/>&nbsp;<br/><br/>append '&lt;body&gt;' to ilocHtml.<br/><br/>append '  &lt;table&gt;' to iLocHtml.<br/><br/>append '    &lt;tr&gt;' to iLocHtml.<br/><br/>concatenate '      &lt;td&gt;&lt;h2&gt;Table: ' tablename '&lt;/h2&gt;' into waHtml.<br/><br/>append wahtml to iLocHtml.<br/><br/>concatenate '  &lt;h3&gt;Description: ' tableTitle '&lt;/h3&gt;&lt;/td&gt;' into waHtml.<br/><br/>append wahtml to iLocHtml.<br/><br/>append '    &lt;/tr&gt;' to iLocHtml.<br/><br/>&nbsp;<br/><br/>append '    &lt;tr&gt;' to iLocHtml.<br/><br/>append '      &lt;td&gt;&lt;!--This is where our main table begins  --&gt;' to iLocHtml.<br/><br/>append '&lt;table class="innerTable"&gt;' to iLocHtml.<br/><br/>&nbsp;<br/><br/>* This is where the header fields are defined<br/><br/>append '&lt;tr&gt;' to iLocHtml.<br/><br/>loop at iColumnCaptions.<br/><br/>concatenate '  &lt;th&gt;' iColumnCaptions '&lt;/th&gt;' into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>endloop.<br/><br/>append '&lt;/tr&gt;' to iLocHtml.<br/><br/>&nbsp;<br/><br/>* Add the table cells here<br/><br/>loop at iLocTableTypes assigning &lt;iLocTableType&gt;.<br/><br/>append '&lt;tr class="cell"&gt;' to iLocHtml.<br/><br/>rowCounter = rowCounter + 1.<br/><br/>concatenate '  &lt;td&gt;' rowCounter '&lt;/td&gt;' into waHtml.<br/><br/>append waHtml to iLocHtml.<br/><br/>&nbsp;<br/><br/>do.<br/><br/>*     Assign each field in the table to the field symbol<br/><br/>assign component sy-index of structure &lt;iLocTableType&gt; to &lt;fsField&gt;.<br/><br/>if sy-subrc = 0.<br/><br/>move &lt;fsField&gt; to wTextCell.<br/><br/>waHtml = '  &lt;td&gt;'.<br/><br/>&nbsp;<br/><br/>*       Add the caption name<br/><br/>if wTextCell is initial.<br/><br/>concatenate waHtml '&amp;nbsp;' '&lt;/td&gt;' into waHtml.<br/><br/>else.<br/><br/>concatenate waHtml wTextCell '&lt;/td&gt;' into waHtml.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>append waHtml to iLocHtml.<br/><br/>clear waHtml.<br/><br/>else.<br/><br/>exit.<br/><br/>endif.<br/><br/>enddo.<br/><br/>&nbsp;<br/><br/>append '&lt;/tr&gt;' to iLocHtml.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>append '      &lt;/table&gt;' to iLocHtml.<br/><br/>append '     &lt;/td&gt;' to iLocHtml.<br/><br/>append '   &lt;/tr&gt;' to iLocHtml.<br/><br/>&nbsp;<br/><br/>* Add a html footer to the table<br/><br/>perform addHtmlFooter using iLocHtml[].<br/><br/>endform.                                                                                  "convertTableTypeToHTML<br/><br/>"convertITABtoHtml<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  convertCodeToHtml... Builds an HTML table based upon a text table.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form convertCodeToHtml using iContents like dumIHtml[]<br/><br/>value(programName)<br/><br/>value(ShortDescription)<br/><br/>value(sourceCodeType)<br/><br/>value(functionDocumentationExists)<br/><br/>value(isMainFunctionInclude)<br/><br/>value(htmlExtension)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: htmlTable type standard table of string with header line.<br/><br/>data: head(255).<br/><br/>data: tail(255).<br/><br/>data: myTabix type syTabix.<br/><br/>data: nextLine type syTabix.<br/><br/>data: hyperlinkName type string.<br/><br/>data: copyOfCurrentLine type string.<br/><br/>data: currentLineLength type i value 0.<br/><br/>data: copyLineLength type i value 0.<br/><br/>data: ignoreFutureLines type abap_bool value FALSE.<br/><br/>data: foundAsterix type abap_bool value FALSE.<br/><br/>data: lowercaseLink type string.<br/><br/>data: waNextLine type string.<br/><br/>data: waContent type string.<br/><br/>data: inCommentMode type abap_bool value 'X'.<br/><br/>&nbsp;<br/><br/>* Add a html header to the table<br/><br/>perform addHTMLHeader using htmlTable[]<br/><br/>programName<br/><br/>addBackground<br/><br/>SS_CODE.<br/><br/>&nbsp;<br/><br/>append '&lt;body&gt;' to htmlTable.<br/><br/>* Prgroamname and description<br/><br/>append '&lt;table class="outerTable"&gt;' to htmlTable.<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `     &lt;td&gt;&lt;h2&gt;Code listing for: ` programName `&lt;/h2&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `&lt;h3&gt; Description: ` ShortDescription `&lt;/h3&gt;&lt;/td&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>append `   &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Code<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>append `     &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Table containing code<br/><br/>append `     &lt;table class="innerTable"&gt;` to htmlTable.<br/><br/>append `       &lt;tr&gt;` to htmlTable.<br/><br/>append `          &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>loop at iContents into waContent.<br/><br/>myTabix = sy-tabix.<br/><br/>&nbsp;<br/><br/>if not ( waContent is initial ).<br/><br/>while ( waContent cs '&lt;' or waContent cs '&gt;' ).<br/><br/>replace '&lt;' in waContent with LT.<br/><br/>replace '&gt;' in waContent with GT.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>if waContent+0(1) &lt;&gt; ASTERIX.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>inCommentMode = FALSE.<br/><br/>else.<br/><br/>if inCommentMode = TRUE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>inCommentMode = FALSE.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>currentLineLength = strlen( waContent ).<br/><br/>copyOfCurrentLine = waContent.<br/><br/>&nbsp;<br/><br/>*       Don't hyperlink anything for files of type documentation<br/><br/>if sourceCodeType &lt;&gt; IS_DOCUMENTATION.<br/><br/>*         Check for any functions to highlight<br/><br/>if ( waContent cs CALLFUNCTION ) and ( waContent &lt;&gt; 'DESTINATION' ).<br/><br/>nextLine = myTabix + 1.<br/><br/>read table iContents into waNextLine index nextLine.<br/><br/>translate waNextLine to upper case.<br/><br/>if waNextLine ns 'DESTINATION'.<br/><br/>shift copyOfCurrentLine left deleting leading space.<br/><br/>&nbsp;<br/><br/>copyLineLength = strlen( copyofCurrentLine ).<br/><br/>&nbsp;<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>split tail at space into head tail.<br/><br/>split tail at space into head tail.<br/><br/>*             Function name is now in head<br/><br/>translate head using ''' '.<br/><br/>shift head left deleting leading space.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if head+0(1) = 'Y' or head+0(1) = 'Z' or head+0(1) = 'y' or head+0(1) = 'z' or head cs customerNameRange.<br/><br/>*                 Definately a customer function module<br/><br/>hyperLinkName = head.<br/><br/>&nbsp;<br/><br/>if sourceCodeType = IS_FUNCTION.<br/><br/>copyOfCurrentLine = 'call function &lt;a href ="../'.<br/><br/>else.<br/><br/>copyOfCurrentLine = 'call function &lt;a href ="'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*                 If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>lowercaseLink     "hyperlinkName<br/><br/>'/'<br/><br/>lowercaseLink     "hyperlinkName<br/><br/>Period htmlExtension '"&gt;'<br/><br/>''''<br/><br/>hyperlinkName<br/><br/>''''<br/><br/>'&lt;/a&gt;'<br/><br/>tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*                 Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>waContent = copyOfCurrentLine.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*       Check for any customer includes to hyperlink<br/><br/>if waContent cs INCLUDE or waContent cs LOWINCLUDE.<br/><br/>shift copyOfCurrentLine left deleting leading space.<br/><br/>copyLineLength = strlen( copyOfCurrentLine ).<br/><br/>&nbsp;<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if ( tail+0(1) = 'Y' or tail+0(1) = 'Z' or tail+0(1) = 'y' or tail+0(1) = 'z' or tail cs customerNameRange or tail+0(2) = 'mz' or tail+0(2) = 'MZ' )<br/><br/>and not getIncludes is initial and  tail ns STRUCTURE and tail ns LOWSTRUCTURE.<br/><br/>&nbsp;<br/><br/>*             Hyperlink for program includes<br/><br/>clear waContent.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at PERIOD into hyperlinkName tail.<br/><br/>copyOfCurrentLine = 'include &lt;a href ="'.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>&nbsp;<br/><br/>*             If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>lowercaseLink       "hyperlinkName<br/><br/>PERIOD htmlExtension '"&gt;'<br/><br/>hyperlinkName<br/><br/>'&lt;/a&gt;'<br/><br/>PERIOD tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*             Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>waContent = copyOfCurrentLine.<br/><br/>else.<br/><br/>if not getDictStructures is initial.<br/><br/>*              Hyperlink for structure include e.g. "include structure zfred."<br/><br/>copyLineLength = strlen( copyofCurrentLine ).<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at space into head tail.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if tail+0(1) = 'Y' or tail+0(1) = 'Z' or tail+0(1) = 'y' or tail+0(1) = 'z' or tail cs customerNameRange.<br/><br/>clear waContent.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at PERIOD into hyperlinkName tail.<br/><br/>copyOfCurrentLine = 'include structure &lt;a href ='.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*                  If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>'"'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>'/'<br/><br/>'dictionary-'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>PERIOD htmlExtension<br/><br/>'"&gt;'<br/><br/>hyperlinkName<br/><br/>'&lt;/a&gt;'<br/><br/>PERIOD tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*                  Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>waContent = copyOfCurrentLine.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>else.<br/><br/>if  waContent+0(1) = ASTERIX.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div class="codeComment"&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>else.<br/><br/>if inCommentMode = FALSE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>append `   &lt;div class="codeComment"&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>if inCommentMode = TRUE.<br/><br/>while waContent cs ' '.<br/><br/>replace space with '&amp;nbsp;' into waContent.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>exit.<br/><br/>endif.<br/><br/>endwhile.<br/><br/>endif.<br/><br/>htmlTable =  waContent.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if htmlTable+0(1) = ` `.<br/><br/>while htmlTable cs ` `.<br/><br/>replace ` ` with '&amp;nbsp;' into htmlTable.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>exit.<br/><br/>endif.<br/><br/>endwhile.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>else.<br/><br/>htmlTable = ''.<br/><br/>endif.<br/><br/>concatenate htmlTable `&lt;br /&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>append `            &lt;/div&gt;` to htmlTable.<br/><br/>append `          &lt;/td&gt;`  to htmlTable.<br/><br/>append `        &lt;/tr&gt;` to htmlTable.<br/><br/>append `      &lt;/table&gt;` to htmlTable.<br/><br/>append `      &lt;/td&gt;` to htmlTable.<br/><br/>append `      &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Add a html footer to the table<br/><br/>perform addHtmlFooter using htmlTable[].<br/><br/>&nbsp;<br/><br/>iContents[] = htmlTable[].<br/><br/>endform.                                                                                             "convertCodeToHtml<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  convertClassToHtml... Builds an HTML table based upon a text table.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form convertClassToHtml using iContents like dumIHtml[]<br/><br/>value(className)<br/><br/>value(ShortDescription)<br/><br/>value(sourceCodeType)<br/><br/>value(htmlExtension)<br/><br/>value(customerNameRange)<br/><br/>value(getDictStructures)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: htmlTable type standard table of string with header line.<br/><br/>data: myTabix type syTabix.<br/><br/>data: waContent type string.<br/><br/>data: head type string.<br/><br/>data: tail type string.<br/><br/>data: hyperlinkName type string.<br/><br/>data: lowercaseLink type string.<br/><br/>data: copyOfCurrentLine type string.<br/><br/>data: currentLineLength type i value 0.<br/><br/>data: copyLineLength type i value 0.<br/><br/>data: inCommentMode type abap_bool value 'X'.<br/><br/>data: methodDirectory type string.<br/><br/>&nbsp;<br/><br/>* Add a html header to the table<br/><br/>perform addHTMLHeader using htmlTable[]<br/><br/>className<br/><br/>addBackground<br/><br/>SS_CODE.<br/><br/>&nbsp;<br/><br/>append '&lt;body&gt;' to htmlTable.<br/><br/>* Class name and description<br/><br/>append '&lt;table class="outerTable"&gt;' to htmlTable.<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `     &lt;td&gt;&lt;h2&gt;Code listing for class: ` className `&lt;/h2&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `&lt;h3&gt; Description: ` ShortDescription `&lt;/h3&gt;&lt;/td&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>append `   &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Code<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>append `     &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Table containing code<br/><br/>append `     &lt;table class="innerTable"&gt;` to htmlTable.<br/><br/>append `       &lt;tr&gt;` to htmlTable.<br/><br/>append `          &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>loop at iContents into waContent.<br/><br/>myTabix = sy-tabix.<br/><br/>&nbsp;<br/><br/>*   Comments<br/><br/>if not ( waContent is initial ).<br/><br/>if waContent+0(1) = ASTERIX.<br/><br/>htmltable = wacontent.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div class="codeComment"&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>else.<br/><br/>if inCommentMode = FALSE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>append `   &lt;div class="codeComment"&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>inCommentMode = FALSE.<br/><br/>else.<br/><br/>if inCommentMode = TRUE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>inCommentMode = FALSE.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*        Smaller than, greater than signs<br/><br/>if not ( waContent is initial ).<br/><br/>while ( waContent cs '&lt;' or waContent cs '&gt;' ).<br/><br/>replace '&lt;' in waContent with LT.<br/><br/>replace '&gt;' in waContent with GT.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>*--        Hyperlink methods in the class<br/><br/>*--        Setup sudirectory where method will be saved<br/><br/>if wacontent CS 'public section.'.<br/><br/>methoddirectory = 'public_methods'.<br/><br/>elseif wacontent CS 'private section.'.<br/><br/>methoddirectory = 'private_methods'.<br/><br/>elseif wacontent CS 'protected section.'.<br/><br/>methoddirectory = 'protected_methods'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*--        When it is a method, make a link<br/><br/>find regex '([:space:]*methods[:space:]*)(.*)' in wacontent<br/><br/>ignoring case<br/><br/>submatches head hyperlinkname.<br/><br/>&nbsp;<br/><br/>if sy-subrc = 0.<br/><br/>shift hyperlinkname left deleting leading space.<br/><br/>concatenate methoddirectory<br/><br/>'/'<br/><br/>hyperlinkname<br/><br/>'.html'<br/><br/>into lowercaselink.<br/><br/>&nbsp;<br/><br/>translate lowercaselink to lower case.<br/><br/>concatenate head<br/><br/>' &lt;a href="'<br/><br/>lowercaselink<br/><br/>'"&gt;'<br/><br/>hyperlinkname<br/><br/>'&lt;/a&gt;'<br/><br/>into wacontent.<br/><br/>shift wacontent right by 2 places.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*          Dictionary structures<br/><br/>if not getDictStructures is initial.<br/><br/>find 'class' in waContent ignoring case.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>*              Hyperlink for dictionary/structure include<br/><br/>copyLineLength = strlen( waContent ).<br/><br/>copyOfCurrentLine = waContent.<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at space into head tail.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if tail+0(1) = 'Y' or tail+0(1) = 'Z' or tail+0(1) = 'y' or tail+0(1) = 'z' or tail cs customerNameRange.<br/><br/>clear waContent.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at PERIOD into hyperlinkName tail.<br/><br/>copyOfCurrentLine = 'include structure &lt;a href ='.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*                  If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>'"'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>'/'<br/><br/>'dictionary-'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>PERIOD htmlExtension<br/><br/>'"&gt;'<br/><br/>hyperlinkName<br/><br/>'&lt;/a&gt;'<br/><br/>PERIOD tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*                  Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>waContent = copyOfCurrentLine.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>htmlTable = waContent.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if htmlTable+0(1) = ` `.<br/><br/>while htmlTable cs ` `.<br/><br/>replace ` ` with '&amp;nbsp;' into htmlTable.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>exit.<br/><br/>endif.<br/><br/>endwhile.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>else.<br/><br/>htmlTable = ''.<br/><br/>endif.<br/><br/>endif.<br/><br/>else.<br/><br/>htmlTable = ''.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate htmlTable '&lt;br /&gt;' into htmlTable.<br/><br/>append htmlTable.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>append `            &lt;/div&gt;` to htmlTable.<br/><br/>append `          &lt;/td&gt;`  to htmlTable.<br/><br/>append `        &lt;/tr&gt;` to htmlTable.<br/><br/>append `      &lt;/table&gt;` to htmlTable.<br/><br/>append `      &lt;/td&gt;` to htmlTable.<br/><br/>append `      &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Add a html footer to the table<br/><br/>perform addHtmlFooter using htmlTable[].<br/><br/>&nbsp;<br/><br/>iContents[] = htmlTable[].<br/><br/>endform.                                                                                            "convertClassToHtml<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  convertFunctionToHtml... Builds an HTML table based upon a text table.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form convertFunctionToHtml using iContents like dumIHtml[]<br/><br/>value(functionName)<br/><br/>value(ShortDescription)<br/><br/>value(sourceCodeType)<br/><br/>value(functionDocumentationExists)<br/><br/>value(isMainFunctionInclude)<br/><br/>value(htmlExtension)<br/><br/>value(customerNameRange)<br/><br/>value(getIncludes)<br/><br/>value(getDictStructures)<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>data: htmlTable type standard table of string with header line.<br/><br/>data: head(255).<br/><br/>data: tail(255).<br/><br/>data: myTabix type syTabix.<br/><br/>data: nextLine type syTabix.<br/><br/>data: hyperlinkName type string.<br/><br/>data: copyOfCurrentLine type string.<br/><br/>data: currentLineLength type i value 0.<br/><br/>data: copyLineLength type i value 0.<br/><br/>data: ignoreFutureLines type abap_bool value FALSE.<br/><br/>data: foundAsterix type abap_bool value FALSE.<br/><br/>data: lowercaseLink type string.<br/><br/>data: waNextLine type string.<br/><br/>data: waContent type string.<br/><br/>data: inCommentMode type abap_bool value 'X'.<br/><br/>&nbsp;<br/><br/>* Add a html header to the table<br/><br/>perform addHTMLHeader using htmlTable[]<br/><br/>functionName<br/><br/>addBackground<br/><br/>SS_CODE.<br/><br/>&nbsp;<br/><br/>append '&lt;body&gt;' to htmlTable.<br/><br/>* Class name and description<br/><br/>append '&lt;table class="outerTable"&gt;' to htmlTable.<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `     &lt;td&gt;&lt;h2&gt;Code listing for function ` functionName `&lt;/h2&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>&nbsp;<br/><br/>concatenate `&lt;h3&gt; Description: ` ShortDescription `&lt;/h3&gt;&lt;/td&gt;` into htmlTable.<br/><br/>append htmlTable.<br/><br/>append `   &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Code<br/><br/>append `  &lt;tr&gt;` to htmlTable.<br/><br/>append `     &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Table containing code<br/><br/>append `     &lt;table class="innerTable"&gt;` to htmlTable.<br/><br/>append `       &lt;tr&gt;` to htmlTable.<br/><br/>append `          &lt;td&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>loop at iContents into waContent.<br/><br/>myTabix = sy-tabix.<br/><br/>&nbsp;<br/><br/>*   Extra code for adding global and doc hyperlinks to functions<br/><br/>if sourceCodeType = IS_FUNCTION and isMainFunctionInclude = TRUE.<br/><br/>if not ( waContent is initial ).<br/><br/>if sy-tabix &gt; 1.<br/><br/>if waContent+0(1) = ASTERIX and ignoreFutureLines = FALSE.<br/><br/>foundAsterix = TRUE.<br/><br/>else.<br/><br/>if foundAsterix = TRUE.<br/><br/>*             Lets add our extra HTML lines in here<br/><br/>append '' to HtmlTable.<br/><br/>&nbsp;<br/><br/>*             Global data hyperlink<br/><br/>copyOfcurrentLine = '&lt;div&gt;*       &lt;a href ="' .<br/><br/>lowercaseLink = functionName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*             If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine 'global-' lowercaseLink  "functionName<br/><br/>PERIOD htmlExtension '"&gt;' 'Global data declarations' '&lt;/a&gt;' into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine '&lt;/div&gt;&lt;br /&gt;' into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>append copyOfCurrentLine to HtmlTable.<br/><br/>&nbsp;<br/><br/>*             Documentation hyperlink.<br/><br/>if functionDocumentationExists = TRUE.<br/><br/>copyOfcurrentLine = '&lt;div&gt;*       &lt;a href ="'.<br/><br/>&nbsp;<br/><br/>lowercaseLink = functionName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*               If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>'docs-'<br/><br/>lowercaseLink  "functionName<br/><br/>PERIOD htmlExtension '"&gt;'<br/><br/>'Function module documentation'<br/><br/>'&lt;/a&gt;'<br/><br/>into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine '&lt;/div&gt;&lt;br /&gt;' into copyOfCurrentLine.<br/><br/>append copyOfCurrentLine to HtmlTable.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>foundAsterix = FALSE.<br/><br/>ignoreFutureLines = TRUE.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*   Carry on as normal<br/><br/>if not ( waContent is initial ).<br/><br/>while ( waContent cs '&lt;' or waContent cs '&gt;' ).<br/><br/>replace '&lt;' in waContent with LT.<br/><br/>replace '&gt;' in waContent with GT.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>if waContent+0(1) &lt;&gt; ASTERIX.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>incommentMode = FALSE.<br/><br/>else.<br/><br/>if inCommentMode = TRUE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>inCommentMode = FALSE.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>currentLineLength = strlen( waContent ).<br/><br/>&nbsp;<br/><br/>*       Don't hyperlink anything for files of type documentation<br/><br/>if sourceCodeType &lt;&gt; IS_DOCUMENTATION.<br/><br/>*       Check for any functions to highlight<br/><br/>if ( waContent cs CALLFUNCTION ) and ( waContent &lt;&gt; 'DESTINATION' ).<br/><br/>nextLine = myTabix + 1.<br/><br/>read table iContents into waNextLine index nextLine.<br/><br/>translate waNextLine to upper case.<br/><br/>if waNextLine ns 'DESTINATION'.<br/><br/>copyOfCurrentLine = waContent.<br/><br/>shift copyOfCurrentLine left deleting leading space.<br/><br/>&nbsp;<br/><br/>copyLineLength = strlen( copyofCurrentLine ).<br/><br/>&nbsp;<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>split tail at space into head tail.<br/><br/>split tail at space into head tail.<br/><br/>*             Function name is now in head<br/><br/>translate head using ''' '.<br/><br/>shift head left deleting leading space.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if head+0(1) = 'Y' or head+0(1) = 'Z' or head+0(1) = 'y' or head+0(1) = 'z' or head cs customerNameRange.<br/><br/>&nbsp;<br/><br/>*                 Definately a customer function module<br/><br/>hyperLinkName = head.<br/><br/>&nbsp;<br/><br/>if sourceCodeType = IS_FUNCTION.<br/><br/>copyOfCurrentLine = 'call function &lt;a href ="../'.<br/><br/>else.<br/><br/>copyOfCurrentLine = 'call function &lt;a href ="'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*                 If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>lowercaseLink     "hyperlinkName<br/><br/>'/'<br/><br/>lowercaseLink     "hyperlinkName<br/><br/>Period htmlExtension '"&gt;'<br/><br/>''''<br/><br/>hyperlinkName<br/><br/>''''<br/><br/>'&lt;/a&gt;'<br/><br/>tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*                 Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>&nbsp;<br/><br/>waContent = copyOfCurrentLine.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>*       Check for any customer includes to hyperlink<br/><br/>if waContent cs INCLUDE or waContent cs LOWINCLUDE.<br/><br/>copyOfCurrentLine = waContent.<br/><br/>&nbsp;<br/><br/>shift copyOfCurrentLine left deleting leading space.<br/><br/>copyLineLength = strlen( copyOfCurrentLine ).<br/><br/>&nbsp;<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if ( tail+0(1) = 'Y' or tail+0(1) = 'Z' or tail+0(1) = 'y' or tail+0(1) = 'z'<br/><br/>or tail cs customerNameRange or tail+0(2) = 'mz' or tail+0(2) = 'MZ' ) and not getIncludes is initial.<br/><br/>&nbsp;<br/><br/>*             Hyperlink for program includes<br/><br/>clear waContent.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at PERIOD into hyperlinkName tail.<br/><br/>copyOfCurrentLine = 'include &lt;a href ="'.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*             If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>lowercaseLink       "hyperlinkName<br/><br/>PERIOD htmlExtension '"&gt;'<br/><br/>hyperlinkName<br/><br/>'&lt;/a&gt;'<br/><br/>PERIOD tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*             Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>waContent = copyOfCurrentLine.<br/><br/>else.<br/><br/>if not getDictStructures is initial.<br/><br/>*               Hyperlink for structure include<br/><br/>copyLineLength = strlen( copyofCurrentLine ).<br/><br/>split copyOfCurrentLine at space into head tail.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at space into head tail.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if tail+0(1) = 'Y' or tail+0(1) = 'Z' or tail+0(1) = 'y' or tail+0(1) = 'z' or tail cs customerNameRange.<br/><br/>clear waContent.<br/><br/>shift tail left deleting leading space.<br/><br/>split tail at PERIOD into hyperlinkName tail.<br/><br/>copyOfCurrentLine = 'include structure &lt;a href ='.<br/><br/>&nbsp;<br/><br/>lowercaseLink = hyperlinkName.<br/><br/>translate lowercaseLink to lower case.<br/><br/>*                   If we are running on a non UNIX environment we will need to remove forward slashes<br/><br/>if frontendOpSystem = NON_UNIX.<br/><br/>translate lowercaseLink using '/_'.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>concatenate copyOfCurrentLine<br/><br/>'"'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>'/'<br/><br/>'dictionary-'<br/><br/>lowercaseLink    "hyperlinkName<br/><br/>PERIOD htmlExtension<br/><br/>'"&gt;'<br/><br/>hyperlinkName<br/><br/>'&lt;/a&gt;'<br/><br/>PERIOD tail into copyOfCurrentLine.<br/><br/>&nbsp;<br/><br/>*                   Pad the string back out with spaces<br/><br/>while copyLineLength &lt; currentLineLength.<br/><br/>shift copyOfCurrentLine right by 1 places.<br/><br/>copyLineLength = copyLineLength + 1.<br/><br/>endwhile.<br/><br/>waContent = copyOfCurrentLine.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>endif.<br/><br/>else.<br/><br/>if waContent+0(1) = ASTERIX.<br/><br/>if myTabix = 1.<br/><br/>append `   &lt;div&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>else.<br/><br/>if inCommentMode = FALSE.<br/><br/>append `   &lt;/div&gt;` to htmlTable.<br/><br/>append `   &lt;div class="codeComment"&gt;` to htmlTable.<br/><br/>inCommentMode = TRUE.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>htmlTable = waContent.<br/><br/>&nbsp;<br/><br/>try.<br/><br/>if htmlTable+0(1) = ` `.<br/><br/>while htmlTable cs ` `.<br/><br/>replace ` ` with '&amp;nbsp;' into htmlTable.<br/><br/>if sy-subrc &lt;&gt; 0.<br/><br/>exit.<br/><br/>endif.<br/><br/>endwhile.<br/><br/>endif.<br/><br/>catch cx_sy_range_out_of_bounds into objRuntimeError.<br/><br/>endtry.<br/><br/>&nbsp;<br/><br/>else.<br/><br/>htmlTable = ''.<br/><br/>endif.<br/><br/>concatenate htmlTable '&lt;br /&gt;' into htmlTable.<br/><br/>append htmlTable.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>append `            &lt;/div&gt;` to htmlTable.<br/><br/>append `          &lt;/td&gt;`  to htmlTable.<br/><br/>append `        &lt;/tr&gt;` to htmlTable.<br/><br/>append `      &lt;/table&gt;` to htmlTable.<br/><br/>append `      &lt;/td&gt;` to htmlTable.<br/><br/>append `      &lt;/tr&gt;` to htmlTable.<br/><br/>&nbsp;<br/><br/>* Add a html footer to the table<br/><br/>perform addHtmlFooter using htmlTable[].<br/><br/>&nbsp;<br/><br/>iContents[] = htmlTable[].<br/><br/>endform.                                                                                         "convertFunctionToHtml<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  buildColumnHeaders... build table column names<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form buildDDColumnHeaders using iLocColumnCaptions like dumiHtml[].<br/><br/>&nbsp;<br/><br/>append 'Row' to iLocColumnCaptions.<br/><br/>append 'Field name' to iLocColumnCaptions.<br/><br/>append 'Position' to iLocColumnCaptions.<br/><br/>append 'Key' to iLocColumnCaptions.<br/><br/>append 'Data element' to iLocColumnCaptions.<br/><br/>append 'Domain' to iLocColumnCaptions.<br/><br/>append 'Datatype' to iLocColumnCaptions.<br/><br/>append 'Length' to iLocColumnCaptions.<br/><br/>append 'Lowercase' to iLocColumnCaptions.<br/><br/>append 'Domain text' to iLocColumnCaptions.<br/><br/>endform.                                                                                            "buildColumnHeaders<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  buildDomColumnHeaders... build table column names<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form buildDomColumnHeaders using iLocColumnCaptions like dumiHtml[].<br/><br/>&nbsp;<br/><br/>append 'Domain Name' to iLocColumnCaptions.<br/><br/>append 'Value Low' to iLocColumnCaptions.<br/><br/>append 'Value High' to iLocColumnCaptions.<br/><br/>append 'Text' to iLocColumnCaptions.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  buildColumnHeadersTableTypes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form buildColumnHeadersTableTypes  using iLocColumnCaptions like dumIhtml[].<br/><br/>&nbsp;<br/><br/>append 'Row' to iLocColumnCaptions.<br/><br/>append 'Name of table type' to iLocColumnCaptions.<br/><br/>append 'Name of row type for table types' to iLocColumnCaptions.<br/><br/>append 'Category of table type (range or general table type)' to iLocColumnCaptions.<br/><br/>append 'Elem. type of LOW and HIGH components of a Ranges type' to iLocColumnCaptions.<br/><br/>append 'Type of Object Referenced' to ilocColumnCaptions.<br/><br/>append 'Initial Line Number for Table Types' to iLocColumnCaptions.<br/><br/>append 'Description' to iLocColumnCaptions.<br/><br/>endform.                                                                                 " BUILDCOLUMNHEADERSTABLETYPES<br/><br/>&nbsp;<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* addHTMLHeader...  add a html formatted header to our output table<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addHTMLHeader using iLocHeader like dumiHtml[]<br/><br/>value(title)<br/><br/>value(addBackground) type abap_bool<br/><br/>value(stylesheetType) type char1.<br/><br/>&nbsp;<br/><br/>data: waHeader type string.<br/><br/>&nbsp;<br/><br/>append '&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"&gt;' to iLocHeader.<br/><br/>append '&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;' to iLocHeader.<br/><br/>append '&lt;head&gt;' to iLocHeader.<br/><br/>*     append '&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /&gt;' to iLocHeader.<br/><br/>append '&lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" /&gt;' to iLocHeader.<br/><br/>&nbsp;<br/><br/>concatenate '&lt;title&gt;' title '&lt;/title&gt;' into waHeader.<br/><br/>append waHeader to ilocHeader.<br/><br/>&nbsp;<br/><br/>case stylesheetType.<br/><br/>when SS_CODE.<br/><br/>perform addCodeStyles using iLocHeader<br/><br/>addBackground.<br/><br/>when SS_TABLE.<br/><br/>perform addTableStyles using iLocHeader<br/><br/>addBackground.<br/><br/>endcase.<br/><br/>&nbsp;<br/><br/>perform addGenericStyles using iLocHeader<br/><br/>addBackground.<br/><br/>&nbsp;<br/><br/>append '&lt;/head&gt;' to iLocHeader.<br/><br/>endform.                                                                                                 "addHTMLHeader<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* addCodeStyles... Add the stylesheets needed for HTML output<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addCodeStyles using iLocHeader like dumiHtml[]<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>append '&lt;style type="text/css"&gt;' to iLocHeader.<br/><br/>append `.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }` to iLocHeader.<br/><br/>append `  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }` to iLocHeader.<br/><br/>append `  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }` to iLocHeader.<br/><br/>append `  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }` to iLocHeader.<br/><br/>append '&lt;/style&gt;' to iLocHeader.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* addTableStyles... Add the stylesheets needed for HTML output<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addTableStyles using iLocHeader like dumiHtml[]<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>append '&lt;style type="text/css"&gt;' to iLocHeader.<br/><br/>append `  th{text-align:left}` to iLocHeader.<br/><br/>&nbsp;<br/><br/>append `  .cell{` to iLocHeader.<br/><br/>append `     font-family:"Courier New", Courier, monospace;` to iLocHeader.<br/><br/>append `     color:#000;` to iLocHeader.<br/><br/>append `     font-size:12px;` to iLocHeader.<br/><br/>append `     background-color:#F2F4F7;` to iLocHeader.<br/><br/>append `  }` to iLocHeader.<br/><br/>&nbsp;<br/><br/>append `  .cell td { border: thin solid #ccc; }` to iLocHeader.<br/><br/>append `&lt;/style&gt;` to iLocHeader.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* addTableStyles... Add the stylesheets needed for HTML output<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addGenericStyles using iLocHeader like dumiHtml[]<br/><br/>value(addBackground) type abap_bool.<br/><br/>&nbsp;<br/><br/>append '&lt;style type="text/css"&gt;' to iLocHeader.<br/><br/>&nbsp;<br/><br/>append `  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }` to iLocHeader.<br/><br/>append `  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }` to iLocHeader.<br/><br/>append `  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }` to iLocHeader.<br/><br/>append `  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }` to iLocHeader.<br/><br/>&nbsp;<br/><br/>append `  .outerTable{` to iLocHeader.<br/><br/>if not addBackground is initial.<br/><br/>append `   background-color:#E0E7ED;` to iLocHeader.<br/><br/>endif.<br/><br/>append `   width:100%;` to iLocHeader.<br/><br/>append `   border-top-width: thin;` to iLocHeader.<br/><br/>append `   border-right-width: thin;` to iLocHeader.<br/><br/>append `   border-right-width: thin;` to iLocHeader.<br/><br/>append `   border-left-width: thin;` to iLocHeader.<br/><br/>append `   border-top-style: solid;` to iLocHeader.<br/><br/>append `   border-right-style: solid;` to iLocHeader.<br/><br/>append `   border-bottom-style: solid;` to iLocHeader.<br/><br/>append `   border-left-style: solid;` to iLocHeader.<br/><br/>append `  }` to iLocHeader.<br/><br/>&nbsp;<br/><br/>append `  .innerTable{` to iLocHeader.<br/><br/>if not addBackground is initial.<br/><br/>append `   background-color:#F2F4F7;` to iLocHeader.<br/><br/>endif.<br/><br/>append `   width:100%;` to iLocHeader.<br/><br/>append `   border-top-width: thin;` to iLocHeader.<br/><br/>append `   border-right-width: thin;` to iLocHeader.<br/><br/>append `   border-bottom-width: thin;` to iLocHeader.<br/><br/>append `   border-left-width: thin;` to iLocHeader.<br/><br/>append `   border-top-style: solid;` to iLocHeader.<br/><br/>append `   border-right-style: solid;` to iLocHeader.<br/><br/>append `   border-bottom-style: solid;` to iLocHeader.<br/><br/>append `   border-left-style: solid;` to iLocHeader.<br/><br/>append `  }` to iLocHeader.<br/><br/>append '&lt;/style&gt;' to iLocHeader.<br/><br/>endform.<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* addHTMLFooter...  add a html formatted footer to our output table<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form addHTMLFooter using iLocFooter like dumiHtml[].<br/><br/>&nbsp;<br/><br/>data: footerMessage type string.<br/><br/>data: waFooter type string.<br/><br/>&nbsp;<br/><br/>perform buildFooterMessage using footerMessage.<br/><br/>&nbsp;<br/><br/>append `   &lt;tr&gt;` to iLocFooter.<br/><br/>concatenate '&lt;td class="footer"&gt;' footerMessage '&lt;/td&gt;' into waFooter.<br/><br/>append waFooter to iLocFooter.<br/><br/>append `   &lt;/tr&gt;` to iLocFooter.<br/><br/>append `&lt;/table&gt;` to iLocFooter.<br/><br/>append '&lt;/body&gt;' to iLocFooter.<br/><br/>append '&lt;/html&gt;' to iLocFooter.<br/><br/>endform.                                                                                                 "addHTMLFooter<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* buildFooterMessage...Returns a footer message based on the output file type.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form buildFooterMessage using returnMessage.<br/><br/>&nbsp;<br/><br/>concatenate `Extracted by Mass Download version `<br/><br/>VERSIONNO ` - E.G.Mellodew. 1998-`<br/><br/>sy-datum+0(4) `. Sap Release ` sy-saprl into returnMessage.<br/><br/>endform.                                                                                            "buildFooterMessage<br/><br/>&nbsp;<br/><br/>***********************************************************************************************************************<br/><br/>********************************************DISPLAY ROUTINES***********************************************************<br/><br/>***********************************************************************************************************************<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodeTables...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeTables using iLocDictionary like iDictionary[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runTime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like sNodeText.<br/><br/>field-symbols: &lt;waDictionary&gt; type tDictTable.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>data: subLevel type string.<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocDictionary ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString 'table downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>else.<br/><br/>concatenate tableLinesString 'tables downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runTime to runtimeChar.<br/><br/>concatenate waTreeDisplay-text2 '- runtime' runTimeChar into waTreeDisplay-text2 separated by space.<br/><br/>&nbsp;<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tlevel = '1'.<br/><br/>waTreeDisplay-tlength2  = 60.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocDictionary assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate 'Dictionary:' &lt;waDictionary&gt;-tableTitle into waTreeDisplay-text3 separated by space.<br/><br/>&nbsp;<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>endform.                                                                                            "fillTreeNodeTables<br/><br/>&nbsp;<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>*   fillTreeNodeXslt...<br/><br/>*-------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeXslt using iLocTransformations like iTransformations[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runtime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like snodetext.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocTransformations ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString ` XSLT program downloaded` into waTreeDisplay-text2.<br/><br/>else.<br/><br/>concatenate tableLinesString ` XSLT programs downloaded` into waTreeDisplay-text2.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runtime to runtimeChar.<br/><br/>&nbsp;<br/><br/>concatenate waTreeDisplay-text2 ` - runtime ` runtimeChar into waTreeDisplay-text2.<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tLevel = '2'.<br/><br/>waTreeDisplay-tLength2  = 60.<br/><br/>waTreeDisplay-tColor2    = 1.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocTransformations assigning &lt;waTransformation&gt;.<br/><br/>*   Main programs.<br/><br/>waTreeDisplay-tlevel = '3'.<br/><br/>waTreeDisplay-text2 = &lt;waTransformation&gt;-xsltname.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>*   Description<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 1.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `XSLT: ` &lt;waTransformation&gt;-xsltdesc into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>endloop.<br/><br/>endform.                                                                           " FILLTREENODEXSLT<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodeMessages...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeMessages using iLocMessages like iMessages[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runTime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like sNodeText.<br/><br/>field-symbols: &lt;waMessage&gt; type tMessage.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>&nbsp;<br/><br/>sort iLocMessages ascending by arbgb.<br/><br/>&nbsp;<br/><br/>loop at iLocMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>tableLines = tableLines + 1.<br/><br/>endat.<br/><br/>endloop.<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString 'message class downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>else.<br/><br/>concatenate tableLinesString 'message classes downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runTime to runTimeChar.<br/><br/>concatenate waTreeDisplay-text2 '- runtime' runTimeChar into waTreeDisplay-text2 separated by space.<br/><br/>&nbsp;<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tlevel = '1'.<br/><br/>waTreeDisplay-tlength2 = 60.<br/><br/>waTreeDisplay-tcolor2 = 1.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate 'Message class:'  waTreeDisplay-text3 into waTreeDisplay-text3 separated by space.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>endform.                                                                                          "fillTreeNodeMessages<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodeTableTypes<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeTableTypes using iLocTableTypes like iTableTypes[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runtime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like snodetext.<br/><br/>field-symbols: &lt;waTableType&gt; like line of iLocTableTypes.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>data: subLevel type string.<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocTableTypes ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString 'table type downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>else.<br/><br/>concatenate tableLinesString 'table types downloaded' into waTreeDisplay-text2 separated by space.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runtime to runtimeChar.<br/><br/>concatenate waTreeDisplay-text2 '- runtime' runtimechar into waTreeDisplay-text2 separated by space.<br/><br/>&nbsp;<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tLevel = '2'.<br/><br/>waTreeDisplay-tLength2  = 60.<br/><br/>waTreeDisplay-tColor2    = 1.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocTableTypes assigning &lt;waTableType&gt;.<br/><br/>waTreeDisplay-tLevel = '3'.<br/><br/>waTreeDisplay-text2 = &lt;watabletype&gt;-typename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate 'Dictionary:' &lt;waTableType&gt;-ddtext into waTreeDisplay-text3 separated by space.<br/><br/>&nbsp;<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>endform.                                                                                        " FILLTREENODETABLETYPES<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodeFunctions...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeFunctions using iLocFunctions like iFunctions[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runTime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like sNodeText.<br/><br/>field-symbols: &lt;waFunction&gt; type tFunction.<br/><br/>field-symbols: &lt;waScreen&gt; type tScreenFlow.<br/><br/>field-symbols: &lt;waGUITitle&gt; type tGUITitle.<br/><br/>field-symbols: &lt;waDictionary&gt; type tDictTable.<br/><br/>field-symbols: &lt;waInclude&gt; type tInclude.<br/><br/>field-symbols: &lt;waMessage&gt; type tMessage.<br/><br/>field-symbols: &lt;waTableType&gt; type tTableType.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>&nbsp;<br/><br/>sort iLocFunctions ascending by functionName.<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocFunctions ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString ` function downloaded` into waTreeDisplay-text2.<br/><br/>else.<br/><br/>concatenate tableLinesString ` functions downloaded` into waTreeDisplay-text2.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runTime to runTimeChar.<br/><br/>&nbsp;<br/><br/>concatenate waTreeDisplay-text2 ` - runtime ` runTimeChar into waTreeDisplay-text2.<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tlevel = '1'.<br/><br/>waTreeDisplay-tlength2  = 60.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>* Lets fill the detail in<br/><br/>loop at iLocFunctions assigning &lt;wafunction&gt;.<br/><br/>waTreeDisplay-tlevel = 2.<br/><br/>waTreeDisplay-text2 = &lt;wafunction&gt;-functionName.<br/><br/>waTreeDisplay-tcolor2    = 7.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 7.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Function: ` &lt;wafunction&gt;-functionName into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>*   Screens.<br/><br/>loop at &lt;waFunction&gt;-iScreenFlow assigning &lt;waScreen&gt;.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waScreen&gt;-screen.<br/><br/>waTreeDisplay-tcolor2    = 6.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 6.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>waTreeDisplay-text3 = 'Screen'.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   GUI Title.<br/><br/>loop at &lt;waFunction&gt;-iGUITitle assigning &lt;waGUITitle&gt;.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waGUITitle&gt;-obj_code.<br/><br/>waTreeDisplay-tcolor2    = 6.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 6.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>waTreeDisplay-text3 = 'GUI Title'.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Fill in the tree with include information<br/><br/>loop at &lt;waFunction&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waInclude&gt;-includeName.<br/><br/>waTreeDisplay-tcolor2    = 4.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 4.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Include:   ` &lt;waInclude&gt;-includeTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with dictionary information<br/><br/>loop at &lt;waFunction&gt;-iDictStruct assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Dictionary:` &lt;waDictionary&gt;-tableTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with Table type information<br/><br/>loop at &lt;waFunction&gt;-iTableTypes assigning &lt;waTableType&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTableType&gt;-typeName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTableType&gt;-ddtext into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with transformation information<br/><br/>loop at &lt;waFunction&gt;-iTransformations[] assigning &lt;waTransformation&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTRansformation&gt;-xsltName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTransformation&gt;-xsltDesc into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with message information<br/><br/>sort &lt;waFunction&gt;-iMessages[] ascending by arbgb.<br/><br/>loop at &lt;waFunction&gt;-iMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>&nbsp;<br/><br/>*       Select the message class text if we do not have it already<br/><br/>if &lt;waMessage&gt;-sText is initial.<br/><br/>select single stext from t100a<br/><br/>into &lt;waMessage&gt;-stext<br/><br/>where arbgb = &lt;waMessage&gt;-arbgb.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate `Message class: `  waTreeDisplay-text3 into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>endform.                                                                                         "fillTreeNodeFunctions<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodePrograms<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodePrograms using iLocPrograms like iPrograms[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runTime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like sNodeText.<br/><br/>field-symbols: &lt;waProgram&gt; type tProgram.<br/><br/>field-symbols: &lt;waScreen&gt; type tScreenFlow.<br/><br/>field-symbols: &lt;waFunction&gt; type tFunction.<br/><br/>field-symbols: &lt;waDictionary&gt; type tDictTable.<br/><br/>field-symbols: &lt;waInclude&gt; type tInclude.<br/><br/>field-symbols: &lt;waMessage&gt; type tMessage.<br/><br/>field-symbols: &lt;waTableType&gt; type tTableType.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocPrograms ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString ` program downloaded` into waTreeDisplay-text2.<br/><br/>else.<br/><br/>concatenate tableLinesString ` programs downloaded` into waTreeDisplay-text2.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runTime to runTimeChar.<br/><br/>&nbsp;<br/><br/>concatenate waTreeDisplay-text2 ` - runtime ` runTimeChar into waTreeDisplay-text2.<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tlevel = '1'.<br/><br/>waTreeDisplay-tlength2  = 60.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocPrograms assigning &lt;waProgram&gt;.<br/><br/>*   Main programs.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waProgram&gt;-progName.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>*   Description<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 1.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Program: ` &lt;waProgram&gt;-programTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>*   Screens.<br/><br/>loop at &lt;waProgram&gt;-iScreenFlow assigning &lt;waScreen&gt;.<br/><br/>waTreeDisplay-tlevel = '3'.<br/><br/>waTreeDisplay-text2 = &lt;waScreen&gt;-screen.<br/><br/>waTreeDisplay-tcolor2    = 6.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 6.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>waTreeDisplay-text3 = 'Screen'.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>endloop.<br/><br/>*   fill in the tree with message information<br/><br/>sort &lt;waProgram&gt;-iMessages[] ascending by arbgb.<br/><br/>loop at &lt;waProgram&gt;-iMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>&nbsp;<br/><br/>*       Select the message class text if we do not have it already<br/><br/>if &lt;waMessage&gt;-sText is initial.<br/><br/>select single stext from t100a<br/><br/>into &lt;waMessage&gt;-stext<br/><br/>where arbgb = &lt;waMessage&gt;-arbgb.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate `Message class: `  waTreeDisplay-text3 into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>*   Fill in the tree with include information<br/><br/>loop at &lt;waProgram&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waInclude&gt;-includeName.<br/><br/>waTreeDisplay-tcolor2    = 4.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 4.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Include:   ` &lt;waInclude&gt;-includeTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>*   fill in the tree with dictionary information<br/><br/>loop at &lt;waProgram&gt;-iDictStruct assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Dictionary:    ` &lt;waDictionary&gt;-tableTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with Table type information<br/><br/>loop at &lt;waProgram&gt;-iTableTypes assigning &lt;waTableType&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTableType&gt;-typeName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTableType&gt;-ddtext into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with transformation information<br/><br/>loop at &lt;waProgram&gt;-iTransformations assigning &lt;waTransformation&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTRansformation&gt;-xsltName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTransformation&gt;-xsltDesc into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Function Modules<br/><br/>loop at iLocFunctions assigning &lt;wafunction&gt; where programLinkName = &lt;waProgram&gt;-progname.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 = &lt;wafunction&gt;-functionName.<br/><br/>waTreeDisplay-tcolor2    = 7.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 7.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Function:      ` &lt;wafunction&gt;-functionName into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>*     Fill in the tree with include information<br/><br/>loop at &lt;waFunction&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 =  &lt;waInclude&gt;-includeName.<br/><br/>waTreeDisplay-tcolor2    = 4.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 4.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Include:       ` &lt;waInclude&gt;-includeTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*     fill in the tree with dictionary information<br/><br/>loop at &lt;waFunction&gt;-iDictStruct assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 =  &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Dictionary:    ` &lt;wadictionary&gt;-tableTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*     fill in the tree with message information<br/><br/>sort &lt;waFunction&gt;-iMessages[] ascending by arbgb.<br/><br/>loop at &lt;waFunction&gt;-iMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>&nbsp;<br/><br/>*         Select the message class text if we do not have it already<br/><br/>if &lt;waMessage&gt;-sText is initial.<br/><br/>select single stext from t100a<br/><br/>into &lt;waMessage&gt;-stext<br/><br/>where arbgb = &lt;waMessage&gt;-arbgb.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate `Message class:  `  waTreeDisplay-text3 into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>endform.                                                                                          "fillTreeNodePrograms<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  fillTreeNodeClasses<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form fillTreeNodeClasses using iLocClasses like iClasses[]<br/><br/>iLocFunctions like iFunctions[]<br/><br/>iLocTreeDisplay like iTreeDisplay[]<br/><br/>value(runTime).<br/><br/>&nbsp;<br/><br/>data: tableLines type i.<br/><br/>data: waTreeDisplay like sNodeText.<br/><br/>field-symbols: &lt;waClass&gt; type tClass.<br/><br/>field-symbols: &lt;waMethod&gt; type tMethod.<br/><br/>field-symbols: &lt;waFunction&gt; type tFunction.<br/><br/>field-symbols: &lt;waDictionary&gt; type tDictTable.<br/><br/>field-symbols: &lt;waInclude&gt; type tInclude.<br/><br/>field-symbols: &lt;waMessage&gt; type tMessage.<br/><br/>field-symbols: &lt;waTableType&gt; type tTableType.<br/><br/>field-symbols: &lt;waTransformation&gt; type tTransformation.<br/><br/>data: tableLinesString type string.<br/><br/>data: runtimeChar(10).<br/><br/>&nbsp;<br/><br/>tableLines = lines( iLocClasses ).<br/><br/>tableLinesString = tableLines.<br/><br/>&nbsp;<br/><br/>if tableLines = 1.<br/><br/>concatenate tableLinesString ` class downloaded` into waTreeDisplay-text2.<br/><br/>else.<br/><br/>concatenate tableLinesString ` classes downloaded` into waTreeDisplay-text2.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>write runTime to runTimeChar.<br/><br/>&nbsp;<br/><br/>concatenate waTreeDisplay-text2 ` - runtime ` runTimeChar into waTreeDisplay-text2.<br/><br/>* include header display record.<br/><br/>waTreeDisplay-tlevel = '1'.<br/><br/>waTreeDisplay-tlength2  = 60.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>&nbsp;<br/><br/>loop at iLocClasses assigning &lt;waClass&gt;.<br/><br/>*   Main Class.<br/><br/>waTreeDisplay-tlevel = '2'.<br/><br/>waTreeDisplay-text2 = &lt;waClass&gt;-clsName.<br/><br/>waTreeDisplay-tcolor2    = 1.<br/><br/>*   Description<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 1.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Class:    ` &lt;waClass&gt;-descript into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iTreeDisplay.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with method information<br/><br/>loop at &lt;waClass&gt;-iMethods[] assigning &lt;waMethod&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waMethod&gt;-cmpname.<br/><br/>waTreeDisplay-tcolor2    = 2.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 2.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Method:   ` &lt;waMethod&gt;-descript into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with message information<br/><br/>sort &lt;waClass&gt;-iMessages[] ascending by arbgb.<br/><br/>loop at &lt;waClass&gt;-iMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>&nbsp;<br/><br/>*       Select the message class text if we do not have it already<br/><br/>if &lt;waMessage&gt;-sText is initial.<br/><br/>select single stext from t100a<br/><br/>into &lt;waMessage&gt;-stext<br/><br/>where arbgb = &lt;waMessage&gt;-arbgb.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate `Message class: `  waTreeDisplay-text3 into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with dictionary information<br/><br/>loop at &lt;waClass&gt;-iDictStruct assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Dictionary:    ` &lt;waDictionary&gt;-tableTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with Table type information<br/><br/>loop at &lt;waClass&gt;-iTableTypes assigning &lt;waTableType&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTableType&gt;-typeName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTableType&gt;-ddtext into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   fill in the tree with transformation information<br/><br/>loop at &lt;waClass&gt;-iTransformations assigning &lt;waTransformation&gt;.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 =  &lt;waTRansformation&gt;-xsltName.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Table Type:    ` &lt;waTransformation&gt;-xsltDesc into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*   Function Modules<br/><br/>loop at iLocFunctions assigning &lt;wafunction&gt; where programLinkName = &lt;waClass&gt;-clsname.<br/><br/>waTreeDisplay-tlevel = 3.<br/><br/>waTreeDisplay-text2 = &lt;wafunction&gt;-functionName.<br/><br/>waTreeDisplay-tcolor2    = 7.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 7.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Function:      ` &lt;wafunction&gt;-functionName into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>&nbsp;<br/><br/>*     Fill in the tree with include information<br/><br/>loop at &lt;waFunction&gt;-iIncludes assigning &lt;waInclude&gt;.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 =  &lt;waInclude&gt;-includeName.<br/><br/>waTreeDisplay-tcolor2    = 4.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 4.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Include:       ` &lt;waInclude&gt;-includeTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*     fill in the tree with dictionary information<br/><br/>loop at &lt;waFunction&gt;-iDictStruct assigning &lt;waDictionary&gt;.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 =  &lt;waDictionary&gt;-tablename.<br/><br/>waTreeDisplay-tcolor2    = 3.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 3.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>concatenate `Dictionary:    ` &lt;wadictionary&gt;-tableTitle into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endloop.<br/><br/>&nbsp;<br/><br/>*     fill in the tree with message information<br/><br/>sort &lt;waFunction&gt;-iMessages[] ascending by arbgb.<br/><br/>loop at &lt;waFunction&gt;-iMessages assigning &lt;waMessage&gt;.<br/><br/>at new arbgb.<br/><br/>waTreeDisplay-tlevel = 4.<br/><br/>waTreeDisplay-text2 = &lt;waMessage&gt;-arbgb.<br/><br/>waTreeDisplay-tcolor2    = 5.<br/><br/>waTreeDisplay-tlength3   = 80.<br/><br/>waTreeDisplay-tcolor3    = 5.<br/><br/>waTreeDisplay-tpos3      = 60.<br/><br/>&nbsp;<br/><br/>*         Select the message class text if we do not have it already<br/><br/>if &lt;waMessage&gt;-sText is initial.<br/><br/>select single stext from t100a<br/><br/>into &lt;waMessage&gt;-stext<br/><br/>where arbgb = &lt;waMessage&gt;-arbgb.<br/><br/>endif.<br/><br/>&nbsp;<br/><br/>waTreeDisplay-text3 = &lt;waMessage&gt;-sText.<br/><br/>concatenate `Message class:  `  waTreeDisplay-text3 into waTreeDisplay-text3.<br/><br/>append waTreeDisplay to iLocTreeDisplay.<br/><br/>endat.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>endloop.<br/><br/>endform.                                                                                           "fillTreeNodeClasses<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>* displayTree...<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form displayTree using iLocTreeDisplay like iTreeDisplay[].<br/><br/>&nbsp;<br/><br/>data: waTreeDisplay type snodetext.<br/><br/>&nbsp;<br/><br/>* build up the tree from the internal table node<br/><br/>call function 'RS_TREE_CONSTRUCT'<br/><br/>tables<br/><br/>nodetab            = iTreeDisplay<br/><br/>exceptions<br/><br/>tree_failure       = 1<br/><br/>id_not_found       = 2<br/><br/>wrong_relationship = 3<br/><br/>others             = 4.<br/><br/>&nbsp;<br/><br/>* get the first index and expand the whole tree<br/><br/>read table iLoctreeDisplay into waTreeDisplay index 1.<br/><br/>call function 'RS_TREE_EXPAND'<br/><br/>exporting<br/><br/>node_id   = waTreeDisplay-id<br/><br/>all       = 'X'<br/><br/>exceptions<br/><br/>not_found = 1<br/><br/>others    = 2.<br/><br/>&nbsp;<br/><br/>* now display the tree<br/><br/>call function 'RS_TREE_LIST_DISPLAY'<br/><br/>exporting<br/><br/>callback_program      = sy-cprog<br/><br/>callback_user_command = 'CB_USER_COMMAND'<br/><br/>callback_text_display = 'CB_text_DISPLAY'<br/><br/>callback_top_of_page  = 'TOP_OF_PAGE'<br/><br/>exceptions<br/><br/>others                = 1.<br/><br/>endform.                                                                                                   "displayTree<br/><br/>&nbsp;<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>*  topOfPage... for tree display routines.<br/><br/>*----------------------------------------------------------------------------------------------------------------------<br/><br/>form topOfPage.<br/><br/>&nbsp;<br/><br/>endform.
